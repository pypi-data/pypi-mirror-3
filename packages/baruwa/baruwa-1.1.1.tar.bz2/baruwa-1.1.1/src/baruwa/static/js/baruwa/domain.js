function ajax_start(){if($("#in-progress").length){$("#in-progress").remove()}$("#Footer_container").after(loading_msg)}function ajax_stop(){$("#loading_message").remove()}function ajax_error(c,b,a){if(b.status==200){location.href=a.url}else{$(".Grid_heading").before('<div id="ajax-error-msg" class="ui-state-highlight">'+gettext("Server error")+"</div>");setTimeout(function(){$("#ajax-error-msg").empty().remove()},3900)}$("#loading_message").remove()}function check_status(a){$.get(a,function(b){if(b.completed){if($("#in-progress").length){$("#in-progress").remove()}$(".Grid_content").before('<div id="in-progress">'+b.html+"</div>");$("#in-progress").append('<div id="dismiss"><a href="#">'+gettext("Dismiss")+"</a></div>");var c=setTimeout(function(){$("#in-progress").remove()},15050);$("#dismiss a").click(function(d){d.preventDefault();clearTimeout(c);$("#in-progress").empty().remove()});$("a.selector").bind("click",test_conn);clearInterval(auto_refresh)}},"json")}function test_conn(b){b.preventDefault();if($("#in-progress").length){return}var a=$(this).attr("href");auto_refresh=setInterval(check_status(a),5000)}var auto_refresh,loading_msg;loading_msg='<div id="loading_message"><div id="loading">';loading_msg+='<img src="'+media_url+'imgs/ajax-loader.gif" alt="loading"/>';loading_msg+="<br/><b>"+gettext("Testing connection")+"</b></div></div>";$(document).ready(function(){$("body").ajaxStart(ajax_start).ajaxStop(ajax_stop).ajaxError(ajax_error);$("a.selector").bind("click",test_conn)});