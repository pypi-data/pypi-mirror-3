[
    {
        "name": "OS | FreeBSD | Network | NTP | System Clock Synchronized (SYSLOG)",
        "description": "ntpd[1433]: synchronized to 10.30.99.111, stratum 1",
        "event_class__name": "Network | NTP | System Clock Synchronized",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "ntpd\\[\\d+\\]: synchronized to (?P<server_address>\\S+), stratum (?P<stratum>\\d+)$"
            }
        ]
    },

    {
        "name": "OS | FreeBSD | Network | NTP | System Clock Adjusted (SYSLOG)",
        "description": "ntpd[11213]: time reset +0.320022 s",
        "event_class__name": "Network | NTP | System Clock Adjusted",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "ntpd\\[\\d+\\]: time reset (?P<adjustment_s>\\S+) s$"
            }
        ],
        "vars": [
            {
                "name": "adjustment_ms",
                "value": "=str(int(float(adjustment_s) * 1000))"
            }
        ]
    }
]
