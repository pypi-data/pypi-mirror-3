<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      
      <title>
    Totals
 &mdash; sqlkit v0.9.5.1 documentation</title>
      
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sqlkit.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="sqlkit v0.9.5.1 documentation" href="../index.html" />
        <link rel="up" title="Browsing data" href="browsing.html" />
        <link rel="next" title="Localization" href="localization.html" />
        <link rel="prev" title="Filters" href="filters.html" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '0.9.5.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>


<!-- <link rel="stylesheet" href="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.css" type="text/css" /> -->
      <link rel="stylesheet" href="../_static/jMenu.jquery.css" type="text/css" />

      <!-- <script type="text/javascript" src="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.js"></script> -->

      <script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-18221996-2']);
	_gaq.push(['_trackPageview']);

	(function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

      </script>
      <script type="text/javascript" src="../_static/jMenu.jquery.js"></script>
      <script type="text/javascript">
	      $(document).ready(function(){
		      $("#jMenu").jMenu({
			      ulWidth : '150',
			      effects : {
				      effectSpeedOpen : 300,
				      effectSpeedClose : 300,
				      effectTypeOpen : 'slide',
				      effectTypeClose : 'slide',
				      effectOpen : 'linear',
				      effectClose : 'linear'
			      },
			      TimeBeforeOpening : 100,
			      TimeBeforeClosing : 400,
			      animatedText : false,
			      paddingLeft: 1		});
	      })
      </script>
<!-- Preview -->
     <script type="text/javascript" src="../_static/imgpreview.js"></script>
     <script type="text/javascript">
       $(document).ready(function(){
           $('.preview').imgPreview();
       });
     </script>
     
     <!--[if !IE 7]>
	     <style type="text/css">
		     #wrap {display:table;height:100%}
	     </style>
     <![endif]-->
    </head>
    <body>
        




<div id="wrap">
    
<div id="header">

	<div class="logo"><a href="../misc/tour.html">
       <img src="../_static/sqlkit.png" align="left"  alt="Logo" border="0"/></a>
        </div>
	<div id="description">Acces to db made easy</div>
</div>


   <div style="clear:left;"></div>


<div >
	<ul id="jMenu">
            <li><a class="fNiv" href="../index.html" title="Home" 
                  >Home</a></li>

            <li><a li class="fNiv" href="contents.html"
                  title="Sqlkit - the python package" 
                  >Sqlkit</a>

	       <ul>
		 <li ><a href="contents.html"
		       title="Sqlkit - the python package" 
		       >Sqlkit</a></li>

		 <li ><a href="sqlwidget.html" title="Widgets" 
		       >Widgets</a>
		       <ul> 
			 <li ><a href="mask.html" title="Mask" 
			       >Mask view</a></li>
			 <li ><a href="table.html" title="Table" 
			       >Table view</a></li>
		       </ul>
                 </li>
		 <li ><a href="browsing.html" title="Browsing Data" 
		       >Browsing data</a>
		    <ul> 
		      <li ><a href="constraints.html" title="Constraints" 
			    >Constraints</a></li>
		      <li ><a href="filters.html" title="Filters" 
			    >Filters</a></li>
		      <li ><a href="#" title="Totals" 
			    >Totals</a></li>
		    </ul>
                 </li>
		 <li ><a href="editing.html" title="Editing Data" 
		       >Editing data</a>
			 <ul> 
			   <li ><a href="completion.html" title="Completion" 
				 >Completion</a></li>
			   <li ><a href="validation.html" title="Validation" 
				 >Validation</a></li>
			   <li ><a href="relationship.html" title="Relationships" 
				 >Relationships</a></li>
			 </ul>
		       </li>
		 <li ><a href="printing.html" title="Printing" 
		       ><span>Printing</span></a></li>
		 <li ><a href="advanced/contents.html" title="Advanced configuration" 
		       >Advanced configuration</a>
			 <ul> 
			   <li ><a href="advanced/fields.html" title="Fields" 
				 >Fields</a></li>
			   <li ><a href="advanced/views.html" title="Views" 
				 >Views</a></li>
			 </ul>
		       </li>

	       </ul>
            </li>

            <li><a class="fNiv" href="../misc/sqledit.html"
                  title="Sqledit GUI" 
                  >Sqledit GUI</a></li>

            <li><a class="fNiv" href="../misc/tutorials.html"
                  title="Support & tutorials" 
                  >Support & Tutorials</a>
	       <ul>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Sqledit - the application</a></li>
		 <li ><a href="../misc/tour.html"
		       title="Sqlkit - the features'tour"
		       >Sqlkit - features' tour</a></li>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Installing instructions</a></li>
		</ul> 
            </li>

            <li><a class="fNiv" href="../layout/contents.html" title="Layout"
                  >Layout</a></li>

            <li><a  class="fNiv"href="../misc/contents.html" title="Download" 
                  >Download</a>

	       <ul>
		 <li ><a href="../misc/contents.html"
		       title="Download"
		       >Download</a></li>
		 <li ><a href="http://sqlkit.argolinux.org/download/Changelog"  title="Changelog"
		       title="Changelog"
		       >Changelog</a></li>
		 <li ><a href="../misc/backward_incompatibilities.html"
		       title="Backward incompatibilities"
		       >Backward incompatibilities</a></li>
	       </ul>
            </li>



        </ul>
</div>
   <div style="clear:left;"></div>

    
    <div class="related">
      <ul>
	
<!-- <div class="prevnext"> -->
<!--    <li class="right"  style="margin-right: 10px">Indice -->
<!--      <a href="../genindex.html" title="Indice generale" -->
<!--                accesskey="I">indice</a></li> -->

        <li class="right">Prev:
        <a href="filters.html" title="previous chapter">Filters</a></li>
        <li class="right">Next:
        <a href="localization.html" title="next chapter">Localization</a></li>
<!-- </div> -->


      </ul>

    </div>

    
  <div class="sphinxsidebar">
     <div class="sphinxsidebarwrapper">


	    <div class="topnav">
    <h3>Table of contents</h3>
		    <ul>
<li><a class="reference external" href="#">Totals</a><ul>
<li><a class="reference external" href="#personalization-and-colors">Personalization and colors</a></li>
<li><a class="reference external" href="#dates">Dates</a></li>
<li><a class="reference external" href="#totals-with-no-totals">Totals... with no totals!</a></li>
<li><a class="reference external" href="#signals">Signals</a><ul>
<li><a class="reference external" href="#module-sqlkit.widgets.table.totals">API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

		<div class="clearboth"></div>
	    </div>



    <h3>Questions?</h3>

    <p>Subscribe to out mailing list <a href="http://groups.google.com/group/sqlkit">
       Google group</a>:</p>

    <form action="http://groups.google.com/group/sqlkit/boxsubscribe" style="padding-left: 1em">
      <input type="text" name="email" value="your@email"/>
      <input type="submit" name="sub" value="Subscribe" />
    </form>
    <div id="searchbox" style="display: none">

    <h3>Quick search</h3>
	<form class="search" action="../search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />

	  <input type="hidden" name="area" value="default" />
	</form>
	<p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
	</p>
    <h3>License</h3>
	<img src="../_static/gplv3.png" alt="logo GPLv3">

    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>

     </div>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">

            <div class="body">
                
<div class="section" id="totals">
<span id="id1"></span><h1>Totals<a class="headerlink" href="#totals" title="Permalink to this headline">¶</a></h1>
<p>Numeric columns of a Table have the option to show totals and
subtotals. Subtotals are determined by brake fields/functions. This may be
done interactively from the column menu or from code. The following example
is very stupid but... you get the feeling!:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span> <span class="o">=</span> <span class="n">SqlTable</span><span class="p">(</span><span class="s">&#39;movie&#39;</span><span class="p">,</span> <span class="n">dbproxy</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="s">&#39;director_id&#39;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">totals</span><span class="o">.</span><span class="n">add_break</span><span class="p">(</span><span class="s">&#39;director_id&#39;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">totals</span><span class="o">.</span><span class="n">add_total</span><span class="p">(</span><span class="s">&#39;year&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/totals.png" src="../_images/totals.png" />
<div class="section" id="personalization-and-colors">
<h2>Personalization and colors<a class="headerlink" href="#personalization-and-colors" title="Permalink to this headline">¶</a></h2>
<p>Totals are generated by a class <tt class="docutils literal"><span class="pre">sqlkit.widgets.table.totals.Totals</span></tt> that
can be inherited and modified to set different total behavior.</p>
<p>The colors are defined in a class in the same module <tt class="docutils literal"><span class="pre">TotalObj</span></tt> whose
method <tt class="docutils literal"><span class="pre">set_value_and_colors</span></tt> can be used to personalize colors and markup
of the cell.</p>
</div>
<div class="section" id="dates">
<h2>Dates<a class="headerlink" href="#dates" title="Permalink to this headline">¶</a></h2>
<p>Since date breaks are probably very common a function makes it easy to
brake on dates.</p>
</div>
<div class="section" id="totals-with-no-totals">
<h2>Totals... with no totals!<a class="headerlink" href="#totals-with-no-totals" title="Permalink to this headline">¶</a></h2>
<p>If you only need subtotals and not totals you can prevent totals using
option <tt class="docutils literal"><span class="pre">hide_total</span></tt> when declaring the column to sum.</p>
</div>
<div class="section" id="signals">
<h2>Signals<a class="headerlink" href="#signals" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">computed:</th><td class="field-body"><dl class="first docutils">
<dt>this signal is emitted when the total is computed. The signature</dt>
<dd><p class="first last">of the callback function is:</p>
</dd>
</dl>
<dl class="last function">
<dt>
<tt class="descname">computed_cb(total):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the total instance that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<div class="section" id="module-sqlkit.widgets.table.totals">
<h3>API<a class="headerlink" href="#module-sqlkit.widgets.table.totals" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="sqlkit.widgets.table.totals.Totals">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.table.totals.</tt><tt class="descname">Totals</tt><big>(</big><em>table</em>, <em>treeview=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals" title="Permalink to this definition">¶</a></dt>
<dd><p>An object whose &#8216;compute&#8217; method adds TotalObjets to show
partial totals/grand totals to a table.
A TotalObject is inserted each time total_by changes.
If total_by is a callable, it&#8217;s evaluated to detect if a partial total
must be inserted</p>
<dl class="attribute">
<dt id="sqlkit.widgets.table.totals.Totals.totals">
<tt class="descname">totals</tt><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.totals" title="Permalink to this definition">¶</a></dt>
<dd>A dict whose keys are the field names for which a total/subtotal is to be computed.
The values are the totals. It&#8217;s filled by <a title="sqlkit.widgets.table.totals.Totals.sum" class="reference internal" href="#sqlkit.widgets.table.totals.Totals.sum"><tt class="xref docutils literal"><span class="pre">sum()</span></tt></a> that can be customized.</dd></dl>

<dl class="attribute">
<dt id="sqlkit.widgets.table.totals.Totals.subtotals">
<tt class="descname">subtotals</tt><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.subtotals" title="Permalink to this definition">¶</a></dt>
<dd>A dict whose keys are the field names for which a total/subtotal is to be computed
The values are the subtotals. It&#8217;s filled by <a title="sqlkit.widgets.table.totals.Totals.sum" class="reference internal" href="#sqlkit.widgets.table.totals.Totals.sum"><tt class="xref docutils literal"><span class="pre">sum()</span></tt></a> that can be customized.</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.table.totals.Totals.add_total">
<tt class="descname">add_total</tt><big>(</big><em>*field_names</em>, <em>**kw</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.add_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a total object each time subtotal changes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>field_names</em> &#8211; a list of field_names for which we want a total</li>
<li><em>quiet</em> &#8211; boolean. If True silently fail if the field is not a number</li>
<li><em>hide_total</em> &#8211; boolean. If True gran total will not be shown (only subtotals)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.table.totals.Totals.add_break">
<tt class="descname">add_break</tt><big>(</big><em>field_name</em>, <em>func=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.add_break" title="Permalink to this definition">¶</a></dt>
<dd><p>If no <tt class="docutils literal"><span class="pre">func</span></tt> is provided, a break_func will be setup to insert a subtotal
each time field_value changes.</p>
<p>Othewise <tt class="docutils literal"><span class="pre">func</span></tt> will be set as break_function. Break function must have
this signature:</p>
<div class="highlight-python"><pre>def break_func(obj, field_name, path)</pre>
</div>
<p>see <tt class="docutils literal"><span class="pre">func_date_*</span></tt> is this module for examples</p>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.table.totals.Totals.add_date_break">
<tt class="descname">add_date_break</tt><big>(</big><em>field_name</em>, <em>period</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.add_date_break" title="Permalink to this definition">¶</a></dt>
<dd>Set date break period can be: <tt class="docutils literal"><span class="pre">day</span></tt>, <tt class="docutils literal"><span class="pre">week</span></tt>, <tt class="docutils literal"><span class="pre">month</span></tt>, <tt class="docutils literal"><span class="pre">quarter</span></tt>, <tt class="docutils literal"><span class="pre">year</span></tt></dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.table.totals.Totals.compute">
<tt class="descname">compute</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.compute" title="Permalink to this definition">¶</a></dt>
<dd>Go, add subtotals and total</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.table.totals.Totals.sum">
<tt class="descname">sum</tt><big>(</big><em>obj</em>, <em>model</em>, <em>path</em>, <em>iter</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.Totals.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>sum values and store result in <a title="sqlkit.widgets.table.totals.Totals.totals" class="reference internal" href="#sqlkit.widgets.table.totals.Totals.totals"><tt class="xref docutils literal"><span class="pre">totals</span></tt></a> and <a title="sqlkit.widgets.table.totals.Totals.subtotals" class="reference internal" href="#sqlkit.widgets.table.totals.Totals.subtotals"><tt class="xref docutils literal"><span class="pre">subtotals</span></tt></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>obj</em> &#8211; the obj that should be added. It&#8217;s an instance of <tt class="docutils literal"><span class="pre">table.mapper.class_</span></tt></li>
<li><em>model</em> &#8211; the model of the treeview</li>
<li><em>path</em> &#8211; the path at which the obj is</li>
<li><em>iter</em> &#8211; the iter at which the obj is</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>To customize the behaviour of total you can just customize this
method, suppose you want to make it sum flagged objects in table t:</p>
<div class="highlight-python"><pre>class BoolTotals(totals.Totals):

    def sum(self, obj, model, path, iter):
        if obj.flag:
            for field_name in self.totals.keys():
                self.totals[field_name]    += getattr(obj, field_name, 0) or 0
                self.subtotals[field_name] += getattr(obj, field_name, 0) or 0

t. = SqlTable(...)
t.totals = BoolTotal(t)</pre>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlkit.widgets.table.totals.TotalObj">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.table.totals.</tt><tt class="descname">TotalObj</tt><big>(</big><em>fields</em>, <em>sub=True</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.TotalObj" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple class that represents the object holding the totals and a way to represent it</p>
<p>personalization</p>
<p>You can change the look of totals inheriting from TotalObj and placing the new class
as <tt class="docutils literal"><span class="pre">class</span></tt> attribute of Totals</p>
<dl class="method">
<dt id="sqlkit.widgets.table.totals.TotalObj.set_value_and_colors">
<tt class="descname">set_value_and_colors</tt><big>(</big><em>cell</em>, <em>value</em>, <em>field_name</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.table.totals.TotalObj.set_value_and_colors" title="Permalink to this definition">¶</a></dt>
<dd>set the color cell and possibly background</dd></dl>

</dd></dl>

</div>
</div>
</div>


            </div>
        </div>
     </div>
   </div>

        
</div> <!-- wrap -->

            <div class="bottomnav footer">
                <div class="doc_copyright">
                Alessandro Dentella -- Copyright 2006-2007-2008-2009-2010
		  Sqlkit release 0.9.5.1
<!--                 % if hasdoc('copyright'): -->
<!--                     &copy; <a href="../copyright.html">Copyright</a> 2008, Sandro Dentella. -->
<!--                 % else: -->
<!--                     &copy; Copyright 2008, Sandro Dentella. -->
<!--                 % endif -->
                    creato usando  <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
                </div>
            </div>
        












<br style="clear: left" />

    </body>
</html>




