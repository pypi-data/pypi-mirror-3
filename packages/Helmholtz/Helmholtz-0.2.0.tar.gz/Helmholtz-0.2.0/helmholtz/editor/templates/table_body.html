{% load markups %}

{% for child in detail %}
<tr class="{% cycle even,odd %}">
 {% if child.expander != "disabled" %}
 <td class="action_cell" id="expander_{{child.view.name}}_{{child.index}}">
  <a href="{% url execute-command child.view.name %}?action={% if child.state == "opened" %}close{% else %}open{% endif %}&node_id={{child.index}}#expander_{{child.view.name}}_{{child.index}}">
   <img src="{{MEDIA_URL}}images/node_expander_{{child.state}}.png"></img>
  </a>
 </td>
 {% else %}
 <td id="expander_{{child.view.name}}_{{child.index}}">
  <img class="dot" src="{{MEDIA_URL}}images/node_expander_square.png"></img>
 </td>
 {% endif %}
 
 {% for cell in child.cell_nodes %}
  {% if cell.is_image %}
 <td class="image_node"> 
  <img src="{{MEDIA_URL}}{{node.value}}" alt="file '{{MEDIA_URL}}{{node.value}}' not found on server"></img>
 </td>  
  {% else %}
 <td>
  {% if cell.value == None or cell.value == "" %}
  <span class="nd">N.D</span>
  {% else %}
  
  <span class="cell_value">{{cell.value|safe|auto_markup}}</span>
  {% endif %}
 </td>
  {% endif %}
 {% endfor %}
 {% with child as node %}
  {% for action in node.ordered_displayed_actions reversed %}
   <td class="action_cell">{% include "action_button.html" %}</td>
  {% endfor %}
 {% endwith %}
  {% comment %}
  <td class="action_cell">
   <input type="checkbox" name="selected_objects" value="{{child.content_type.pk}}.{{child.record.pk}}"></input>
  </td>
  {% endcomment %}
 </tr>
 {% if child.expander != "disabled" and child.state == "opened" %}
 <tr class="expanded_row">
  <td class="cell_details" colspan="{{node.expansion_colspan}}">
   {% for node in child.detail %}
    {% include node_filename %}	
   {% endfor %}
  </td>
 </tr> 
 {% endif %} 
{% endfor %} 
