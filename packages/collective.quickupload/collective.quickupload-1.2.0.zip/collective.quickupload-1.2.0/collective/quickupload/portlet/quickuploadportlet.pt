<dl class="portlet QuickUploadPortlet"
    i18n:domain="collective.quickupload">

    <dt class="portletHeader"
        tal:define="ptitle view/data/title"
        tal:condition="ptitle">
        <span class="portletTopLeft"></span>
        <span tal:content="ptitle" />
        <span class="portletTopRight"></span>
    </dt>

    <dd class="portletItem odd lastItem">
      <script  type="text/javascript">
          // workaround this MSIE bug :
          // https://dev.plone.org/plone/ticket/10894
          if (jQuery.browser.msie) jQuery("#settings").remove();
          var Browser = {};
          Browser.onUploadComplete = function() {
              window.location.reload();
          }
          loadUploader = function() {
              var ulContainer = jQuery('.QuickUploadPortlet .uploaderContainer');
              ulContainer.each(function(){
                  var uploadUrl =  jQuery('.uploadUrl', this).val();
                  var uploadData =  jQuery('.uploadData', this).val();
                  var UlDiv = jQuery(this);
                  jQuery.ajax({
                             type: 'GET',
                             url: uploadUrl,
                             data: uploadData,
                             dataType: 'html',
                             contentType: 'text/html; charset=utf-8',
                             success: function(html) {
                                UlDiv.html(html);
                             } });
              });
          }
          jQuery(document).ready(loadUploader);
      </script>
      <div class="uploaderContainer">
          <input type="hidden"
                 name="uploadUrl"
                 class="uploadUrl"
                 tal:attributes="value view/getUploadUrl" />
          <input type="hidden"
                 name="uploadData"
                 class="uploadData"
                 tal:attributes="value view/getDataForUploadUrl" />
      </div>
      <span class="portletBottomLeft"></span>
      <span class="portletBottomRight"></span>
    </dd>

</dl>
