#
# pgp-keyserver-schema.conf
#
# PGP Key Server schema
#

#I added 
#attribute pgpBasePendingDN     1.3.6.1.4.1.3401.8.2.7  cis
attributeType ( 1.3.6.1.4.1.3401.8.2.7
	NAME 'basePendingDN'
	EQUALITY caseIgnoreMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )
 
#attribute pgpBaseKeySpaceDN     1.3.6.1.4.1.3401.8.2.8  cis
attributeType ( 1.3.6.1.4.1.3401.8.2.8
	NAME 'baseKeySpaceDN'
	EQUALITY caseIgnoreMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )
 
#attribute pgpSoftware           1.3.6.1.4.1.3401.8.2.9  cis
attributeType ( 1.3.6.1.4.1.3401.8.2.9
	NAME 'Software'
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )
#	EQUALITY caseIgnoreMatch

#attribute pgpVersion            1.3.6.1.4.1.3401.8.2.10 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.10
	NAME 'Version'
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )
#	EQUALITY caseIgnoreMatch 
	
#attribute pgpKey                1.3.6.1.4.1.3401.8.2.11 ces
attributeType ( 1.3.6.1.4.1.3401.8.2.11
	NAME 'pgpKey'
	EQUALITY caseIgnoreMatch
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26 )

#attribute pgpCertID             1.3.6.1.4.1.3401.8.2.12 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.12
	NAME  'pgpCertID'
	EQUALITY caseIgnoreMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpDisabled           1.3.6.1.4.1.3401.8.2.13 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.13
	NAME 'pgpDisabled' 
	EQUALITY caseIgnoreMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpKeyID              1.3.6.1.4.1.3401.8.2.14 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.14
	NAME 'pgpKeyID'
	EQUALITY caseIgnoreMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpKeyType            1.3.6.1.4.1.3401.8.2.15 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.15
	NAME 'pgpKeyType'
	EQUALITY caseExactMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpUserID             1.3.6.1.4.1.3401.8.2.16 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.16
	NAME 'pgpUserID'   
	EQUALITY caseIgnoreMatch 
	SUBSTR caseIgnoreSubstringsMatch
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpKeyCreateTime      1.3.6.1.4.1.3401.8.2.17 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.17
	NAME 'pgpKeyCreateTime'
	EQUALITY caseExactMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpSignerID           1.3.6.1.4.1.3401.8.2.18 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.18
	NAME 'pgpSignerID'
	EQUALITY caseIgnoreMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpRevoked            1.3.6.1.4.1.3401.8.2.19 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.19
	NAME 'pgpRevoked'
	EQUALITY caseExactMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpSubKeyID           1.3.6.1.4.1.3401.8.2.20 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.20
	NAME 'pgpSubKeyID'
	EQUALITY caseIgnoreMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpKeySize            1.3.6.1.4.1.3401.8.2.21 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.21
	NAME 'pgpKeySize'
	EQUALITY caseExactMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#attribute pgpKeyExpireTime      1.3.6.1.4.1.3401.8.2.22 cis
attributeType ( 1.3.6.1.4.1.3401.8.2.22
	NAME 'pgpKeyExpireTime' 
	EQUALITY caseExactMatch 
	SYNTAX	1.3.6.1.4.1.1466.115.121.1.15 )

#objectclass pgpServerInfo
#    oid 1.3.6.1.4.1.3401.8.2.23
#    requires
#        objectclass,
#        cn,
#        pgpBaseKeySpaceDN
#    allows
#        pgpSoftware,
#        pgpVersion
objectclass ( 1.3.6.1.4.1.3401.8.2.23
	NAME 'pgpServerInfo'
	MUST ( objectclass $ cn $ baseKeySpaceDN $ basePendingDN )
	MAY  (Software $ Version ) )

#objectclass pgpKey
#    oid 1.3.6.1.4.1.3401.8.2.24
#    requires
#        objectclass,
#        pgpKey
#    allows
#        pgpCertID,
#        pgpDisabled,
#        pgpKeyID,
#        pgpKeyType,
#        pgpUserID,
#        pgpKeyCreateTime,
#        pgpSignerID,
#        pgpRevoked,
#        pgpSubKeyID,
#        pgpKeySize,
#        pgpKeyExpireTime

objectclass ( 1.3.6.1.4.1.3401.8.2.24
	NAME 'pgpKey'
	MUST ( objectclass $ pgpKey )
	MAY  ( pgpCertID $ pgpDisabled $ pgpKeyID $ pgpKeyType $ pgpUserID $ pgpKeyCreateTime $ pgpSignerID $ pgpRevoked $ pgpSubKeyID $ pgpKeySize $ pgpKeyExpireTime ) )

objectclass ( 1.3.6.1.4.1.3401.8.2.25
	NAME 'pgpUserID'
	MUST  ( objectclass $ pgpCertID $ pgpDisabled $ pgpKeyID $ pgpKeyType $ pgpUserID $ pgpKeyCreateTime $ pgpSignerID $ pgpRevoked $ pgpKeySize $ pgpKeyExpireTime $ modifyTimestamp) 
	MAY  ( pgpSubKeyID ) )

objectclass ( 1.3.6.1.4.1.3401.8.2.26
	NAME 'pgpCertificate'
	MUST ( objectclass $ pgpKey )
	MAY  ( version $ modifyTimestamp ) )

# added by WAM
#objectclass ( 1.3.6.1.4.1.3401.8.2.27
#	NAME 'pgpKeyRepositoryBase'
#	MUST ( objectclass $ pgpCertId ) )
