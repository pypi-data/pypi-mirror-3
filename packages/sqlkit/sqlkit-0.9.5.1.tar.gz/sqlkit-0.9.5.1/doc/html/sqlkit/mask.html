<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      
      <title>
    SqlMask
 &mdash; sqlkit v0.9.5.1 documentation</title>
      
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sqlkit.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="sqlkit v0.9.5.1 documentation" href="../index.html" />
        <link rel="up" title="Widgets" href="widgets.html" />
        <link rel="next" title="SqlTable" href="table.html" />
        <link rel="prev" title="Sqlwidget" href="sqlwidget.html" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '0.9.5.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>


<!-- <link rel="stylesheet" href="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.css" type="text/css" /> -->
      <link rel="stylesheet" href="../_static/jMenu.jquery.css" type="text/css" />

      <!-- <script type="text/javascript" src="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.js"></script> -->

      <script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-18221996-2']);
	_gaq.push(['_trackPageview']);

	(function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

      </script>
      <script type="text/javascript" src="../_static/jMenu.jquery.js"></script>
      <script type="text/javascript">
	      $(document).ready(function(){
		      $("#jMenu").jMenu({
			      ulWidth : '150',
			      effects : {
				      effectSpeedOpen : 300,
				      effectSpeedClose : 300,
				      effectTypeOpen : 'slide',
				      effectTypeClose : 'slide',
				      effectOpen : 'linear',
				      effectClose : 'linear'
			      },
			      TimeBeforeOpening : 100,
			      TimeBeforeClosing : 400,
			      animatedText : false,
			      paddingLeft: 1		});
	      })
      </script>
<!-- Preview -->
     <script type="text/javascript" src="../_static/imgpreview.js"></script>
     <script type="text/javascript">
       $(document).ready(function(){
           $('.preview').imgPreview();
       });
     </script>
     
     <!--[if !IE 7]>
	     <style type="text/css">
		     #wrap {display:table;height:100%}
	     </style>
     <![endif]-->
    </head>
    <body>
        




<div id="wrap">
    
<div id="header">

	<div class="logo"><a href="../misc/tour.html">
       <img src="../_static/sqlkit.png" align="left"  alt="Logo" border="0"/></a>
        </div>
	<div id="description">Acces to db made easy</div>
</div>


   <div style="clear:left;"></div>


<div >
	<ul id="jMenu">
            <li><a class="fNiv" href="../index.html" title="Home" 
                  >Home</a></li>

            <li><a li class="fNiv" href="contents.html"
                  title="Sqlkit - the python package" 
                  >Sqlkit</a>

	       <ul>
		 <li ><a href="contents.html"
		       title="Sqlkit - the python package" 
		       >Sqlkit</a></li>

		 <li ><a href="sqlwidget.html" title="Widgets" 
		       >Widgets</a>
		       <ul> 
			 <li ><a href="#" title="Mask" 
			       >Mask view</a></li>
			 <li ><a href="table.html" title="Table" 
			       >Table view</a></li>
		       </ul>
                 </li>
		 <li ><a href="browsing.html" title="Browsing Data" 
		       >Browsing data</a>
		    <ul> 
		      <li ><a href="constraints.html" title="Constraints" 
			    >Constraints</a></li>
		      <li ><a href="filters.html" title="Filters" 
			    >Filters</a></li>
		      <li ><a href="totals.html" title="Totals" 
			    >Totals</a></li>
		    </ul>
                 </li>
		 <li ><a href="editing.html" title="Editing Data" 
		       >Editing data</a>
			 <ul> 
			   <li ><a href="completion.html" title="Completion" 
				 >Completion</a></li>
			   <li ><a href="validation.html" title="Validation" 
				 >Validation</a></li>
			   <li ><a href="relationship.html" title="Relationships" 
				 >Relationships</a></li>
			 </ul>
		       </li>
		 <li ><a href="printing.html" title="Printing" 
		       ><span>Printing</span></a></li>
		 <li ><a href="advanced/contents.html" title="Advanced configuration" 
		       >Advanced configuration</a>
			 <ul> 
			   <li ><a href="advanced/fields.html" title="Fields" 
				 >Fields</a></li>
			   <li ><a href="advanced/views.html" title="Views" 
				 >Views</a></li>
			 </ul>
		       </li>

	       </ul>
            </li>

            <li><a class="fNiv" href="../misc/sqledit.html"
                  title="Sqledit GUI" 
                  >Sqledit GUI</a></li>

            <li><a class="fNiv" href="../misc/tutorials.html"
                  title="Support & tutorials" 
                  >Support & Tutorials</a>
	       <ul>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Sqledit - the application</a></li>
		 <li ><a href="../misc/tour.html"
		       title="Sqlkit - the features'tour"
		       >Sqlkit - features' tour</a></li>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Installing instructions</a></li>
		</ul> 
            </li>

            <li><a class="fNiv" href="../layout/contents.html" title="Layout"
                  >Layout</a></li>

            <li><a  class="fNiv"href="../misc/contents.html" title="Download" 
                  >Download</a>

	       <ul>
		 <li ><a href="../misc/contents.html"
		       title="Download"
		       >Download</a></li>
		 <li ><a href="http://sqlkit.argolinux.org/download/Changelog"  title="Changelog"
		       title="Changelog"
		       >Changelog</a></li>
		 <li ><a href="../misc/backward_incompatibilities.html"
		       title="Backward incompatibilities"
		       >Backward incompatibilities</a></li>
	       </ul>
            </li>



        </ul>
</div>
   <div style="clear:left;"></div>

    
    <div class="related">
      <ul>
	
<!-- <div class="prevnext"> -->
<!--    <li class="right"  style="margin-right: 10px">Indice -->
<!--      <a href="../genindex.html" title="Indice generale" -->
<!--                accesskey="I">indice</a></li> -->

        <li class="right">Prev:
        <a href="sqlwidget.html" title="previous chapter">Sqlwidget</a></li>
        <li class="right">Next:
        <a href="table.html" title="next chapter">SqlTable</a></li>
<!-- </div> -->


      </ul>

    </div>

    
  <div class="sphinxsidebar">
     <div class="sphinxsidebarwrapper">


	    <div class="topnav">
    <h3>Table of contents</h3>
		    <ul>
<li><a class="reference external" href="#">SqlMask</a><ul>
<li><a class="reference external" href="#layout">layout</a><ul>
<li><a class="reference external" href="#gtk-refinements">gtk refinements</a></li>
<li><a class="reference external" href="#shortcuts">Shortcuts</a></li>
</ul>
</li>
<li><a class="reference external" href="#signals">Signals</a></li>
<li><a class="reference external" href="#save-as">Save as</a></li>
</ul>
</li>
</ul>

		<div class="clearboth"></div>
	    </div>



    <h3>Questions?</h3>

    <p>Subscribe to out mailing list <a href="http://groups.google.com/group/sqlkit">
       Google group</a>:</p>

    <form action="http://groups.google.com/group/sqlkit/boxsubscribe" style="padding-left: 1em">
      <input type="text" name="email" value="your@email"/>
      <input type="submit" name="sub" value="Subscribe" />
    </form>
    <div id="searchbox" style="display: none">

    <h3>Quick search</h3>
	<form class="search" action="../search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />

	  <input type="hidden" name="area" value="default" />
	</form>
	<p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
	</p>
    <h3>License</h3>
	<img src="../_static/gplv3.png" alt="logo GPLv3">

    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>

     </div>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">

            <div class="body">
                
<div class="section" id="sqlmask">
<span id="mask"></span><h1>SqlMask<a class="headerlink" href="#sqlmask" title="Permalink to this headline">¶</a></h1>
<img align="right" alt="../_images/layout-simple.png" class="align-right" src="../_images/layout-simple.png" />
<div class="section" id="layout">
<h2>layout<a class="headerlink" href="#layout" title="Permalink to this headline">¶</a></h2>
<p>The most powerful part of SqlMask is the ability to <strong>define the layout via
simple text description</strong>. In the examples you&#8217;ll see how easy it is to create
fancy layout that have all nice gtk Widgets like expanders, notebooks, panes
and it makes it incredibly easy to nest SqlTables into SqlMask to build
complex layouts that can also represent <a class="reference external" href="relationship.html#relationships"><em>Relationships</em></a>.</p>
<p>If you know ReST language and glade, it relates to glade as ReSt to html.</p>
<p>If no layout is provided a flat one will be generated on the fly.</p>
<p>The key is that a textual layout is parsed to see if the token are
recognized as fields of the table that the mask is editing, in which case
introspection is done to understand which widget should be used to edit the
data (according to rules above) and a label is added:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mylayout</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">   image</span>
<span class="s">   title</span>
<span class="s">   date_release</span>
<span class="s">   TXS=description</span>
<span class="s">   director_id</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">SqlMask</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Movie</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">mylayout</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>will creare a mask with an image, an entry, a date a text and a
fkey. <tt class="docutils literal"><span class="pre">title</span></tt> and <tt class="docutils literal"><span class="pre">director_id</span></tt> will be already instrumented with
completion: <tt class="docutils literal"><span class="pre">director_id</span></tt> will try to complete choosing the values of
directors from the <tt class="docutils literal"><span class="pre">director</span></tt> table, <tt class="docutils literal"><span class="pre">title</span></tt> will suggest completion based
on title present in the table (and in this case may not be very
useful). <tt class="docutils literal"><span class="pre">description</span></tt> would render as an entry as it&#8217;s a <em>varchar</em>, we wanted
to &#8220;cast&#8221; it to <em>text</em> using <tt class="docutils literal"><span class="pre">TXS=</span></tt>.</p>
<p>The description language you can use is pretty rich (and dynamic, so you can
add your custom made widgets): you&#8217;d better have  a look at the demo of
sqlkit.layout that you find in sqlkit.demo.layout</p>
<p>When parsing the textual layout, any token that is not recognized as a
field is passed as is to <tt class="docutils literal"><span class="pre">sqlkit.layout.Layout</span></tt></p>
<div class="section" id="gtk-refinements">
<h3>gtk refinements<a class="headerlink" href="#gtk-refinements" title="Permalink to this headline">¶</a></h3>
<p>Occasionally you may need to refine your layout, change packing, visibility,
attribute an so on. You can reach the gtk widgets via the <tt class="docutils literal"><span class="pre">widgets</span></tt>
attribute of the SqlWidget. In example 26 we use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Tbl</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">widgets</span><span class="p">[</span><span class="s">&#39;T.a&#39;</span><span class="p">]</span>
<span class="n">Tbl</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">child_set_property</span><span class="p">(</span><span class="n">Tbl</span><span class="p">,</span> <span class="s">&#39;y-options&#39;</span><span class="p">,</span> <span class="n">gtk</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">gtk</span><span class="o">.</span><span class="n">FILL</span><span class="p">)</span>
</pre></div>
</div>
<p>that changes pack properties to a gtk.Table whose name is <tt class="docutils literal"><span class="pre">T.a</span></tt>. If you
have ipython you can start the demo with option -i to gain an interactive
shell to play with an experiment with the widgets. By default each field has
a label whose key in widgets dict is <tt class="docutils literal"><span class="pre">l=field_name</span></tt> while each entry is
<tt class="docutils literal"><span class="pre">e=field_name</span></tt>.</p>
</div>
<div class="section" id="shortcuts">
<h3>Shortcuts<a class="headerlink" href="#shortcuts" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">mouse scrolling:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">allows to browse the records that have been loaded by a
reload operation</td>
</tr>
<tr class="field"><th class="field-name">Control-s:</th><td class="field-body">saves the record</td>
</tr>
<tr class="field"><th class="field-name">Control-q:</th><td class="field-body">quits the table</td>
</tr>
<tr class="field"><th class="field-name">Control-n:</th><td class="field-body">opens a new record</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="signals">
<h2>Signals<a class="headerlink" href="#signals" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">pre-display:</th><td class="field-body"><blockquote class="first">
<p>this signal is emitted when current object has already been set but
field values have no been set. It can be used to configure custom
widgets whose appearance may depend on other values.</p>
</blockquote>
<dl class="last method">
<dt id="pre_display_cb">
<tt class="descname">pre_display_cb</tt><big>(</big><em>mask</em>, <em>obj</em><big>)</big><a class="headerlink" href="#pre_display_cb" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>mask</em> &#8211; the SqlMask that emitted the signal</li>
<li><em>obj</em> &#8211; the object currently selected or None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<p>
<span class="versionmodified">New in version 0.8.8.</span></p>
<a class="preview reference external image-reference" href="../_images/mask-demo.png"><img align="right" alt="../_images/mask-demo.png" class="preview align-right" src="../_images/mask-demo.png" style="width: 286.0px; height: 157.0px;" /></a>
</div>
<div class="section" id="save-as">
<span id="id1"></span><h2>Save as<a class="headerlink" href="#save-as" title="Permalink to this headline">¶</a></h2>
<p>Masks have a function <em>save as new record</em>, that allows to duplicate a
record (corresponding to table&#8217;s <a class="reference external" href="table.html#row-duplicating"><em>row duplicating</em></a>).
It&#8217;s important you understand exactly what it does so that:</p>
<blockquote>
<ul>
<li><p class="first">it nullifyes the primary key, so that a new one will be generated. If the
primary key is visible and editable in the mask, it&#8217;s up to you to delete
it or change it according to your needs</p>
</li>
<li><p class="first">m2m relations: for each <em>visible</em> relation, i.e. each relation that is
shown by the mask <strong>and is of type many to many</strong> it copies the
records. As an example: actors would be copied in the second film.</p>
<p>If you want to change the new record in the related table (e.g.: actors)
do that <strong>only after saving</strong> otherwise you will also change the cast of
the original film, that&#8217;s different from other fields as table&#8217;mode is to
save in the same moment you edit.</p>
</li>
<li><p class="first">o2m relations: if o2m relations are present a warning is displayed that
those fields will not be copied <strong>unless you have an on_save_as hook</strong>
that would mean you are already handling this case.</p>
<p>Blindly copying the records would <em>steal</em> the references from the other
record. Just to be explicit: suppose to have a mask of a director with
his films, the director is Fellini and the film <em>La strada</em>. Duplicating
the record &#8220;Fellini&#8221; with &#8220;Fellini 2&#8221; should probably be a 1^st step in
personalizing some fields. In no way you want to divert the
<tt class="docutils literal"><span class="pre">director_id</span></tt> of the film &#8220;La strada&#8221; that should continue to point to
the original record &#8220;Fellini&#8221;.</p>
</li>
<li><p class="first">visible fields are copied from one record to the other. Please note
carefully this point: a new empty record is set as current record and
each visible fields is furtherly saved in the new record. If a field is
not visible that field will not get copied. You may have problems if
required fields are not visible. To allow to fill with new values a
<a class="reference external" href="sqlwidget.html#hooks"><em>hook</em></a> is invoked named <a class="reference external" href="sqlwidget.html#on-save-as"><em>on_save_as</em></a>.</p>
</li>
</ul>
</blockquote>
<dl class="class">
<dt id="sqlkit.widgets.SqlMask">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.</tt><tt class="descname">SqlMask</tt><a class="headerlink" href="#sqlkit.widgets.SqlMask" title="Permalink to this definition">¶</a></dt>
<dd><p>SqlMask is the widget that displays one record at a time and buttons to
browse data, save/delete records. SqlMask is inherited from
<a title="sqlkit.widgets.common.sqlwidget.SqlWidget" class="reference external" href="sqlwidget.html#sqlkit.widgets.common.sqlwidget.SqlWidget"><tt class="xref docutils literal"><span class="pre">sqlkit.widgets.common.sqlwidget.SqlWidget</span></tt></a></p>
<dl class="method">
<dt id="sqlkit.widgets.SqlMask.get_widget">
<tt class="descname">get_widget</tt><big>(</big><em>field_name</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.SqlMask.get_widget" title="Permalink to this definition">¶</a></dt>
<dd>get the widget that renders field_name</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.SqlMask.clear_mask">
<tt class="descname">clear_mask</tt><big>(</big><em>check=True</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.SqlMask.clear_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>clear the mask for a new record
NOTE: this does NOT prepare for a new record (missing obj)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>widget</em> &#8211; </li>
<li><em>check</em> &#8211; boolean: false prevent a check</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.SqlMask.set_frame_label">
<tt class="descname">set_frame_label</tt><big>(</big><em>frame_name</em>, <em>markup_label</em>, <em>opts='bi'</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.SqlMask.set_frame_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a label to the frame whose key in self.widgets is &#8216;frame_key&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>frame_name</em> &#8211; the key in <tt class="xref docutils literal"><span class="pre">self.widgets</span></tt></li>
<li><em>markup_label</em> &#8211; the label with possible markup</li>
<li><em>opts</em> &#8211; a combination of b (bold) and i (italic). Default: &#8216;bi&#8217;</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>In example 15:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">LAYOUT</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s"> {|.number .. }</span>
<span class="s"> ...</span>
<span class="s">&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>m.set_frame_label(&#8216;number&#8217;, &#8216;Number&#8217;)</p>
</dd></dl>

</dd></dl>

<p>Introspection of the table is used to determine which widgets will be used to
edit the data. The following rules are applied:</p>
<blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">varchar:</th><td class="field-body">gtk.Entry</td>
</tr>
<tr class="field"><th class="field-name">numbers:</th><td class="field-body">gtk.Entry with right alignment</td>
</tr>
<tr class="field"><th class="field-name">bool:</th><td class="field-body">gtk.CheckBox</td>
</tr>
<tr class="field"><th class="field-name">text:</th><td class="field-body">gtk.Text</td>
</tr>
<tr class="field"><th class="field-name">FKey:</th><td class="field-body">fk_edit (a custom ComboBoxEntry)</td>
</tr>
<tr class="field"><th class="field-name">date/datetime:</th><td class="field-body">dateedit (entry + arrow for calendar + time)</td>
</tr>
<tr class="field"><th class="field-name">default:</th><td class="field-body">gtk.Entry</td>
</tr>
</tbody>
</table>
</blockquote>
<p>All fields will have a label that is sensitive to mouse clicks. A mouse
click pops up a <a class="reference external" href="filters.html#filters"><em>filter</em></a> widget.</p>
</div>
</div>


            </div>
        </div>
     </div>
   </div>

        
</div> <!-- wrap -->

            <div class="bottomnav footer">
                <div class="doc_copyright">
                Alessandro Dentella -- Copyright 2006-2007-2008-2009-2010
		  Sqlkit release 0.9.5.1
<!--                 % if hasdoc('copyright'): -->
<!--                     &copy; <a href="../copyright.html">Copyright</a> 2008, Sandro Dentella. -->
<!--                 % else: -->
<!--                     &copy; Copyright 2008, Sandro Dentella. -->
<!--                 % endif -->
                    creato usando  <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
                </div>
            </div>
        












<br style="clear: left" />

    </body>
</html>




