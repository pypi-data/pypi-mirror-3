define(["coweb/jsoe/Operation","coweb/jsoe/factory"],function(a,b){var c=function(b){this.type="update",a.call(this,b)};c.prototype=new a,c.prototype.constructor=c,b.registerOperationForType("update",c),c.prototype.transformMethod=function(){return"transformWithUpdate"},c.prototype.transformWithUpdate=function(a){if(a.position!==this.position||a.key!==this.key)return this;this.siteId>a.siteId?this.value=a.value:this.siteId===a.siteId&&this.seqId<a.seqId&&(this.value=a.value);return this},c.prototype.transformWithInsert=function(a){if(this.key!==a.key)return this;this.position>=a.position&&++this.position;return this},c.prototype.transformWithDelete=function(a){if(this.key!==a.key)return this;if(this.position>a.position)--this.position;else if(this.position===a.position)return null;return this};return c})