

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Internationalization &mdash; Camelot  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Camelot  documentation" href="../index.html" />
    <link rel="up" title="Advanced Topics" href="index.html" />
    <link rel="next" title="Unittests" href="unittests.html" />
    <link rel="prev" title="Advanced Topics" href="index.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2652891-3']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="unittests.html" title="Unittests"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Advanced Topics"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Advanced Topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="internationalization">
<span id="dolc-i18n"></span><h1>Internationalization<a class="headerlink" href="#internationalization" title="Permalink to this headline">¶</a></h1>
<p>The Camelot translation system is a very small wrapper around the Qt translation
system.  Internally, it uses the <tt class="xref py py-meth docutils literal"><span class="pre">QCoreApplication.translate()</span></tt> method to
do the actual translation.</p>
<p>On top of that, it adds the possibility for end users to change translations
theirselves.  Those translations are stored in the database.  This mechanism
can be used to adapt the vocabulary of an application to that of a specific
company.</p>
<div class="section" id="how-to-specify-translation-strings">
<h2>How to Specify Translation Strings<a class="headerlink" href="#how-to-specify-translation-strings" title="Permalink to this headline">¶</a></h2>
<p>Translation strings specify “This text should be translated.”. It’s your responsibility
to mark translatable strings; the system can only translate strings it knows about.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">camelot.core.utils</span> <span class="kn">import</span> <span class="n">ugettext</span> <span class="k">as</span> <span class="n">_</span>

<span class="n">message</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Hello brave new world&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The above example translates the given string immediately.  This is not always desired,
since the message catalog might not yet be loaded at the time of execution.  Therefore
translation strings can be specified as lazy.  They will only get translated when they
are used in the GUI.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">camelot.core.utils</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="n">message</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;This translation is delayed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Translation strings in model definitions should always be specified as lazy translation
strings.  Only lazy translation strings can be translated by the end user in various
forms.</p>
</div>
<div class="section" id="translating-camelot-itself">
<h2>Translating Camelot itself<a class="headerlink" href="#translating-camelot-itself" title="Permalink to this headline">¶</a></h2>
<p>To extract translation files from the Camelot source code,
<a class="reference external" href="http://babel.edgewall.org/">Babel</a> needs to be installed.</p>
<p>In the root folder of the Camelot source directory.</p>
<p>First update the translation template:</p>
<div class="highlight-python"><pre>python setup.py extract_messages</pre>
</div>
<p>If your language directory does not yet exists in &#8216;camelot/art/translations&#8217;:</p>
<div class="highlight-python"><pre>python setup.py init_catalog --locale nl</pre>
</div>
<p>If it allready exists, update it from the translation template:</p>
<div class="highlight-python"><pre>python setup.py update_catalog</pre>
</div>
<p>In the language subdirectory of &#8216;camelot/art/translations&#8217;, there is a
subdirectory &#8216;LC_MESSAGES&#8217; which contains the .po translation file.
This translation file can then be translated with linguist</p>
<div class="highlight-python"><pre>linguist camelot.po</pre>
</div>
<p>And edit it :</p>
<blockquote>
<div><img alt="../_images/camelot_qt_linguist.png" src="../_images/camelot_qt_linguist.png" />
</div></blockquote>
<p>Make sure to save them back as GNU gettext .po files.</p>
<p>Then the .po file should be converted to a .qm file to make it loadable
at run time:</p>
<div class="highlight-python"><pre>lrelease camelot.po</pre>
</div>
<p>Don&#8217;t forget to post your new .po file on the mailing list, so it can
be included in the next release.</p>
<p>For more background information, please have a look at the
<a class="reference external" href="http://babel.edgewall.org/wiki/Documentation/setup.html">Babel Documentation</a></p>
</div>
<div class="section" id="where-to-put-translations">
<h2>Where to put Translations<a class="headerlink" href="#where-to-put-translations" title="Permalink to this headline">¶</a></h2>
<p>Translations can be put in 2 places :</p>
<blockquote>
<div><ul class="simple">
<li>in po files which have to be loaded at application startup</li>
<li>in the Translation table : this table is editable by the users via the Configuration
menu.  This is the place to put translations that should be editable by the users.  At
application startup, all records in this table related to the current language will be
put in memory.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="loading-translations">
<h2>Loading translations<a class="headerlink" href="#loading-translations" title="Permalink to this headline">¶</a></h2>
<p>Translations are loaded when the application starts.  To enforce the loading
of the correct translation file, one should overwrite the
<a class="reference internal" href="../doc/application_admin.html#camelot.admin.application_admin.ApplicationAdmin.get_translator" title="camelot.admin.application_admin.ApplicationAdmin.get_translator"><tt class="xref py py-meth docutils literal"><span class="pre">camelot.admin.application_admin.ApplicationAdmin.get_translator()</span></tt></a> method.
This method should return the proper <tt class="xref py py-obj docutils literal"><span class="pre">QtCore.QTranslator</span></tt> object.</p>
</div>
<div class="section" id="end-user-translations">
<h2>End user translations<a class="headerlink" href="#end-user-translations" title="Permalink to this headline">¶</a></h2>
<p>Often it is convenient to let the end user create or update the translations of an
application, this allows the end user to put a lot of domain knowledge into the application.</p>
<p>Therefore, all lazy translation strings can be translated by the end user.  When the user
right-clicks on a label in a form, he can select <em class="guilabel">Change translation</em> from the menu and
update the current translation (for the current language).  This effectively updates the
content of the <strong>Translation</strong> table.</p>
<p>After some time the developer can take a copy of this table and decide to put these translations
in po files.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Internationalization</a><ul>
<li><a class="reference internal" href="#how-to-specify-translation-strings">How to Specify Translation Strings</a></li>
<li><a class="reference internal" href="#translating-camelot-itself">Translating Camelot itself</a></li>
<li><a class="reference internal" href="#where-to-put-translations">Where to put Translations</a></li>
<li><a class="reference internal" href="#loading-translations">Loading translations</a></li>
<li><a class="reference internal" href="#end-user-translations">End user translations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Advanced Topics</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="unittests.html"
                        title="next chapter">Unittests</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/advanced/i18n.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="unittests.html" title="Unittests"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Advanced Topics"
             >previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" >Advanced Topics</a> &raquo;</li> 
      </ul>
    </div>

<br/>
<a href="http://example.com/my_article.html#disqus_thread">Comments</a>
<br/>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /**
    * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
    */

  /** var disqus_developer = 1 **/

  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://camelot.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=camelot">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 2009 - 2011, Conceptive Engineering.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
<div class="footer">
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

<script type="text/javascript">
var disqus_shortname = 'camelot';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://disqus.com/forums/camelot/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



  </body>
</html>