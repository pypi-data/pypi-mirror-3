[
    {
        "name": "Cisco | IOS | Security | Audit | Command #1 (SYSLOG)",
        "description": "1079: Aug 22 17:08:11.347: %PARSER-5-CFGLOG_LOGGEDCMD: User:tech  logged command:!exec: enable",
        "event_class__name": "Security | Audit | Command",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%PARSER-5-CFGLOG_LOGGEDCMD: User:(?P<user>.+?)\\s+logged command:(?P<command>.*)$" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Audit | Command (SNMP)",
        "description": "SNMPv2-MIB::snmpTraps",
        "event_class__name": "Security | Audit | Command",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^SNMPv2-MIB::snmpTraps$"
            },
            {
                "key_re": "^OLD-CISCO-INTERFACES-MIB::locIfReason\\.\\d+$",
                "value_re": "^administratively down$"
            },
            {
                "key_re": "^IF-MIB::ifDescr\\.\\d+$",
                "value_re": "^(?P<iface>\\S+)$"
            }
        ],
        "vars": [
            {
                "name": "command",
                "value": "='interface %s shutdown' % iface"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Audit | Command #2 (SYSLOG)",
        "description": "%LINK-5-CHANGED: Interface FastEthernet0/1, changed state to administratively down",
        "event_class__name": "Security | Audit | Command",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%LINK-5-CHANGED: Interface (?P<iface>.+?), changed state to administratively down" 
            }
        ],
        "vars": [
            {
                "name": "command",
                "value": "='interface %s shutdown' % iface"
            }
        ]
    }
]
