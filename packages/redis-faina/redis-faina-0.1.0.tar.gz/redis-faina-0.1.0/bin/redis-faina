#!/usr/bin/env python

import argparse
import sys
import os

sys.path.append(os.path.join(os.path.dirname(__file__), ".."))

from redis_faina import StatCounter

parser = argparse.ArgumentParser()
parser.add_argument(
    'input',
    type = argparse.FileType('r'),
    default = sys.stdin,
    nargs = '?',
    help = "File to parse; will read from stdin otherwise")
parser.add_argument(
    '--prefix-delimiter',
    type = str,
    default = ':',
    help = "String to split on for delimiting prefix and rest of key",
    required = False)
args = parser.parse_args()
counter = StatCounter(prefix_delim = args.prefix_delimiter)
counter.process_input(args.input)
counter.print_stats()

