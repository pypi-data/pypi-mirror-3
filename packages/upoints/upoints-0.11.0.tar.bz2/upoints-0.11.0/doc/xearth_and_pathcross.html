<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>xearth and path cross</title>
<link rel="stylesheet" href="docutils.css" type="text/css" />
</head>
<body>
<div class="document" id="xearth-and-path-cross">
<h1 class="title">xearth and path cross</h1>
<p>As a final comment in the <a class="reference" href="geolocation_and_pathcross.html">geolocation and path cross</a> entry I wrote:</p>
<blockquote>
If you think of any good uses for <tt class="docutils literal"><span class="pre">edist</span></tt>, drop me a mail.  Cool new
uses with attached patches are even better!</blockquote>
<p>The first chunk of feedback I received was from a co-worker, Kelly
Turner, who asked how difficult it would be to use <tt class="docutils literal"><span class="pre">edist</span></tt> with
<a class="reference" href="http://www.cs.colorado.edu/~tuna/xearth/">xearth</a>'s marker files.  The answer is not too difficult, not too
difficult at all.</p>
<p>As a little background the reason for wanting access to the data in
marker files is that our internal contact database allows us to export
a file containing a subset of our contact's known current locations
<a class="footnote-reference" href="#id2" id="id1" name="id1">[1]</a>.  The original reasoning behind the feature was to allow simple
visualisation of a team's members, for example to quickly locate
somebody who is close to a customer's site.</p>
<p>I've reworked the original <tt class="docutils literal"><span class="pre">edist.py</span></tt> script in to something a little
more generic, and it also now includes a new module, <tt class="docutils literal"><span class="pre">xearth.py</span></tt>, that
can import locations from an xearth marker file.  Unfortunately, I can't
use an example generated from our system because I don't have permission
to publish the data but I'll give an example of its usage with a public
file:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">from</span> <span class="nn">upoints</span> <span class="k">import</span> <span class="n">xearth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">earth_markers</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://xplanet.sourceforge.net/Extras/earth-markers-schaumann&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">markers</span> <span class="o">=</span> <span class="n">xearth</span><span class="o">.</span><span class="n">Xearths</span><span class="p">(</span><span class="n">earth_markers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="s">&#39;Cairo&#39;</span><span class="p">]))</span>
<span class="go">Xearth(30.05, 31.25, &#39;Egypt&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="s">&#39;Warsaw&#39;</span><span class="p">])</span>
<span class="go">Poland (N52.250°; E021.000°)</span>
</pre></div>
<p>There are plenty of comments in the <tt class="docutils literal"><span class="pre">xearth.py</span></tt> file, but what you get
from the <tt class="docutils literal"><span class="pre">xearth.Xearths()</span></tt> is a dictionary with the location name as
a key, and value consisting of a tuple of a <tt class="docutils literal"><span class="pre">point.Point</span></tt> object and
any associated comments from the source file.</p>
<p>You can use all the methods, such as <tt class="docutils literal"><span class="pre">distance</span></tt> and <tt class="docutils literal"><span class="pre">bearing</span></tt>,
that are defined in the <tt class="docutils literal"><span class="pre">point.Point</span></tt> class on <tt class="docutils literal"><span class="pre">Xearth</span></tt> objects.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&quot;Suva to Tokyo is </span><span class="si">%i</span><span class="s"> kM&quot;</span> <span class="o">%</span> <span class="n">markers</span><span class="p">[</span><span class="s">&#39;Suva&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="s">&#39;Tokyo&#39;</span><span class="p">]))</span>
<span class="go">Suva to Tokyo is 7253 kM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&quot;Vienna to Brussels on </span><span class="si">%i</span><span class="s">°&quot;</span> <span class="o">%</span> <span class="n">markers</span><span class="p">[</span><span class="s">&#39;Vienna&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bearing</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="s">&#39;Brussels&#39;</span><span class="p">]))</span>
<span class="go">Vienna to Brussels on 293°</span>
</pre></div>
<p>With the original purpose of the marker file export feature being
finding people local to a customer it would be nice to use <tt class="docutils literal"><span class="pre">xearth.py</span></tt>
to do the same in a more programmatic way, and of course that is
possible too.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Customer</span> <span class="o">=</span> <span class="n">xearth</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mf">52.015</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.221</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">markers</span><span class="p">:</span>
<span class="gp">... </span>     <span class="n">distance</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="n">marker</span><span class="p">])</span>
<span class="gp">... </span>     <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mf">300</span><span class="p">:</span>
<span class="gp">... </span>         <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%i</span><span class="s"> kM - </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markers</span><span class="p">[</span><span class="n">marker</span><span class="p">]))</span>
<span class="go">57 kM - London, United Kingdom (N51.500°; W000.170°)</span>
</pre></div>
<p>Imagining for a second the customer lives in my house, the only marker
within 300 kilometres of me in the city marker file we've imported is
London.</p>
<p>I'll end this entry with similar text to that which created it:  If you
think of any good uses for <tt class="docutils literal"><span class="pre">upoints</span></tt>, drop me a mail.  Cool new uses
with attached patches are even better!</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1" name="id2">[1]</a></td><td>All thanks to Simon Woods according to the source code
repository, so a big thanks to him!</td></tr>
</tbody>
</table>
<!-- :vim: set ft=rst ts=2 sw=2 et: -->
</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="xearth_and_pathcross.txt">View document source</a>.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>
