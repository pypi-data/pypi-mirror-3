[
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Login (SYSLOG)",
        "description": "sshd[69546]: Accepted keyboard-interactive/pam for sgrant from 10.88.5.4 port 1395 ssh2",
        "event_class__name": "Security | Authentication | Login",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Accepted keyboard-interactive/pam for (?P<user>.+?) from (?P<ip>\\S+) port \\d+ ssh\\S+"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Logout (SYSLOG)",
        "description": "sshd[69551]: Received disconnect from 193.34.22.119: 11: disconnected by user",
        "event_class__name": "Security | Authentication | Logout",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Received disconnect from (?P<ip>\\S+): 11: disconnected by user$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | TTY - Login (SYSLOG)",
        "description": "login: login on ttyv1 as root",
        "event_class__name": "Security | Authentication | Login",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "login: login on tty\\S+ as (?P<user>.+?)"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | TTY - Login Failed (SYSLOG)",
        "description": "login: 2 LOGIN FAILURES ON ttyv3, mitya",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "login: 2 LOGIN FAILURES ON tty\\S+, (?P<user>.+?)$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | TTY - Bad SU (SYSLOG)",
        "description": "su: BAD SU mitya to root on /dev/ttyp1",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "su: BAD SU (?P<user>.+?) to \\S+ on /dev/\\S+$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | TTY - Exec format error (SYSLOG)",
        "description": "getty[1039]: /usr/bin/login: Exec format error",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "getty\\[\\d+\\]: /usr/bin/login: Exec format error$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | TTY - Device not configured (SYSLOG)",
        "description": "login: in prompt_echo_off(): tcgetattr(): Device not configured",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "login: in prompt_echo_off\\(\\): tcgetattr\\(\\): Device not configured$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Invalid user (SYSLOG)",
        "description": "sshd[67611]: Invalid user jxen from 10.88.5.4",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Invalid user (?P<user>.+?) from (?P<ip>\\S+)$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Possible break-in attempt #1 (SYSLOG)",
        "description": "sshd[19646]: Address 10.110.0.2 maps to lan.cabletv.dp.ua, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Address (?P<ip>\\S+) maps to \\S+, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Possible break-in attempt #2 (SYSLOG)",
        "description": "sshd[82921]: reverse mapping checking getaddrinfo for 94-76-229-166.static.as29550.net [94.76.229.166] failed - POSSIBLE BREAK-IN ATTEMPT!",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: reverse mapping checking getaddrinfo for \\S+ \\[(?P<ip>\\S+)\\] failed - POSSIBLE BREAK-IN ATTEMPT!$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Did not receive identification string (SYSLOG)",
        "description": "sshd[77952]: Did not receive identification string from 10.111.0.33",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Did not receive identification string from (?P<ip>\\S+)$"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | SSH - Protocol major versions differ (SYSLOG)",
        "description": "sshd[80442]: Protocol major versions differ for 10.111.0.33: SSH-2.0-OpenSSH_5.4p1 FreeBSD-20100308 vs. SSH-1.5-NmapNSE_1.0",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "sshd\\[\\d+\\]: Protocol major versions differ for (?P<ip>\\S+): .+ vs\\. .+"
            }
        ]
    },
    
    {
        "name": "OS | FreeBSD | Security | Authentication | pam-helper - invalid password (SYSLOG)",
        "description": "pam_helper: gkr-pam: the password for the login keyring was invalid.",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^OS\\.FreeBSD$"
            },
            {
                "key_re": "^message$",
                "value_re": "pam_helper: \\S+: the password for the login (?P<user>.+?) was invalid.$"
            }
        ]
    }
]