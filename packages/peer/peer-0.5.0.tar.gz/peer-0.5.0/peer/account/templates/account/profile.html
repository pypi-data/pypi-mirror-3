{% extends "base.html" %}

{% load i18n account verification_tags %}

{% block content %}

{% include "account/menu.html" %}
<section class="mainContent">

  <hgroup>
    <h1>{% trans "Welcome" %}, {% safefullname user %}</h1>
  </hgroup>

  <h2 class="separator">{% trans "Your domains" %}</h2>

  {% if domains %}
  <ul class="domainList">
    {% for domain in domains %}
    <li class="{% if domain.validated %}validated{% else%}notValidated{% endif %}">
      <span class="ui-icon ui-icon-link"></span>
      <a href="{{ domain.validation_url }}">{{ domain }}</a>
      <a class="removeButton" href="{% url domain_remove domain.id %}">{% trans "Remove domain" %}</a>
      {% if not domain.validated %}
        {% verification_button domain %}
        <p class="helptext">{% trans "Tip: you must verify the ownership of this domain in order to add entities associated with it" %}</p>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>{% trans "It looks like you have not created any domain yet." %}

  <a href="{% url domain_add %}">{% trans "Do you want to create one?" %}</a></p>
  {% endif %}

  <h2 class="separator">{% trans "Your entities" %}</h2>
  {% if owned_entities %}
  <ul class="simpleList">
    {% for entity in owned_entities %}
    <li><a href="{{ entity.get_absolute_url }}">{{ entity }}</a></li>
    {% endfor %}
  </ul>

  {% else %}
  <p>{% trans "It looks like you have not created any entity yet." %}

  <a href="{% url entity_add %}">{% trans "Do you want to create one?" %}</a></p>
  {% endif %}

  {% if permission_delegations %}
  <h2 class="separator">{% trans "Entities you can manage" %}</h2>
  <ul class="simpleList">
    {% for delegation in permission_delegations %}
    <li><a href="{{ delegation.entity.get_absolute_url }}">{{ delegation.entity }}</a></li>
    {% endfor %}
  </ul>
  {% endif %}

</section>
{% endblock %}

{% block extrajs %}
<script type="text/javascript">
    (function ($) {
        $(document).ready(function () {
            $(".removeButton").button({
                icons: {primary: "ui-icon-trash"},
                text: false
            });
        });
    }(jQuery));
</script>
{% endblock %}
