<tal:left define="hidden python:request.set('disable_plone.leftcolumn', 1)" />
<tal:right define="hidden python:request.set('disable_plone.rightcolumn', 1)" />
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
  lang="en-US"
  metal:use-macro="here/main_template/macros/master"
  i18n:domain="eea.daviz">

<metal:jsslot fill-slot="javascript_head_slot">

  <!-- Custom babel-translators -->
  <link rel="exhibit/babel-translator"
    tal:attributes="href string:${here/absolute_url}/@@babel-translator" />

  <!-- Related items merged JSON -->
  <link rel="exhibit/data" type="application/json"
    tal:attributes="href string:${here/absolute_url}/@@daviz-relateditems.json" />

  <!-- External sources JSONs -->
  <tal:additional repeat="source python:view.sources">
  <link rel="exhibit/data"
    tal:attributes="
    type string:application/${source/type};
    href string:${source/name};
    ex:converter python:source.get('converter', None) or None;" />
  </tal:additional>

  <!-- Own JSON -->
  <link rel="exhibit/data" type="application/json"
    tal:attributes="href string:${here/absolute_url}/@@daviz-view.json" />

  <!-- include exhibit api -->
  <script type="text/javascript">
  <!--
    var daviz_jQuery = window.jQuery;
    var daviz_$ = window.$;
  //-->
  </script>
  <script tal:attributes="src string:++resource++eea.simile.exhibit/exhibit-api.js" type="text/javascript"></script>
  <script tal:attributes="src string:++resource++eea.simile.exhibit/extensions/time/time-extension.js"></script>
  <script tal:attributes="src string:++resource++eea.simile.exhibit/extensions/map/map-extension.js?gmapkey=${view/gmapkey}"></script>
  <script type="text/javascript">
  <!--
    window.jQuery = daviz_jQuery;
    window.$ = daviz_$;
  //-->
  </script>

</metal:jsslot>

<body>

<div metal:fill-slot="content-core">

<div tal:define="views python:view.views">
  <div id="daviz-view">
    <!-- Tabs -->
    <ul class="chart-tabs" tal:condition="python:len(view.sections) > 1">
      <li tal:repeat="section_title python:view.sections.items()">
        <a tal:define="
          section python:section_title[0];
          title python:section_title[1];"
          tal:attributes="
            href string:#tab-${section};
            class string:tab-${section};">
          <span tal:content="title" />
        </a>
      </li>
    </ul>
    <div style="clear: both"></div>

    <!-- Sections -->
    <div class="chart-panes">
      <div tal:repeat="section python:view.sections"
        tal:attributes="id string:tab-${section}">
        <tal:view replace="structure python:view.section(section)" />
      </div>
    </div>
    <div style="clear: both"></div>

  </div>
</div>

</div>
</body>
</html>
