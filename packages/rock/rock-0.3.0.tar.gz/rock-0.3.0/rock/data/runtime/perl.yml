env:
  PATH: "${PROJECT_PATH}/bin:${PROJECT_PATH}/local/bin:${PATH}"
  BUILD_PATH: "${PROJECT_PATH}/local"
  PERL_LOCAL_LIB_ROOT: "${PROJECT_PATH}/local"
  PERL_MB_OPT: "--install_base ${PROJECT_PATH}/local"
  PERL_MM_OPT: "INSTALL_BASE=${PROJECT_PATH}/local"
  PERL5LIB: "${PROJECT_PATH}/lib:${PROJECT_PATH}/lib/perl5/x86_64-linux:${PROJECT_PATH}/local/lib/perl5"

build: |

  if [[ -f ./cpanfile ]]; then
    carton install
  else
    warn 'no "cpanfile" file found'
  fi

build_deployment: |

  if [[ ! -f ./carton.lock ]]; then
    die 'no "carton.lock" file found'
  fi

  carton install --deployment

test: |

  prove

clean: |

  if [[ -d "${BUILD_PATH}" ]]; then
    rm -fr "${BUILD_PATH}"
  fi
