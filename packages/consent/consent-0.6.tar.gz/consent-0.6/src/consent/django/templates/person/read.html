{% extends "person/master.html"%}

{% block title %}
  {% if isSessionPerson %}
    {{ person.getLabelValue|escape }}
  {% else %}
    {% if person %}
    {{ person.getLabelValue|escape }}
    {% else %}
    Profile - No name specified!
    {% endif %}
  {% endif %}
{% endblock %}

{% block content %}

  {% if person %}
    {% if isSessionPerson %}
    <h2>Welcome, {{ person.getFirstName|escape }}</h2>
    <p>
      This page gives you an overview of your {{ systemServiceName|escape }} account.
    </p>
    {% else %}
    <h2>{{ person.getFirstName|escape }}&rsquo;s profile page</h2>
    <p>
      This is the profile page for {{ person.getLabelValue|escape }}.
    </p>
    {% endif %}
  <table>
    <tr>
      <th>Site</th>
      <th>Description</th>
    </tr>
    {% for membership in person.sites %}
    <tr>
      <td><a href="{{uriPrefix}}/sites/{{ membership.site.id }}/">{{ membership.site.getLabelValue }}</a></td>
      <td>{{ membership.site.description }}</td>
    </tr>
    {% endfor %}
  </table>


  {% else %}
    <h2>No name specified</h2>
    <p class="flash-error">
      You'll need to <a href="{{uriPrefix}}/people/">select a user</a> in order to see a user's profile page.<br />
      <br />
      If you were looking for your profile page, please <a href="{{uriPrefix}}/login/">log in</a>.
    </p>
  {% endif %}  

{% endblock %}

{% block primarysidebar %}
  <div class="action-box span-8">
    <div class="action-box-inner">
      <h2>{{person.getFirstName}}</h2>
{% if view.canUpdatePerson %}
      <ul>
        <li><a href="{{uriPrefix}}/people/{{domainObject.name}}/edit/">Edit profile</a></li>
        <li><a href="{{uriPrefix}}/people/{{domainObject.name}}/apikey/">View API Key</a></li>
      </ul>
{% endif %}
{% if view.canDeletePerson %}
      <ul>
        <li><a href="{{uriPrefix}}/people/{{domainObject.name}}/delete/">Delete account</a></li>
      </ul>
{% endif %}
    </div>
  </div>
{% endblock %}
