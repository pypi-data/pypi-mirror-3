var __slice=Array.prototype.slice,__bind=function(a,b){return function(){return a.apply(b,arguments)}};define("common/utils",[],function(){var a,b,c,d;return b=function(a,b){var c,d,e;e=[];for(d in b)c=b[d],e.push(a[d]=c);return e},c=function(a,c){return b(a.prototype,c)},d=function(a,b,c){var d,e,f,g,h,i;arguments.length<3&&(h=[typeof exports!="undefined"?exports:window].concat(__slice.call(arguments)),a=h[0],b=h[1],c=h[2]),e=a,i=b.split(".");for(f=0,g=i.length;f<g;f++)d=i[f],a=a[d]||(a[d]={});return c(a,e)},a=function(){function a(a){a.pending||(a.pending=0),b(this,a)}return a.prototype._ready=function(){var a;if(this._queue)return;return this._queue=[],a=setInterval(__bind(function(){var b,c,d,e;if(this.pending!==0)return;this._isReady=!0,clearTimeout(a),e=this._queue;for(c=0,d=e.length;c<d;c++)b=e[c],b();return delete this._queue},this),25)},a.prototype.ready=function(a){return this._ready(),this._isReady?a():this._queue.push(a)},a}(),{extend:b,include:c,namespace:d,App:a}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("common/models/polling",["common/utils"],function(a){var b,c,d;return b={pollInterval:1e4,initialize:function(){return this.startPolling()},startPolling:function(){return this._pollInterval=setInterval(__bind(function(){return this.poll()},this),this.pollInterval)},stopPolling:function(){return clearTimeout(this._pollInterval)}},d=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.Model),a.prototype.poll=function(){return this.fetch()},a}(),c=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.Collection),a.prototype.poll=function(){return this.fetch({update:!0})},a}(),a.include(d,b),a.include(c,b),{Model:d,Collection:c}});var __hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__bind=function(a,b){return function(){return a.apply(b,arguments)}};define("cilantro/types/report/models",["common/models/polling"],function(a){var b,c,d;return b=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.Model),a.prototype.url=function(){var b;return/\/$/.test(b=a.__super__.url.apply(this,arguments))||(b+="/"),b},a.prototype.initialize=function(){return this.bind("change",function(){return App.hub.publish("report/change",this)})},a}(),c=function(){function c(){c.__super__.constructor.apply(this,arguments)}return __extends(c,a.Collection),c.prototype.url=App.endpoints.reports,c.prototype.model=b,c.prototype.comparator=function(a){return-Number(new Date(a.get("modified")))},c}(),d=function(){function b(){b.__super__.constructor.apply(this,arguments)}return __extends(b,a.Model),b.prototype.url=App.endpoints.session.report,b.prototype.defaults={name:"click to give your report a name...",description:"click to give your report a description..."},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),App.hub.subscribe("report/clear",__bind(function(){return this.clear({silent:!0}),this.save(null,{success:function(){return window.location=App.endpoints.define}})},this)),App.hub.subscribe("report/change",__bind(function(a){if(a.id===this.get("reference_id"))return this.set(a.toJSON())},this))},b.prototype.push=function(){return this.save(null,{url:this.get("permalink"),success:function(){return App.hub.publish("report/push",this)}})},b.prototype.revert=function(){return this.save(null,{data:JSON.stringify({revert:!0}),contentType:"application/json",success:function(){return App.hub.publish("report/revert",this)}})},b}(),{Model:b,Collection:c,Session:d}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("common/views/collection",["common/utils"],function(a){var b,c,d;return b=function(){function a(){this.update=__bind(this.update,this),this.destroy=__bind(this.destroy,this),this.remove=__bind(this.remove,this),this.reset=__bind(this.reset,this),this.add=__bind(this.add,this),this.all=__bind(this.all,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.viewClass=Backbone.View,a.prototype.defaultContent=null,a.prototype.initialize=function(){this.childViews={},this.collection.bind("add",this.add),this.collection.bind("reset",this.reset),this.collection.bind("remove",this.remove),this.collection.bind("destroy",this.destroy),this.collection.bind("change",this.update);if(this.defaultContent)return this.collection.bind("all",this.all),this.defaultContent=this.$(this.defaultContent).detach(),this.el.append(this.defaultContent)},a.prototype.insertChild=function(a){return this.el.append(a.el)},a.prototype.all=function(){return this.collection.length?this.defaultContent.hide():this.defaultContent.show()},a.prototype.add=function(a){var b;return(b=this.childViews[a.id||a.cid])?clearTimeout(b._destroyTimer):(b=this.childViews[a.id||a.cid]=(new this.viewClass({model:a})).render(),this.insertChild(b)),b},a.prototype.reset=function(a,b){return a.each(this.add)},a.prototype.remove=function(a){var b;return b=this.childViews[a.id||a.cid],b.el.detach(),b._destroyTimer=setTimeout(__bind(function(){return this.destroy(a)},this),1e4)},a.prototype.destroy=function(a){return this.childViews[a.id||a.cid].el.remove()},a.prototype.update=function(a){var b;return b=this.childViews[a.id||a.cid],!b&&(b=this.childViews[a.cid])&&(this.childViews[a.id]=b,delete this.childViews[a.cid]),b.render()},a}(),c={collapsedLength:5,getItems:function(){return this.el.children()},getHiddenItems:function(){return this.getItems().filter(":gt("+(this.collapsedLength-1)+")")},getExpanderText:function(){return"Show "+this.getHiddenItems().length+" more.."},renderExpander:function(){return this.expander=$('<a class="expand-list" href="#">'+this.getExpanderText()+"</a>").bind("click",__bind(function(){return this.expand(),!1},this)),this.el.after(this.expander)},expand:function(){return this.getHiddenItems().show(),this.expander.remove()},collapse:function(){this.expander&&this.expander.remove();if(this.getItems().length>this.collapsedLength)return this.getHiddenItems().hide(),this.renderExpander()}},d=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a}(),a.include(d,c),{View:b,ExpandableListMixin:c,ExpandableList:d}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("cilantro/types/report/views",["common/utils","common/views/collection"],function(a,b){var c,d,e,f,g;return c=function(){function a(){this.editHandler=__bind(this.editHandler,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.el='<div id="report-editor">                <input type="text" name="name" placeholder="Name...">                <textarea name="description" placeholder="Description..."></textarea>                <div class="controls">                    <button class="cancel">Cancel</button>                    <button class="save">Save</button>                </div>            </div>',a.prototype.elements={"[name=name]":"name","[name=description]":"description",".save":"saveButton",".cancel":"cancelButton"},a.prototype.events={"click .save":"save","click .cancel":"cancel"},a.prototype.initialize=function(){return App.hub.subscribe("report/edit",this.editHandler),this.el.appendTo("body").dialog({dialogClass:"ui-dialog-simple",autoOpen:!1,modal:!0,resizable:!1,draggable:!0,position:["center",150],width:500})},a.prototype.editHandler=function(a){return this.name.val(a.get("name")),this.description.val(a.get("description")),this.activeModel=a,this.el.dialog("open")},a.prototype.save=function(){return this.activeModel.set({name:this.name.val(),description:this.description.val()}),this.activeModel.save(),this.activeModel.isNew()&&this.activeModel.collection.add(this.activeModel),delete this.activeModel,this.el.dialog("close")},a.prototype.cancel=function(){return delete this.activeModel,this.el.dialog("close")},a}(),d={edit:function(a,b){return b==null&&(b=this.model),App.hub.publish("report/edit",b),!1}},e=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.el='<section class="report">                    <strong><a role="name"></a></strong>                    <span class="info">- <span role="unique-count"></span> unique patients</span>                    <span class="info time" style="float: right">modified <span role="modified"></span><span role="timesince"></span></span>                    <div role="description"></div>                    <div class="controls">                        <button class="delete">Delete</button>                        <button class="edit">Edit</button>                        <button class="copy">Copy</button>                    </div>                </section>',a.prototype.events={"click .time":"toggleTime","click .edit":"edit","click .copy":"copy","click .delete":"delete",mouseenter:"showControls",mouseleave:"hideControls"},a.prototype.elements={"[role=name]":"name","[role=unique-count]":"uniqueCount","[role=modified]":"modified","[role=timesince]":"timesince","[role=description]":"description",".controls":"controls"},a.prototype.render=function(){var a;return this.name.text(this.model.get("name")),this.name.attr("href",this.model.get("permalink")),this.modified.text(this.model.get("modified")),this.timesince.text(this.model.get("timesince")),(a=this.model.get("description"))||(a="No description provided"),this.description.text(a),this.uniqueCount.text(this.model.get("unique_count")),this},a.prototype.toggleTime=function(a){return this.modified.toggle(),this.timesince.toggle(),a.stopPropagation()},a.prototype.showControls=function(a){return this._controlsTimer=setTimeout(__bind(function(){return this.controls.slideDown(200)},this),300),!1},a.prototype.hideControls=function(a){return clearTimeout(this._controlsTimer),this.controls.slideUp(300),!1},a.prototype.copy=function(a){var b;return b=this.model.clone(),b.set("id",null),b.set("name",b.get("name")+" (copy)"),b.set("_id",this.model.id),b.collection=this.model.collection,this.edit(a,b),!1},a.prototype["delete"]=function(){return this.model.destroy()},a}(),f=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,b.View),a.prototype.el="#report-list",a.prototype.viewClass=e,a.prototype.defaultContent='<section class="info">You have no saved reports.</section>',a}(),g=function(){function a(){this.render=__bind(this.render,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.el="#report-name",a.prototype.events={click:"edit",mouseover:"hover",mouseout:"hover"},a.prototype.initialize=function(a){return this.model.bind("change:name",this.render),this.hoverText=$('<span class="info">click to edit</span>')},a.prototype.render=function(){var a;return this.el.text(""),(a=this.model.get("name"))?(this.el.removeClass("placeholder"),this.el.append(this.hoverText.hide())):(this.el.addClass("placeholder"),a=this.model.defaults.name,this.hoverText.detach()),this.el.prepend(a+" ")},a.prototype.hover=function(){return this.hoverText.toggle()},a}(),a.include(e,d),a.include(f,b.ExpandableListMixin),a.include(g,d),{Name:g,Item:e,List:f,Editor:c}}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new B(a)};typeof module!="undefined"&&module.exports?(module.exports=w,w._=w):a._=w,w.VERSION="1.1.7";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(j.call(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);var e=(w.isArray(a)?a.slice():w.toArray(a)).reverse();return w.reduce(e,b,c,d)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b=b||w.identity;var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e|=b.call(d,a,f,g))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(y(a,function(a){if(c=a===b)return!0}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={};return x(a,function(a,d){var e=b(a,d);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.last=function(a){return a[a.length-1]},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a){return w.reduce(a,function(a,b){return w.isArray(b)?a.concat(w.flatten(b)):(a[a.length]=b,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b){return w.reduce(a,function(a,c,d){if(0==d||(b===!0?w.last(a)!=c:!w.include(a,c)))a[a.length]=c;return a},[])},w.union=function(){return w.uniq(w.flatten(arguments))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a,b){return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f},w.bind=function(a,b){if(a.bind===v&&v)return v.apply(a,g.call(arguments,1));var c=g.call(arguments,2);return function(){return a.apply(b,c.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return j.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))};var z=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};w.throttle=function(a,b){return z(a,b,!1)},w.debounce=function(a,b){return z(a,b,!0)},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments));return b.apply(this,c)}},w.compose=function(){var a=g.call(arguments);return function(){var b=g.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)j.call(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isArray(a)?a.slice():w.extend({},a)},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual)return a.isEqual(b);if(b.isEqual)return b.isEqual(a);if(w.isDate(a)&&w.isDate(b))return a.getTime()===b.getTime();if(w.isNaN(a)&&w.isNaN(b))return!1;if(w.isRegExp(a)&&w.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(a.length&&a.length!==b.length)return!1;var e=w.keys(a),f=w.keys(b);if(e.length!=f.length)return!1;for(var g in a)if(!(g in b)||!w.isEqual(a[g],b[g]))return!1;return!0},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(j.call(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)==="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return!!a&&!!j.call(a,"callee")},w.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},w.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},w.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1},w.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},w.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.mixin=function(a){x(w.functions(a),function(b){D(b,w[b]=a[b])})};var A=0;w.uniqueId=function(a){var b=A++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var B=function(a){this._wrapped=a};w.prototype=B.prototype;var C=function(a,b){return b?w(a).chain():a},D=function(a,b){B.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),C(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];B.prototype[a]=function(){return b.apply(this._wrapped,arguments),C(this._wrapped,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];B.prototype[a]=function(){return C(b.apply(this._wrapped,arguments),this._chain)}}),B.prototype.chain=function(){return this._chain=!0,this},B.prototype.value=function(){return this._wrapped}}(),define("cilantro/vendor/underscore",function(){}),define("cilantro/vendor/backbone",["cilantro/vendor/underscore"],function(){var a=this,b=a.Backbone,c;typeof exports!="undefined"?c=exports:c=a.Backbone={},c.VERSION="0.5.3";var d=a._;!d&&typeof require!="undefined"&&(d=require("underscore")._);var e=a.jQuery||a.Zepto||a.ender;c.noConflict=function(){return a.Backbone=b,this},c.emulateHTTP=!1,c.emulateJSON=!1,c.Events={bind:function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]=[]);return e.push([b,c]),this},unbind:function(a,b){var c;if(!a)this._callbacks={};else if(c=this._callbacks)if(!b)c[a]=[];else{var d=c[a];if(!d)return this;for(var e=0,f=d.length;e<f;e++)if(d[e]&&b===d[e][0]){d[e]=null;break}}return this},trigger:function(a){var b,c,d,e,f,g=2;if(!(c=this._callbacks))return this;while(g--){d=g?a:"all";if(b=c[d])for(var h=0,i=b.length;h<i;h++)(e=b[h])?(f=g?Array.prototype.slice.call(arguments,1):arguments,e[0].apply(e[1]||this,f)):(b.splice(h,1),h--,i--)}return this}},c.Model=function(a,b){var c;a||(a={});if(c=this.defaults)d.isFunction(c)&&(c=c.call(this)),a=d.extend({},c,a);this.attributes={},this._escapedAttributes={},this.cid=d.uniqueId("c"),this.set(a,{silent:!0}),this._changed=!1,this._previousAttributes=d.clone(this.attributes),b&&b.collection&&(this.collection=b.collection),this.initialize(a,b)},d.extend(c.Model.prototype,c.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return d.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=w(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var e=this._resolveArgs(arguments);a=e[0],c=e[1];if(!a)return this;a.attributes&&(a=a.attributes);var f=this.attributes,g=this._escapedAttributes;if(!c.silent&&this.validate&&!this._performValidation(a,c))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);var h=this._changing;this._changing=!0;for(var i in a){var j=a[i];d.isEqual(f[i],j)||(f[i]=j,delete g[i],this._changed=!0,c.silent||this.trigger("change:"+i,this,j,c))}return!h&&!c.silent&&this._changed&&this.change(c),this._changing=!1,this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:(delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b,c=this.attributes,d={};for(b in c)d[b]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(b in c)this.trigger("change:"+b,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c,e,f){if(!b.set(b.parse(c,f),a))return!1;d&&d(b,c)},a.error=v(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a)},save:function(a,b,d){var e=this._resolveArgs(arguments);a=e[0],d=e[1];if(!a&&!this.set(a,d))return!1;var f=this,g=d.success;d.success=function(a,b,c){if(!f.set(f.parse(a,c),d))return!1;g&&g(f,a,c)},d.error=v(d.error,f,d);var h=this.isNew()?"create":"update";return(this.sync||c.sync).call(this,h,this,d)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var b=this,d=a.success;return a.success=function(c){b.trigger("destroy",b,b.collection,a),d&&d(b,c)},a.error=v(a.error,b,a),(this.sync||c.sync).call(this,"delete",this,a)},url:function(){var a=t(this.collection)||this.urlRoot||u();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(a){this.trigger("change",this,a),this._previousAttributes=d.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var b=this._previousAttributes,c=!1;for(var e in a)d.isEqual(b[e],a[e])||(c=c||{},c[e]=a[e]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return d.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0},_resolveArgs:function(a){var b=a[0];if(d.isString(b)||d.isNumber(b))a[0]={},a[0][b]=a[1],a[1]=a[2];return a[1]||(a[1]={}),a}}),c.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),d.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),a&&this.reset(a,{silent:!0}),this.initialize.apply(this,arguments)},d.extend(c.Collection.prototype,c.Events,{model:c.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._add(a[c],b);else this._add(a,b);return this},remove:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._remove(a[c],b);else this._remove(a,b);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return d.map(this.models,function(b){return b.get(a)})},reset:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("reset",this,b),this},update:function(a,b){a||(a=[]),b||(b={});var e=this.reduce(function(a,b){return a[b.id]=!1,a},{});return d.each(a,function(a){var b=this.model.prototype.idAttribute,f=a[b];if(f==undefined)throw new Error("Can't update a model with no id attribute. Please use 'reset'.");if(this._byId[f]){var g=a instanceof c.Model?d.clone(a.attributes):d.clone(a);delete g[b],this._byId[f].set(g),e[f]=!0}else this.add(a)},this),b.removeMissing&&d.select(e,function(a,b){a||this.remove(b)},this),this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c,e,f){b[a.update?"update":a.add?"add":"reset"](b.parse(c,f),a),d&&d(b,c)},a.error=v(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;return b.success=function(a,e,f){c.add(a,b),d&&d(a,e,f)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return d(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof c.Model)a.collection||(a.collection=this);else{var d=a;a=new this.model(d,{collection:this}),a.validate&&!a._performValidation(d,b)&&(a=!1)}return a},_add:function(a,b){b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);if(c)throw new Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a,this._byCid[a.cid]=a;var d=b.at!=null?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(d,0,a),a.bind("all",this._onModelEvent),this.length++,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){return b||(b={}),a=this.getByCid(a)||this.get(a),a?(delete this._byId[a.id],delete this._byCid[a.cid],this.models.splice(this.indexOf(a),1),this.length--,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a):null},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var f=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];d.each(f,function(a){c.Collection.prototype[a]=function(){return d[a].apply(d,[this.models].concat(d.toArray(arguments)))}}),c.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var g=/:([\w\d]+)/g,h=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g;d.extend(c.Router.prototype,c.Events,{initialize:function(){},route:function(a,b,e){c.history||(c.history=new c.History),d.isRegExp(a)||(a=this._routeToRegExp(a)),c.history.route(a,d.bind(function(c){var d=this._extractParameters(a,c);e.apply(this,d),this.trigger.apply(this,["route:"+b].concat(d))},this))},navigate:function(a,b){c.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(g,"([^/]*)").replace(h,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),c.History=function(){this.handlers=[],d.bindAll(this,"checkUrl")};var j=/^#*/,k=/msie [\w.]+/,l=!1;d.extend(c.History.prototype,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a.replace(j,"")),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a},start:function(a){if(l)throw new Error("Backbone.history has already been started");this.options=d.extend({},{root:"/"},this.options,a),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,f=k.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);f&&(this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?e(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!f?e(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=b,l=!0;var g=window.location,h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=g.hash.replace(j,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=d.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){var c=(a||"").replace(j,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;if(this._hasPushState){var d=window.location;c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history.pushState({},document.title,d.protocol+"//"+d.host+c)}else window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(this.iframe.document.open().close(),this.iframe.location.hash=c);b&&this.loadUrl(a)}}),c.View=function(a){this.cid=d.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.setLocalElements(),this.delegateEvents(),this.initialize.apply(this,arguments)};var m=function(a){return e(a,this.el)},n=/^(\S+)\s*(.*)$/,o=["model","collection","el","id","attributes","className","tagName"];d.extend(c.View.prototype,c.Events,{tagName:"div",$:m,initialize:function(){},render:function(){return this},remove:function(){return e(this.el).remove(),this},make:function(a,b,c){var d=e(document.createElement(a));return b&&d.attr(b),c&&d.html(c),d},delegateEvents:function(a){if(!a&&!(a=this.events))return;d.isFunction(a)&&(a=a.call(this)),this.undelegateEvents();for(var b in a){var c=this[a[b]];if(!c)throw new Error('Event "'+a[b]+'" does not exist');var f=b.match(n),g=f[1],h=f[2];c=d.bind(c,this),g+=".delegateEvents"+this.cid,h===""?e(this.el).bind(g,c):e(this.el).delegate(h,g,c)}},undelegateEvents:function(){e(this.el).unbind(".delegateEvents"+this.cid)},setLocalElements:function(a){if(!a&&!(a=this.elements))return;for(var b in a)this[a[b]]=this.$(b)},_configure:function(a){this.options&&(a=d.extend({},this.options,a));for(var b=0,c=o.length;b<c;b++){var e=o[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(!this.el){var a=this.attributes||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.el=this.make(this.tagName,a)}else if(d.isString(this.el)||d.isElement(this.el)){var b=e(this.el);b.length?this.el=b:this.el=null}}});var p=function(a,b){var c=s(this,a,b);return c.extend=this.extend,c};c.Model.extend=c.Collection.extend=c.Router.extend=c.View.extend=p;var q={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};c.sync=function(a,b,f){var g=q[a],h=d.extend({type:g,dataType:"json"},f);return h.url||(h.url=t(b)||u()),!h.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),c.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),c.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(c.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),h.type!=="GET"&&!c.emulateJSON&&(h.processData=!1),e.ajax(h)};var r=function(){},s=function(a,b,c){var e;return b&&b.hasOwnProperty("constructor")?e=b.constructor:e=function(){return a.apply(this,arguments)},d.extend(e,a),r.prototype=a.prototype,e.prototype=new r,b&&d.extend(e.prototype,b),c&&d.extend(e,c),e.prototype.constructor=e,e.__super__=a.prototype,e},t=function(a){return!a||!a.url?null:d.isFunction(a.url)?a.url():a.url},u=function(){throw new Error('A "url" property or function must be specified')},v=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}},w=function(a){return a.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}});var __hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__bind=function(a,b){return function(){return a.apply(b,arguments)}};define("cilantro/utils/logging",["cilantro/vendor/backbone"],function(){var a,b,c,d,e;return a={debug:0,info:1,warning:2,error:3,critical:4},d=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.Model),a.prototype.defaults={level:"info",timeout:3e3},a}(),b=function(){function a(){this.log=__bind(this.log,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.Collection),a.prototype.model=d,a.prototype.initialize=function(){return App.hub.subscribe("log",this.log)},a.prototype.log=function(a){if(a instanceof Backbone.Model)return this.add(a),console.log(a)},a}(),e=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.template=_.template('<div class="message <%= level %>"><%= message %></div>'),a.prototype.render=function(){return this.el=$(this.template(this.model.get("message"))),this},a.prototype.show=function(){return this.el.fadeIn(500)},a.prototype.hide=function(){return this.el.fadeOut(300)},a}(),c=function(){function a(){this.dismiss=__bind(this.dismiss,this),this.log=__bind(this.log,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.el="#messages",a.prototype.initialize=function(){return App.hub.subscribe("log",this.log),App.hub.subscribe("dismiss",this.dismiss),this.modelViews={}},a.prototype.log=function(a){var b;a instanceof Backbone.View||(b=a,a=new e({model:b}),this.modelViews[b]=a),this.el.append(a.el.hide()),a.show();if(a.timeout)return this._messageTimer=_.delay(function(){return a.hide()},a.timeout)},a.prototype.dismiss=function(a){var b;a instanceof Backbone.View||(b=a,a=this.modelViews[b],delete this.modelViews[b]);if(a)return clearTimeout(this._messageTimer),a.hide()},a}(),{Message:d,MessageView:e,Log:b,LogView:c}});var __hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__bind=function(a,b){return function(){return a.apply(b,arguments)}};define("cilantro/types/report/messages",["cilantro/utils/logging"],function(a){var b,c;return c={UnsavedReportTemplate:'<div class="message-block warning">                    <div class="content">                        <strong role="name"><%= name %></strong> has unsaved changes                    </div>                    <button class="revert">Revert</button>                    <button class="save">Save</button>                </div>'},b=function(){function b(){b.__super__.constructor.apply(this,arguments)}return __extends(b,a.MessageView),b.prototype.template=_.template(c.UnsavedReportTemplate),b.prototype.elements={"[role=name]":"name"},b.prototype.events={"click .save":"save","click .revert":"revert"},b.prototype.initialize=function(){return this.render(),this.model.bind("change:name",__bind(function(a,b){return this.el.find("[role=name]").text(b)},this)),this.model.bind("change:has_changed",__bind(function(a,b){return b?App.hub.publish("log",this):App.hub.publish("dismiss",this)},this))},b.prototype.render=function(){return this.el=$(this.template(this.model.toJSON())),this.setLocalElements(),this.delegateEvents(),this},b.prototype.save=function(){return this.model.push()},b.prototype.revert=function(){return this.model.revert()},b}(),{UnsavedReport:b,templates:c}}),define("cilantro/types/report/main",["cilantro/types/report/models","cilantro/types/report/views","cilantro/types/report/messages"],function(a,b,c){return{Models:a,Views:b,Messages:c}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("cilantro/types/scope/models",["common/models/polling"],function(a){var b;return b=function(){function b(){this.revert=__bind(this.revert,this),b.__super__.constructor.apply(this,arguments)}return __extends(b,a.Model),b.prototype.url=App.endpoints.session.scope,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),App.hub.subscribe("report/revert",this.revert)},b.prototype.revert=function(){return this.fetch()},b}(),{Session:b}}),define("cilantro/types/scope/main",["cilantro/types/scope/models"],function(a){return{Models:a}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("cilantro/types/perspective/models",["common/models/polling"],function(a){var b;return b=function(){function b(){this.revert=__bind(this.revert,this),b.__super__.constructor.apply(this,arguments)}return __extends(b,a.Model),b.prototype.url=App.endpoints.session.perspective,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),App.hub.subscribe("report/revert",this.revert)},b.prototype.revert=function(){return this.fetch()},b}(),{Session:b}}),define("cilantro/types/perspective/main",["cilantro/types/perspective/models"],function(a){return{Models:a}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("cilantro/pages/workspace/session",["common/views/collection","cilantro/types/report/main"],function(a,b){var c,d,e;return e=function(){function b(){this.render=__bind(this.render,this),b.__super__.constructor.apply(this,arguments)}return __extends(b,a.ExpandableList),b.prototype.el="#session-scope",b.prototype.defaultContent='<li class="info">No conditions have been defined</li>',b.prototype.initialize=function(){return this.model.bind("change:conditions",this.render),this.defaultContent=this.$(this.defaultContent),this.el.append(this.defaultContent)},b.prototype.render=function(){var a,b;return a=this.model.get("conditions"),this.defaultContent.detach(),this.el.empty(),a?(b="",_.map(a,function(a){return b+="<li>"+a.condition+"</li>"}),this.el.html(b)):this.el.append(this.defaultContent),this.collapse()},b}(),c=function(){function b(){this.render=__bind(this.render,this),b.__super__.constructor.apply(this,arguments)}return __extends(b,a.ExpandableList),b.prototype.el="#session-perspective",b.prototype.defaultContent='<li class="info">No data columns have been choosen</li>',b.prototype.initialize=function(){return this.model.bind("change:header",this.render),this.defaultContent=this.$(this.defaultContent),this.el.append(this.defaultContent)},b.prototype.template=_.template('<li><%= name %><% if (direction) { %>                <span class="info">(<%= direction %>)</span><% } %></li>'),b.prototype.render=function(){var a,b,c,d;this.defaultContent.detach(),this.el.empty();if(b=this.model.get("header"))for(c=0,d=b.length;c<d;c++)a=b[c],this.el.append(this.template(a));else this.el.append(this.defaultContent);return this.collapse()},b}(),d=function(){function a(){this.render=__bind(this.render,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,b.Views.Item),a.prototype.el='<div>                    <strong><a role="name"></a></strong>                    <span class="info">- <span role="unique-count"></span> unique patients</span>                    <span class="info time" style="float: right">modified <span role="modified"></span><span role="timesince"></span></span>                    <div role="description"></div>                </div>',a.prototype.parent="#session-report",a.prototype.initialize=function(){return this.el.prependTo(this.parent),this.model.bind("change",this.render)},a.prototype.render=function(){var b;a.__super__.render.apply(this,arguments),b=this.model.get("name");if(this.model.hasChanged("name")&&b)return this.name.text(b).attr("href",this.model.get("permalink")).parent().show();if(!b)return this.name.text("(session report)")},a}(),{Report:d,Scope:e,Perspective:c}}),define("cilantro/pages/workspace/main",["cilantro/types/report/main","cilantro/types/scope/main","cilantro/types/perspective/main","cilantro/pages/workspace/session"],function(a,b,c,d){var e,f,g,h;return e=new a.Models.Collection,g=new a.Models.Session,h=new b.Models.Session,f=new c.Models.Session,App.hub.subscribe("session/idle",function(){return e.stopPolling(),g.stopPolling(),h.stopPolling(),f.stopPolling()}),App.hub.subscribe("session/resume",function(){return e.startPolling(),g.startPolling(),h.startPolling(),f.startPolling()}),$(function(){var b,c,i,j,k,l;return $("#new-report").click(function(){return App.hub.publish("report/clear")}),b=new a.Views.Editor,c=new a.Views.List({collection:e}),k=new d.Scope({model:h}),i=new d.Perspective({model:f}),j=new d.Report({model:g}),l=new a.Messages.UnsavedReport({model:g}),e.fetch(),g.fetch(),h.fetch(),f.fetch()})})