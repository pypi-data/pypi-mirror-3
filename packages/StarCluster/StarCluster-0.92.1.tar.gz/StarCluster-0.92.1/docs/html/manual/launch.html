
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Launching a StarCluster on Amazon EC2 &mdash; StarCluster v0.92.1 documentation</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.92.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="StarCluster v0.92.1 documentation" href="../index.html" />
    <link rel="up" title="StarCluster User Manual" href="index.html" />
    <link rel="next" title="Running Remote Commands on a Cluster from Command Line" href="runcommands.html" />
    <link rel="prev" title="Using EBS Volumes for Persistent Storage" href="volumes.html" />
<link rel="stylesheet" href="../_static/nobile.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../_static/neuton.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/starcluster.ico"/>

  </head>
  <body>
<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/logo-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="runcommands.html" title="Running Remote Commands on a Cluster from Command Line"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="volumes.html" title="Using EBS Volumes for Persistent Storage"
             accesskey="P">previous</a> |</li>
    	<li><a href="../index.html">Home</a> &raquo;</li>
          <li><a href="../contents.html" >Master Table of Contents</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">StarCluster User Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="launching-a-starcluster-on-amazon-ec2">
<h1>Launching a StarCluster on Amazon EC2<a class="headerlink" href="#launching-a-starcluster-on-amazon-ec2" title="Permalink to this headline">¶</a></h1>
<p>Use the <strong>start</strong> command in StarCluster to launch a new cluster on Amazon EC2.
The start command takes two arguments: the cluster template and a tagname for
cluster identification.</p>
<p>Below is an example of starting a StarCluster from the <em>default</em> cluster
template defined in the config and tagged as <em>physicscluster</em>. This example
will be used throughout this section.</p>
<div class="highlight-none"><div class="highlight"><pre>$ starcluster start physicscluster # this line starts the cluster
StarCluster - (http://web.mit.edu/starcluster)
Software Tools for Academics and Researchers (STAR)
Please submit bug reports to starcluster@mit.edu

&gt;&gt;&gt; Validating cluster template settings...
&gt;&gt;&gt; Cluster template settings are valid
&gt;&gt;&gt; Starting cluster...
&gt;&gt;&gt; Launching a 2-node cluster...
&gt;&gt;&gt; Launching master node (ami: ami-8cf913e5, type: m1.small)...
&gt;&gt;&gt; Creating security group @sc-physicscluster...
&gt;&gt;&gt; Waiting for cluster to come up... (updating every 30s)
&gt;&gt;&gt; Waiting for all nodes to be in a &#39;running&#39; state...
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Waiting for SSH to come up on all nodes...
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; The master node is ec2-123-12-12-123.compute-1.amazonaws.com
&gt;&gt;&gt; Setting up the cluster...
&gt;&gt;&gt; Attaching volume vol-99999999 to master node on /dev/sdz ...
&gt;&gt;&gt; Configuring hostnames...
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Mounting EBS volume vol-99999999 on /home...
&gt;&gt;&gt; Creating cluster user: myuser (uid: 1001, gid: 1001)
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Configuring scratch space for user: myuser
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Configuring /etc/hosts on each node
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Configuring NFS...
&gt;&gt;&gt; Setting up NFS took 0.209 mins
&gt;&gt;&gt; Configuring passwordless ssh for root
&gt;&gt;&gt; Configuring passwordless ssh for myuser
&gt;&gt;&gt; Installing Sun Grid Engine...
&gt;&gt;&gt; Creating SGE parallel environment &#39;orte&#39;
1/1 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Adding parallel environment &#39;orte&#39; to queue &#39;all.q&#39;
&gt;&gt;&gt; Shutting down threads...
20/20 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%
&gt;&gt;&gt; Starting cluster took 6.922 mins

The cluster is now ready to use. To login to the master node
as root, run:

    $ starcluster sshmaster physicscluster

When you are finished using the cluster and wish to
terminate it and stop paying for service:

    $ starcluster terminate physicscluster

NOTE: Terminating an EBS cluster will destroy all EBS
volumes backing the nodes.

Alternatively, if the cluster uses EBS instances, you can
use the &#39;stop&#39; command to put all nodes into a &#39;stopped&#39;
state:

    $ starcluster stop physicscluster

NOTE: Any data stored in ephemeral storage (usually /mnt)
will be lost!

This will shutdown all nodes in the cluster and put them in
a &#39;stopped&#39; state that preserves the EBS volumes backing the
nodes. A &#39;stopped&#39; cluster may then be restarted at a later
time, without losing data on the local disks, by passing the
-x option to the &#39;start&#39; command:

    $ starcluster start -x physicscluster

This will start all &#39;stopped&#39; EBS instances and reconfigure
the cluster.
</pre></div>
</div>
<p>The output of the <strong>start</strong> command should look similar to the above if
everything went successfully.</p>
<p>If you wish to use a different template besides the default, <em>largecluster</em> for
example, the command becomes:</p>
<div class="highlight-python"><pre>$ starcluster start -c largecluster physicscluster</pre>
</div>
<p>This command will do the same thing as above only using the <em>largecluster</em>
cluster template.</p>
<div class="section" id="managing-multiple-clusters">
<h2>Managing Multiple Clusters<a class="headerlink" href="#managing-multiple-clusters" title="Permalink to this headline">¶</a></h2>
<p>To list all of your StarClusters on Amazon EC2 run the following command:</p>
<div class="highlight-python"><pre>$ starcluster listclusters</pre>
</div>
<p>The output should look something like:</p>
<div class="highlight-python"><pre>$ starcluster listclusters
StarCluster - (http://web.mit.edu/starcluster)
Software Tools for Academics and Researchers (STAR)
Please submit bug reports to starcluster@mit.edu

---------------------------------------------------
physicscluster (security group: @sc-physicscluster)
---------------------------------------------------
Launch time: 2010-02-19T20:55:20.000Z
Uptime: 00:29:42
Zone: us-east-1c
Keypair: gsg-keypair
EBS volumes:
    vol-c8888888 on master:/dev/sdj (status: attached)
Cluster nodes:
     master running i-99999999 ec2-123-123-123-121.compute-1.amazonaws.com
    node001 running i-88888888 ec2-123-123-123-122.compute-1.amazonaws.com
Total nodes: 2</pre>
</div>
<p>This will list each StarCluster you&#8217;ve started by tag name.</p>
</div>
<div class="section" id="logging-into-the-master-node">
<h2>Logging into the master node<a class="headerlink" href="#logging-into-the-master-node" title="Permalink to this headline">¶</a></h2>
<p>To login to the master node as root:</p>
<div class="highlight-python"><pre>$ starcluster sshmaster physicscluster</pre>
</div>
<p>You can also login as a different user using the <tt class="docutils literal"><span class="pre">--user</span></tt> (<tt class="docutils literal"><span class="pre">-u</span></tt>) option.
For example, to login as the <tt class="docutils literal"><span class="pre">sgeadmin</span></tt> user:</p>
<div class="highlight-python"><pre>$ starcluster sshmaster -u sgeadmin physicscluster</pre>
</div>
</div>
<div class="section" id="logging-into-the-worker-nodes">
<h2>Logging into the worker nodes<a class="headerlink" href="#logging-into-the-worker-nodes" title="Permalink to this headline">¶</a></h2>
<p>To login to a worker node, say <tt class="docutils literal"><span class="pre">node001</span></tt> for example, as root:</p>
<div class="highlight-python"><pre>$ starcluster sshnode physicscluster node001</pre>
</div>
<p>You can also login as a different user using the <tt class="docutils literal"><span class="pre">--user</span></tt> (<tt class="docutils literal"><span class="pre">-u</span></tt>) option.
For example, to login as the <tt class="docutils literal"><span class="pre">sgeadmin</span></tt> user:</p>
<div class="highlight-python"><pre>$ starcluster sshnode -u sgeadmin physicscluster node001</pre>
</div>
</div>
<div class="section" id="rebooting-a-cluster">
<h2>Rebooting a Cluster<a class="headerlink" href="#rebooting-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>Some times you might encounter an error while starting and setting up a new
cluster or using an existing cluster. Rather than terminating the cluster and
starting a new one to get around the errors, you can instead completely
reconfigure the cluster without terminating instances and wasting
instance-hours using the <em>restart</em> command:</p>
<div class="highlight-python"><pre>$ starcluster restart physicscluster</pre>
</div>
<p>This will reboot all of the instances, wait for them to come back up, and then
completely reconfigure the cluster from scratch as if you had terminated and
re-created the cluster.</p>
</div>
<div class="section" id="terminating-a-cluster">
<h2>Terminating a Cluster<a class="headerlink" href="#terminating-a-cluster" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Once a cluster has been terminated, any data that was not saved either to
S3 or an external EBS volume will be lost. Make sure you save any data you
care to keep to S3 or to an external EBS volume.</p>
</div>
<p>Once you&#8217;ve finished using the cluster and wish to stop paying for it, simply
run the <strong>terminate</strong> command providing the cluster tag name you gave when
starting:</p>
<div class="highlight-python"><pre>$ starcluster terminate physicscluster</pre>
</div>
<p>This command will prompt for confirmation before destroying the cluster:</p>
<div class="highlight-python"><pre>$ starcluster terminate physicscluster
StarCluster - (http://web.mit.edu/starcluster)
Software Tools for Academics and Researchers (STAR)
Please submit bug reports to starcluster@mit.edu

Terminate cluster physicscluster (y/n)? y
&gt;&gt;&gt; Shutting down i-99999999
&gt;&gt;&gt; Shutting down i-88888888
&gt;&gt;&gt; Waiting for cluster to terminate...
&gt;&gt;&gt; Removing cluster security group @sc-physicscluster</pre>
</div>
<p>This will terminate all instances in the cluster tagged &#8220;physicscluster&#8221; and
removes the &#64;sc-physicscluster security group.</p>
</div>
<div class="section" id="stopping-an-ebs-backed-cluster">
<h2>Stopping an EBS-backed Cluster<a class="headerlink" href="#stopping-an-ebs-backed-cluster" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can not <tt class="docutils literal"><span class="pre">stop</span></tt> S3-backed clusters - they can only be terminated.</p>
</div>
<p>If you used EBS-backed AMIs when creating a cluster, the cluster can optionally
be <tt class="docutils literal"><span class="pre">stopped</span></tt> instead of terminated:</p>
<div class="highlight-python"><pre>$ starcluster stop myebscluster</pre>
</div>
<p>This will shutdown the entire cluster by putting all instances in a <tt class="docutils literal"><span class="pre">stopped</span></tt>
state rather than terminating them. This allows you to preserve the local root
volumes backing the nodes which would normally be destroyed if you used the
<strong>terminate</strong> command. The cluster will continue to show up in the output of
the <strong>listclusters</strong> command after being stopped, however, you will not be
charged for <tt class="docutils literal"><span class="pre">stopped</span></tt> instance hours, only for the EBS volume storage backing
the nodes:</p>
<div class="highlight-python"><pre>$ starcluster listclusters
StarCluster - (http://web.mit.edu/starcluster)
Software Tools for Academics and Researchers (STAR)
Please submit bug reports to starcluster@mit.edu

-------------------------------------------------
myebscluster (security group: @sc-physicscluster)
-------------------------------------------------
Launch time: 2011-10-22T20:55:20.000Z
Uptime: 00:29:42
Zone: us-east-1c
Keypair: gsg-keypair
Cluster nodes:
     master stopped i-99999999
    node001 stopped i-88888888
Total nodes: 2</pre>
</div>
<p>A stopped EBS-backed cluster can be <tt class="docutils literal"><span class="pre">started</span></tt> later on using:</p>
<div class="highlight-python"><pre>$ starcluster start -x myebscluster</pre>
</div>
<p>This will <tt class="docutils literal"><span class="pre">start</span></tt> all <tt class="docutils literal"><span class="pre">stopped</span></tt> nodes in the cluster and reconfigure the
cluster. Once the cluster comes up all data previously stored on the root
volumes backing the nodes before shutdown will be available.</p>
<p>To <em>completely</em> destroy an EBS-backed cluster use the <strong>terminate</strong> command:</p>
<div class="highlight-python"><pre>$ starcluster terminate myebscluster</pre>
</div>
<p>This will completely destroy the cluster nodes including the root volumes
backing the nodes. As always, before terminating the cluster you should move
any data you wish to keep either to an external EBS volume or to S3.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Launching a StarCluster on Amazon EC2</a><ul>
<li><a class="reference internal" href="#managing-multiple-clusters">Managing Multiple Clusters</a></li>
<li><a class="reference internal" href="#logging-into-the-master-node">Logging into the master node</a></li>
<li><a class="reference internal" href="#logging-into-the-worker-nodes">Logging into the worker nodes</a></li>
<li><a class="reference internal" href="#rebooting-a-cluster">Rebooting a Cluster</a></li>
<li><a class="reference internal" href="#terminating-a-cluster">Terminating a Cluster</a></li>
<li><a class="reference internal" href="#stopping-an-ebs-backed-cluster">Stopping an EBS-backed Cluster</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="volumes.html"
                        title="previous chapter">Using EBS Volumes for Persistent Storage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="runcommands.html"
                        title="next chapter">Running Remote Commands on a Cluster from Command Line</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="runcommands.html" title="Running Remote Commands on a Cluster from Command Line"
             >next</a> |</li>
        <li class="right" >
          <a href="volumes.html" title="Using EBS Volumes for Persistent Storage"
             >previous</a> |</li>
    	<li><a href="../index.html">Home</a> &raquo;</li>
          <li><a href="../contents.html" >Master Table of Contents</a> &raquo;</li>
          <li><a href="index.html" >StarCluster User Manual</a> &raquo;</li> 
      </ul>
    </div>


    <div class="footer">
        &copy; Copyright 2011, Software Tools for Academics and Researchers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>


<script type="text/javascript">
//<![CDATA[
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    //]]>
    </script><script type="text/javascript">
//<![CDATA[
    try{
        var pageTracker = _gat._getTracker("UA-1048253-12");
        pageTracker._trackPageview();
    } catch(err) {}
    //]]>
    </script>

  </body>
</html>