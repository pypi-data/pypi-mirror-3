<table width="100%" cellpadding=5><tr>
<td bgcolor=#5555ff width=45><a href=about.html><img src=../_img/wb.png></a></td>
<td bgcolor=#ccccff><h3> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Configuring WB</h3></td></tr></table>

<p>
<center>
Luca Fini (<i>lfini@arcetri.astro.it</i>). Settembre 2006
</center>
<p>
<table width="100%" border=1><tr>
<th width="16%"><a href=about.html>Introduzione</a></th>
<th width="16%"><a href=install.html>Istallazione</a></th>
<th width="16%">Configurazione</th>
<th width="16%"><a href=help.html>Uso</a></th>
<th width="16%"><a href=copyright.html>Copyright</a></th>
<th width="16%"><a href=wbfaq.html>F.A.Q.</a></th></tr>
</table>



<h3> Come definire una nuova bacheca</h3>

Nel testo seguente sar&agrave; fatto rifgerimento spesso al termine
<i>radice delle bacheche</i>. Si tratta della directory creta in fase di
<a href=install.html>istallazione</a> dove sono stati memorizzati i files ausiliari di
<b>WB</b>. Supponiamo ad esempio, che sia stata chiamata:
<tt>/var/www/http/BillBoards</tt>. 
<p>
Per definire una nuova bacheca deve essere semplicemente creata una directory
nalla <i>radice</i>. Il nome della directory coincide con il nome
della bacheca. Supponendo di voler creare una bacheca di nome <tt>Ultimissime</tt>
si user&agrave; il comando:
<blockquote>
<tt>&gt; mkdir /var/www/http/BillBoards/Ultimissime</tt>
</blockquote>

<center> <table width=80% border=1 cellpadding=4> <tr><td bgcolor=#dddddd> <font size=-1>
<b>Nota:</b> 
&Egrave; possibile usare qualunque nome per le directory, ecctto i nomi
che iniziano per '.' e per '_', che sono riservati a scopi speciali.
</font> </td></tr></table> </center>
<p>
Occorre poi assicurarsi che il web server abbia i diritti di accesso necessari
per leggere, scrivere e creare files nella sottodirectory <tt>Ultimissime</tt>.
&Egrave; quindi necessario assegnare la propriet&agrave; della directory
all'opportuno ID, analogamente a quanto fatto per la <i>radice</i> in fase di
<a href=install.html>istallazione</a>.

Ad esempio, supponendo che l'ID del server apache sia "cochise":

<blockquote>
<tt>&gt; chown cochise /var/www/http/BillBoards/Ultimissime</tt>
</blockquote>

La bacheca &egrave; pronta a funzionare, ma &egrave; possibile personalizzarla
per adattarla all'uso richiesto.


<h3> Personalizzazione della bacheca</h3>
La personalizzazione si effettua copiando nella directory della bacheca
il file di inizializzazione <tt>wb.ini</tt> disponibile
nella <i>radice</i> e modificandolo opportunamente.

Il file di inzializzazione contiene la ridefinizione di numerosi comandi
usati dal programma <b>WB</b>.

Il file <tt>wb.ini</tt> fornito come esempio contiene spiegazioni dettagliate
per ogni comando configurabile, ma alcuni di questi richiedono ulteriori spiegazioni.

<blockquote>
<b><tt>index_header</tt></b>,&nbsp;
<b><tt>index_item</tt></b>,&nbsp;
<b><tt>index_footer</tt></b>,&nbsp;
<b><tt>doc_header</tt></b>,&nbsp;
<b><tt>doc_footer</tt></b>
</blockquote>

Questi comandi contengono la definizione del formato delle linee di indice
e dei documenti generati da <b>WB</b>. Ogni comando &egrave; costituito da una sequenza
di linee ed ogni linea genera una linea di codice HTML.

<p>L'indice dei documenti &egrave; una pagina HTML generata con la seguente procedura:

<blockquote>
<ol>
<li> Intestazione generata con a partire dal contenuto del comando <tt>index_header</tt>.
<li> Per ogni docuemnto registrato un blocco generato a partire dal contenuto dell comando
     <tt>index_item</tt>
<li> La pagina termina con il testo generato dal comando <tt>index_footer</tt>.
</ol>
</blockquote>

La pagina per visualizzare il contenuto di ciascun documento
viene invece generata come segue:

<blockquote>
<ol>
<li> Testo generato a partire dal contenuto del comando <tt>doc_header</tt>.
<li> Testo del documento
<li> Lista di allegati (se ci sono allegati)
<li> Testo generato a partire dal contenuto del comando <tt>doc_footer</tt>.
</ol>
</blockquote>

Per la generazione del testo ciascun comando viene processato in
modo da sostituire il valore corrente di alcune "variabili".
<p>
Ad esempio i valori di default dei cinque comandi elencati sopra sono:<pre>
index_header = ['&lt;h3&gt;Index for billboard: &lt;i&gt;%(BBOARD)s&lt;/i&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;ul&gt;']
index_item   = ['&lt;p&gt;&lt;li&gt; %(DATE)s %(EXPIR)s',
                '&lt;br&gt;&lt;a href=%(HREF)s&gt;%(TITLE)s&lt;/a&gt;']
index_footer = ['&lt;/ul&gt;&lt;/blockquote&gt;']
doc_header   = ['%(DATE)s %(EXPIR)s', '&lt;h3&gt;%(TITLE)s&lt;/h3&gt;']
doc_footer   = []

</pre>
Come si pu&ograve; vedere le linee contengono codice HTML ed alcuni simboli speciali, della forma
<tt>%(VAR)s</tt>, che indicano variabili da sostituire con il loro valore.

<p>
<center> <table width=80% border=1 cellpadding=4> <tr><td bgcolor=#dddddd> <font size=-1>
<b>Nota:</b> Per scrivere correttamente i comandi di personalizzazione
occorre conoscere un po' della sintassi di Python:
1) i commenti iniziano con il carattere "#"; 2) le stringhe di caratteri sono
racchiuse fra apici (') o doppi apici ("); il carattere "barra contraria" (\)
viene utilizzato per introdurre i caratteri (') o (") nella stringa /ad es: \"); 3) le sequenze
di valori sono racchiuse fra parentesi quadre: [&nbsp;] e separate da virgole;
4) &egrave; possibile andare a capo dopo una virgola.
</font> </td></tr></table> </center>

<p>
Nella generazione degli indici dei documenti vengono usate le seguenti
variabili:
<center>
Tabella 1: Variabili che possono essere usate nei comandi<br>
<table border=1 cellpadding=2>
<tr><th>         </th><th>                      </th><th colspan=6> Dove &egrave; possibile usarla </th><tr>
<tr><th> Nome </th><th> Significato           </th><th>index_header</t><th>index_item</th><th>index_footer</th><th>doc_header</th><th>doc_footer</th><th>mail_body</th><tr>
<tr><td><b>AUTHOR</b></td><td>Autore del documento</td><td>  NO  </td><td>  SI   </td><td>  NO  </td><td>  SI   </td><td>  SI   </td> <td>  SI   </td> </tr>
<tr><td><b>BBOARD</b></td><td>Nome della bacheca  </td><td>  SI   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td> <td>  SI   </td> </tr>
<tr><td><b>DATE</b></td><td>Data di creazione     </td><td>  NO   </td><td>  SI   </td><td>  NO   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td> </tr>
<tr><td><b>EXPIR</b></td><td>Data di  
                             scadenza<sup>1</sup> </td><td>  NO   </td><td>  SI   </td><td>  NO   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td> </tr>
<tr><td><b>HREF</b></td><td>Link al documento     </td><td>  NO   </td><td>  SI   </td><td>  NO   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td> </tr>
<tr><td><b>N_ITEMS</b></td><td>Numero di documenti</td><td>  SI   </td><td>  SI   </td><td>  SI   </td><td>  NO   </td><td>  NO   </td><td>  NO   </td> </tr>
<tr><td><b>TITLE</b></td><td>Titolo del documento</td><td>            NO   </td><td>  SI   </td><td>  NO   </td><td>  SI   </td><td>  SI   </td><td>  SI   </td> </tr>
<tr><td><b>SEARCH</b></td><td>Campo per specifica 
                              di ricerca          </td><td>      SI    </td><td>  NO   </td><td>  SI    </td><td>  NO   </td><td>  NO   </td><td>  NO  </td> </tr>
</table>
<font size=-1>
</center>
1. La data di scadenza &egrave; una stringa generata a partire dal comando <tt>expir_fmt</tt>
   se una data &egrave; stata specificata; e dal comando <tt>noexpir_fmt</tt>, se
   non &egrave; stata specificata alcuna data di scadenza.
 </font>
<p>
<b>Attenzione</b>: se una variabile viene scritta in modo non corretto, nonsar&agrave;
                   visualizzato alcun messaggio di errore e la pagina risulter&agrave;
                   vuota.

<h3>Provare la correttezza del file di configurazione</h3>
La correttezza sintattica pu&ograve; essere provata semplicemente utilizzando
Python come nell'esempio seguente:

<blockquote>
<tt>&gt; python /var/www/http/BillBoards/Ultimissime/wb.ini</tt>
</blockquote>
Il comando non deve riportare alcun errore (ne altro)
<p>
Adesso la bacheca personalizzata &egrave; pronta all'uso.
billboard.

<h3> Ulteriori personalizzazioni</h3>

Altre possibili personalizzazioni possono essere effettute modificando
altri comandi contenuti nel file
<a href=wb.ini><tt>wb.ini</tt></a>.
I commenti dovrebbero essere sufficienti a comprendere come
modificare i comendi. Particolarmente utili
possono essere i seguenti:

<dl>
<dt> <b>allowed_users </b>
<dd> Lista di ID di utenti autorizzati a modificare la bacheca.
     L'accesso di tali utenti &egrave; comunque protetto da password.
     Se lalijsta &egrave; vuota, chiunque abbia un ID di utente
     valido sul sistema e ne conosca la password, potr&agrave; apportare
     modifiche.
<p>
<dt> <b>delete_expired </b>
<dd>  Specifica se i documenti scaduti (o rimossi) devono essere semplicemente cancellati
      o trasferiti in una sottodirectory di nome <tt>deleted</tt>.
<p>
<dt> <b>language </b>
<dd>  Specifica la lingua da usare per la bacheca. Il valore &egrave; il nome del file di
      vocabolario. Attualmente sono disponibili i files <tt>italiano.voc</tt> e <tt>english.voc</tt>.
      Se il linguaggio di vostro interesse non &egrave; disponible potete crearlo
      voi stessi partire da uno dei files esistenti (si tratta di una mezz'ora di lavoro).
<p>
<dt> <b>mail_to </b>
<dd> Lista di indirizzi e-mail a cui inviare le notifiche dei cambiamenti avvenuti
     nella bacheca.
<p>
<dt> <b>mail_new</b>
<dd> Sequenza di linee usate per generare il messaggio da inviare per e-mail, quando
     viene aggiunto un documetno alla bacheca. Le stringhe possono contenere
     variabili (vedere tabella 1).

<p>
<dt> <b>mail_update</b>
<dd> Sequenza di linee usate per generare il messaggio da inviare per e-mail, quando
     viene modificato un documento della bacheca. Le stringhe possono contenere
     variabili (vedere tabella 1).

<p>
<dt> <b>sort_order </b>
<dd> Parole chiave che specificano l'ordine con cui compaiono
     le linee nella lista dei documenti. La stringa &egrave;
     una cobinazione delle seguenti parole:

<blockquote> date expir ascending descending
</blockquote>
Le parole sono separate da spazi e possono comparire in qualunque ordine.
Se si utyilizzano parole contrastanti, il risultato &egrave; casuale.
</dl>

<h3> Come definire un nuovo vocabolario</h3>
Per poter supportare diverse lingue, tutti i messaggi sono contenuti i
file vocabolario contenuti nella <i>radice</i>. Attualmente sono
disponibili i file: 
<tt>english.voc</tt>, <tt>italiano.voc</tt>. 

Utilizzando uno di essi come esempio potreste creare il supporto per
una nuova lingua (se lo fate, siete pregati di inviarmi il file per aggiungerlo
a quelli disponibili).

<p>
I vocabolari disponibili ed il loro contenuto, possono essere visualizzati
utilizzando una URL speciale, come nell'esempio:

<blockquote>
<tt>http://indirizzo.sito.web/cgi-bin/wb.py?.voc</tt>
</blockquote>

<h3> Traduzione dei file di aiuto</h3>

La distribuzione corrente contiene files di aiuto in Italiano ed Inglese.
I files sono contenuti nelle directory: 
<tt>_doc_it</tt> and <tt>_doc_uk</tt> rispettivamente.
<p>
Per aggiungere versioni in altre lingue &egrave; possibile creare una nuova directory
(ad esempio <tt>_doc_fr</tt> per il francese), copiarvi tutti i files contenuti in
una delle directory citate e provvedere a tradurli.
(anche in questo caso, siete pregati di inviarmi i file per includerli nella distribuzione).
<p>
Il nome della directory di help deve poi essere specificato nel file
<tt>wb.ini</tt>.
