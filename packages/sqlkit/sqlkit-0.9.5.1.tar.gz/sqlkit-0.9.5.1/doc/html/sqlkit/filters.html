<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      
      <title>
    Filters
 &mdash; sqlkit v0.9.5.1 documentation</title>
      
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sqlkit.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="sqlkit v0.9.5.1 documentation" href="../index.html" />
        <link rel="up" title="Browsing data" href="browsing.html" />
        <link rel="next" title="Totals" href="totals.html" />
        <link rel="prev" title="Constraints" href="constraints.html" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '0.9.5.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>


<!-- <link rel="stylesheet" href="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.css" type="text/css" /> -->
      <link rel="stylesheet" href="../_static/jMenu.jquery.css" type="text/css" />

      <!-- <script type="text/javascript" src="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.js"></script> -->

      <script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-18221996-2']);
	_gaq.push(['_trackPageview']);

	(function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

      </script>
      <script type="text/javascript" src="../_static/jMenu.jquery.js"></script>
      <script type="text/javascript">
	      $(document).ready(function(){
		      $("#jMenu").jMenu({
			      ulWidth : '150',
			      effects : {
				      effectSpeedOpen : 300,
				      effectSpeedClose : 300,
				      effectTypeOpen : 'slide',
				      effectTypeClose : 'slide',
				      effectOpen : 'linear',
				      effectClose : 'linear'
			      },
			      TimeBeforeOpening : 100,
			      TimeBeforeClosing : 400,
			      animatedText : false,
			      paddingLeft: 1		});
	      })
      </script>
<!-- Preview -->
     <script type="text/javascript" src="../_static/imgpreview.js"></script>
     <script type="text/javascript">
       $(document).ready(function(){
           $('.preview').imgPreview();
       });
     </script>
     
     <!--[if !IE 7]>
	     <style type="text/css">
		     #wrap {display:table;height:100%}
	     </style>
     <![endif]-->
    </head>
    <body>
        




<div id="wrap">
    
<div id="header">

	<div class="logo"><a href="../misc/tour.html">
       <img src="../_static/sqlkit.png" align="left"  alt="Logo" border="0"/></a>
        </div>
	<div id="description">Acces to db made easy</div>
</div>


   <div style="clear:left;"></div>


<div >
	<ul id="jMenu">
            <li><a class="fNiv" href="../index.html" title="Home" 
                  >Home</a></li>

            <li><a li class="fNiv" href="contents.html"
                  title="Sqlkit - the python package" 
                  >Sqlkit</a>

	       <ul>
		 <li ><a href="contents.html"
		       title="Sqlkit - the python package" 
		       >Sqlkit</a></li>

		 <li ><a href="sqlwidget.html" title="Widgets" 
		       >Widgets</a>
		       <ul> 
			 <li ><a href="mask.html" title="Mask" 
			       >Mask view</a></li>
			 <li ><a href="table.html" title="Table" 
			       >Table view</a></li>
		       </ul>
                 </li>
		 <li ><a href="browsing.html" title="Browsing Data" 
		       >Browsing data</a>
		    <ul> 
		      <li ><a href="constraints.html" title="Constraints" 
			    >Constraints</a></li>
		      <li ><a href="#" title="Filters" 
			    >Filters</a></li>
		      <li ><a href="totals.html" title="Totals" 
			    >Totals</a></li>
		    </ul>
                 </li>
		 <li ><a href="editing.html" title="Editing Data" 
		       >Editing data</a>
			 <ul> 
			   <li ><a href="completion.html" title="Completion" 
				 >Completion</a></li>
			   <li ><a href="validation.html" title="Validation" 
				 >Validation</a></li>
			   <li ><a href="relationship.html" title="Relationships" 
				 >Relationships</a></li>
			 </ul>
		       </li>
		 <li ><a href="printing.html" title="Printing" 
		       ><span>Printing</span></a></li>
		 <li ><a href="advanced/contents.html" title="Advanced configuration" 
		       >Advanced configuration</a>
			 <ul> 
			   <li ><a href="advanced/fields.html" title="Fields" 
				 >Fields</a></li>
			   <li ><a href="advanced/views.html" title="Views" 
				 >Views</a></li>
			 </ul>
		       </li>

	       </ul>
            </li>

            <li><a class="fNiv" href="../misc/sqledit.html"
                  title="Sqledit GUI" 
                  >Sqledit GUI</a></li>

            <li><a class="fNiv" href="../misc/tutorials.html"
                  title="Support & tutorials" 
                  >Support & Tutorials</a>
	       <ul>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Sqledit - the application</a></li>
		 <li ><a href="../misc/tour.html"
		       title="Sqlkit - the features'tour"
		       >Sqlkit - features' tour</a></li>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Installing instructions</a></li>
		</ul> 
            </li>

            <li><a class="fNiv" href="../layout/contents.html" title="Layout"
                  >Layout</a></li>

            <li><a  class="fNiv"href="../misc/contents.html" title="Download" 
                  >Download</a>

	       <ul>
		 <li ><a href="../misc/contents.html"
		       title="Download"
		       >Download</a></li>
		 <li ><a href="http://sqlkit.argolinux.org/download/Changelog"  title="Changelog"
		       title="Changelog"
		       >Changelog</a></li>
		 <li ><a href="../misc/backward_incompatibilities.html"
		       title="Backward incompatibilities"
		       >Backward incompatibilities</a></li>
	       </ul>
            </li>



        </ul>
</div>
   <div style="clear:left;"></div>

    
    <div class="related">
      <ul>
	
<!-- <div class="prevnext"> -->
<!--    <li class="right"  style="margin-right: 10px">Indice -->
<!--      <a href="../genindex.html" title="Indice generale" -->
<!--                accesskey="I">indice</a></li> -->

        <li class="right">Prev:
        <a href="constraints.html" title="previous chapter">Constraints</a></li>
        <li class="right">Next:
        <a href="totals.html" title="next chapter">Totals</a></li>
<!-- </div> -->


      </ul>

    </div>

    
  <div class="sphinxsidebar">
     <div class="sphinxsidebarwrapper">


	    <div class="topnav">
    <h3>Table of contents</h3>
		    <ul>
<li><a class="reference external" href="#">Filters</a><ul>
<li><a class="reference external" href="#filtering-foreign-keys">Filtering Foreign Keys</a></li>
<li><a class="reference external" href="#adding-filters-programmatically">Adding Filters programmatically</a><ul>
<li><a class="reference external" href="#filters-and-join">filters and join</a></li>
</ul>
</li>
<li><a class="reference external" href="#expressions">Expressions</a></li>
<li><a class="reference external" href="#module-sqlkit.widgets.common.sqlfilter">Date filters</a><ul>
<li><a class="reference external" href="#simple-relative-date-algebra">Simple relative date algebra</a><ul>
<li><a class="reference external" href="#periods">Periods</a></li>
<li><a class="reference external" href="#other-examples">Other examples</a></li>
</ul>
</li>
<li><a class="reference external" href="#filterpanel">FilterPanel</a><ul>
<li><a class="reference external" href="#customizing-the-output-tab">Customizing the output tab</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

		<div class="clearboth"></div>
	    </div>



    <h3>Questions?</h3>

    <p>Subscribe to out mailing list <a href="http://groups.google.com/group/sqlkit">
       Google group</a>:</p>

    <form action="http://groups.google.com/group/sqlkit/boxsubscribe" style="padding-left: 1em">
      <input type="text" name="email" value="your@email"/>
      <input type="submit" name="sub" value="Subscribe" />
    </form>
    <div id="searchbox" style="display: none">

    <h3>Quick search</h3>
	<form class="search" action="../search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />

	  <input type="hidden" name="area" value="default" />
	</form>
	<p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
	</p>
    <h3>License</h3>
	<img src="../_static/gplv3.png" alt="logo GPLv3">

    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>

     </div>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">

            <div class="body">
                
<div class="section" id="filters">
<span id="id1"></span><h1>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h1>
<img align="left" alt="../_images/filter-panel.png" class="align-left" src="../_images/filter-panel.png" />
<p>Filtering is a very powerful feature of sqlkit. Any single field in a
SqlWidget may become a filter criteria and many filters on a field are
accepted. A filter panel handles the filters that may also belong to related
table: in that case a join will be built when selecting (read the note on
selecting through joins in <a class="reference external" href="relationship.html#relationships"><em>Relationships</em></a>)</p>
<p>As you can see in the image a filter panel gives also the opportunity to
limit the query. Any filter can be enabled or disabled by clicking on it&#8217;s
toggle.</p>
<p>The result of a filter operation is shown differently in Table or Mask:
Table shows the result directly, Mask shows the list of selected records in
the Filter Panel&#8217;s Output page:</p>
<img align="right" alt="../_images/filter-output.png" class="align-right" src="../_images/filter-output.png" />
<p>Each record is shown with it&#8217;s __str__ representation that can be set in the
way described in <a class="reference external" href="completion.html#description"><em>foreign key description &amp; search field</em></a>.</p>
<p>In this Output Page it&#8217;s possible to set a field and have records grouped by
that field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="o">.</span><span class="n">filter_panel</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="s">&#39;field_name&#39;</span>
</pre></div>
</div>
<div class="section" id="filtering-foreign-keys">
<h2>Filtering Foreign Keys<a class="headerlink" href="#filtering-foreign-keys" title="Permalink to this headline">¶</a></h2>
<p>Filtering works also with foreign keys. In that case the filter acts on the
filter that represents the record, what I call the <a class="reference external" href="completion.html#completion"><em>&#8220;search&#8221;</em></a> field of the record. In this case the operator used for the
search defaults to regexp/match that in turn uses different operators in
each database backend: &#8216;~*&#8217; for postgresql, REGEXP for mysql and ILIKE for
the others (well, ILIKE is not present in sqlite but it uses the sqlalchemy
implementation of ilike) adding leading and trailing &#8216;%&#8217; symbols.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Shortcut</strong></p>
<p class="last">As a shortcut to a tipical pattern (pop a filter panel, add a filter for a
field, set a value, reload), it&#8217;s possible to write a filter string
directly in the field and activate the filter/reload operation by
Control-Alt-f. This will use <tt class="docutils literal"><span class="pre">ILIKE</span></tt> as search operator and is enabled
where completion is enabled.</p>
</div>
</div>
<div class="section" id="adding-filters-programmatically">
<h2>Adding Filters programmatically<a class="headerlink" href="#adding-filters-programmatically" title="Permalink to this headline">¶</a></h2>
<p>Filters can be added programmatically via method <tt class="docutils literal"><span class="pre">add_filter</span></tt> that uses
django_like syntax, of interactively. As an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="n">numeric_field__gte</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">boolean_field</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">t2</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="n">date_field__lte</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">string_field__null</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>more examples can be found in the <a class="reference external" href="constraints.html#constraints"><em>Constraints</em></a> sections as they share
the same syntax. Note that a filter can be changed by the user while a
constraint is invisible to him.</p>
<div class="section" id="filters-and-join">
<h3>filters and join<a class="headerlink" href="#filters-and-join" title="Permalink to this headline">¶</a></h3>
<p>When filtering programmatically on a join you must use the field_name as
known by the mapper, i.e. composition of table_name + field_name. Look demo
on join too see how it works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span> <span class="o">=</span> <span class="n">SqlTable</span><span class="p">(</span><span class="n">tables</span><span class="o">=</span><span class="s">&quot;movie director&quot;</span><span class="p">,</span> <span class="n">dbproxy</span><span class="o">=</span><span class="n">db</span> <span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="n">director_nation</span><span class="o">=</span><span class="s">&#39;IT&#39;</span><span class="p">)</span> <span class="c"># NOTE director_nation</span>
</pre></div>
</div>
<p>Here the field <em>nation</em> of table <em>director</em> is referenced as
<tt class="docutils literal"><span class="pre">director_nation</span></tt></p>
</div>
</div>
<div class="section" id="expressions">
<h2>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">¶</a></h2>
<p>Filter work just in the same way for real column as for expressions.
Example 30 in the demo shows how to create a mapper that have a column with
the number of film  of a director, and you can verify that constraints and
filter work on that table just as any normal column:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Director2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

<span class="c">## create the mapper as suggested in the SqlAlchemy tutorial...</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">Director2</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Director</span><span class="o">.</span><span class="n">__table__</span><span class="p">,</span>
   <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
    <span class="s">&#39;film_number&#39;</span><span class="p">:</span> <span class="n">column_property</span><span class="p">(</span>
            <span class="n">select</span><span class="p">(</span>
                <span class="p">[</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)],</span>
                <span class="n">model</span><span class="o">.</span><span class="n">Director</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">director_id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s">&#39;film_number&#39;</span><span class="p">)</span>
        <span class="p">)</span>
  <span class="p">}</span>
<span class="p">)</span>

<span class="n">field_list</span> <span class="o">=</span> <span class="s">&quot;last_name, first_name, nation, film_number&quot;</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">SqlTable</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">field_list</span><span class="o">=</span><span class="n">field_list</span><span class="p">,</span> <span class="n">dbproxy</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="n">film_number</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">film_number__lt</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-sqlkit.widgets.common.sqlfilter">
<span id="date-filters"></span><h2>Date filters<a class="headerlink" href="#module-sqlkit.widgets.common.sqlfilter" title="Permalink to this headline">¶</a></h2>
<p>Date filters deserve a special chapter. It&#8217;s very common the need for a
filter based on relative dates (i.e.: the beginning of the month, the year,
the last month and so on), that&#8217;s the only way to allow saving queries that
will behave the same all the time.</p>
<div class="section" id="simple-relative-date-algebra">
<h3>Simple relative date algebra<a class="headerlink" href="#simple-relative-date-algebra" title="Permalink to this headline">¶</a></h3>
<p>a function that implements simple relative date algebra so that we can use it
in bookmarks and queries.</p>
<p>Differently from what other packages do (as the very usefull relativedelta that
is used in this module) datetools tries to use the term month as a period of length
that depends on the &#8216;current&#8217; month.  End of february + 1month will be end of march,
not 28th of march!</p>
<p>Allowed chars are:</p>
<div class="highlight-python"><pre>[-+ diwWmMyY @&gt;]</pre>
</div>
<p>letters refer to a moment of time (start/end of month, year, week) or period
according to use: the forst token is a moment of time, the further ones are
periods.</p>
<blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">d:</th><td class="field-body">today</td>
</tr>
<tr class="field"><th class="field-name">i:</th><td class="field-body">yesterday (&#8216;ieri&#8217; in italian, &#8216;y&#8217; was already used by year)</td>
</tr>
<tr class="field"><th class="field-name">w:</th><td class="field-body">beginning of week</td>
</tr>
<tr class="field"><th class="field-name">W:</th><td class="field-body">end of week</td>
</tr>
<tr class="field"><th class="field-name">m:</th><td class="field-body">beginning of month</td>
</tr>
<tr class="field"><th class="field-name">M:</th><td class="field-body">end of month</td>
</tr>
<tr class="field"><th class="field-name">y:</th><td class="field-body">beginning of year</td>
</tr>
<tr class="field"><th class="field-name">Y:</th><td class="field-body">end of year</td>
</tr>
</tbody>
</table>
</blockquote>
<p>Math signs <tt class="docutils literal"><span class="pre">+</span></tt> and <tt class="docutils literal"><span class="pre">-</span></tt> work as you would expect they add and subtract
period of time. When used this way the following letter refers to a period:</p>
<div class="highlight-python"><pre>m+14d</pre>
</div>
<p>is the 15th day of the month (beginning of month + 14 days)</p>
<p>
<span class="versionmodified">New in version 0.8.6.1.</span></p>
<p>If the first token is the end of the month, we try to stick to the end as much as
possible, till another period is used, so that order is significant, note what follows that
is extracted from the doctests, assuming the current day is June 2th:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span><span class="o">.</span><span class="n">string2date</span><span class="p">(</span><span class="s">&#39;M-1m-2d&#39;</span><span class="p">)</span>
<span class="go">datetime.date(2007, 5, 29)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span><span class="o">.</span><span class="n">string2date</span><span class="p">(</span><span class="s">&#39;M-2d-1m&#39;</span><span class="p">)</span>
<span class="go">datetime.date(2007, 5, 28)</span>
</pre></div>
</div>
<p>You can also use a short form (compatible with previous syntax):</p>
<div class="highlight-python"><pre>m-1 == m-1m</pre>
</div>
<p>You can use also &gt; in which case the string is considered 2 dates, each built
as already stated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">-</span><span class="mi">1</span> <span class="o">&gt;</span> <span class="n">M</span><span class="o">+</span><span class="mi">2</span>
</pre></div>
</div>
<p>means a 3 months period, starting from beginnig of last month to end of next
month</p>
<div class="section" id="periods">
<h4>Periods<a class="headerlink" href="#periods" title="Permalink to this headline">¶</a></h4>
<p>&#64; is a compact way to set a period:</p>
<div class="highlight-python"><pre>@m == m &gt; M
@m-1  == m-1 &gt; M-1</pre>
</div>
<p>
<span class="versionmodified">New in version 0.8.6.1.</span></p>
<p>&#64; accepts also a quantity:</p>
<div class="highlight-python"><pre>@2m-1 = m-1 &gt; M-1 +1m</pre>
</div>
<p>that means a period of 2 months starting from beginning of last month.</p>
</div>
<div class="section" id="other-examples">
<h4>Other examples<a class="headerlink" href="#other-examples" title="Permalink to this headline">¶</a></h4>
<blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">m-1:</th><td class="field-body">beginnning of last month</td>
</tr>
<tr class="field"><th class="field-name">M+1:</th><td class="field-body">end of next month</td>
</tr>
</tbody>
</table>
</blockquote>
</div>
</div>
<div class="section" id="filterpanel">
<span id="filter-panel"></span><h3>FilterPanel<a class="headerlink" href="#filterpanel" title="Permalink to this headline">¶</a></h3>
<p>The filter panel is the panel where all filter conditions can be written
(remeber that constraints are different in the sense that are filters
applied w/o possibility to remove them). It opens as a window separate from
the main window so that it&#8217;s easy to hide or keep it at hand.</p>
<p>Each sqlwidget has a FilterPanel even if it doesn&#8217;t show it</p>
<dl class="class">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.common.sqlfilter.</tt><tt class="descname">FilterPanel</tt><big>(</big><em>master</em>, <em>visible=True</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel" title="Permalink to this definition">¶</a></dt>
<dd><p>A panel that manages filter conditions of a query: number of records,
field names and output to point &amp; click in case of a panel of a SqlMask</p>
<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.hide">
<tt class="descname">hide</tt><big>(</big><em>widget=None</em>, <em>event=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.hide" title="Permalink to this definition">¶</a></dt>
<dd><p>Hide the Filterpanel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>widget</em> &#8211; not neeeded: it&#8217; here to allow using it in callback</li>
<li><em>event</em> &#8211; not needed: see above</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.show">
<tt class="descname">show</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.show" title="Permalink to this definition">¶</a></dt>
<dd>Present the filter panel</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.get_tools">
<tt class="descname">get_tools</tt><big>(</big><em>field_name</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.get_tools" title="Permalink to this definition">¶</a></dt>
<dd><p>return a list of FilterTool for <em>field_name</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>field_name</em> &#8211; name of the field</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.reload">
<tt class="descname">reload</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.reload" title="Permalink to this definition">¶</a></dt>
<dd>issue a reload operation on master. Callback of reload button</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.set_page">
<tt class="descname">set_page</tt><big>(</big><em>action=None</em>, <em>name=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.set_page" title="Permalink to this definition">¶</a></dt>
<dd><p>set the tab in the filter. Tab name can be &#8216;filter&#8217; or &#8216;output&#8217;.
Sqlmasks only have &#8216;filter&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>name</em> &#8211; name of the tab in the filter widget: <em>filter</em> or <em>output</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.tree">
<tt class="descname">tree</tt><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.tree" title="Permalink to this definition">¶</a></dt>
<dd>The name of an attribute that will work as grouping attribute.
The output TreeView will show records grouped by the same attribute as parent/child.
It should be improved as the parent is a the record and not a row with the only
grouping attribute.</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.replace_column">
<tt class="descname">replace_column</tt><big>(</big><em>field_class</em>, <em>field_name='__obj__'</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.replace_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the column of the output treeview with a customized one</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>field_class</em> &#8211; a subclass of <tt class="docutils literal"><span class="pre">sqlwidget.fields.Field</span></tt>
with a proper <tt class="docutils literal"><span class="pre">clean_value</span></tt> method</li>
<li><em>field_name</em> &#8211; the field_name of the column, Default: <tt class="docutils literal"><span class="pre">__obj__</span></tt> (i.e. the
name used for the default column of the output treeview</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.add_column">
<tt class="descname">add_column</tt><big>(</big><em>field_name</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.add_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a column among already defined fields in gui_fields</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>field_name</em> &#8211; the field_name of the field</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.clear" title="Permalink to this definition">¶</a></dt>
<dd>Destroy all filter widgets matered by this FilterPanel</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterPanel.short_filter">
<tt class="descname">short_filter</tt><big>(</big><em>field_name</em>, <em>relationship_path=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterPanel.short_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a filter getting the value from the table/mask</p>
<p>This is a shortcut for the longer operation:</p>
<blockquote>
<ol class="arabic simple">
<li>add a filter widget</li>
<li>set a value</li>
<li>reload</li>
</ol>
</blockquote>
<p>it is meant to be called from a connect in a (varchar) widget
by pressing C-M-f. It will:</p>
<blockquote>
<ol class="arabic simple">
<li>add a filter</li>
<li>get the value for the filter from the text widget</li>
<li>set that value in the filter widget</li>
<li>disreguard the value</li>
<li>launch realod</li>
<li>disable the filter so that subsequent searches on different fields
won&#8217;t be affected</li>
</ol>
</blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.common.sqlfilter.</tt><tt class="descname">FilterTool</tt><big>(</big><em>field_name</em>, <em>panel</em>, <em>master</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool" title="Permalink to this definition">¶</a></dt>
<dd><p>A tool that handles the the filter and provides a mean to modify the query of the
master (sqlwidget). With the FilterTool you can programmatically set the filter
active/inactive, change the operator and the filter values.</p>
<p>You will normally do all this with the <tt class="docutils literal"><span class="pre">.add_filter</span></tt> method of sqlwidget, but
you may occasionally need to fine tune the filter in a second time</p>
<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool.set_value">
<tt class="descname">set_value</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool.set_value" title="Permalink to this definition">¶</a></dt>
<dd>set the value of the filter. It can be a string or an object (eg. a date())</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool.get_value">
<tt class="descname">get_value</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool.get_value" title="Permalink to this definition">¶</a></dt>
<dd>return the current value of the filter</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool.set_operator">
<tt class="descname">set_operator</tt><big>(</big><em>op</em>, <em>value</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool.set_operator" title="Permalink to this definition">¶</a></dt>
<dd>Set the active operator entry in ComboBox/OptionMenu for operator choice
:param op: the operator
:param value: the value of the operator</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool.get_operator">
<tt class="descname">get_operator</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool.get_operator" title="Permalink to this definition">¶</a></dt>
<dd>return the active operator entry in ComboBox/OptionMenu</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlfilter.FilterTool.destroy">
<tt class="descname">destroy</tt><big>(</big><em>window=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlfilter.FilterTool.destroy" title="Permalink to this definition">¶</a></dt>
<dd>Destroy the FilterToold and related widgets and de-register from FilterPanel</dd></dl>

</dd></dl>

<p>When the filter is used from a SqlTable, the output is displayed directly
into the SqlTable.  When the filter is used from a SqlMask the output is
shown in a special tab of the FilterPanel that is really a <a class="reference external" href="table.html#views"><em>View</em></a> on the output that can be customized to a good degree. Default
representation is <tt class="docutils literal"><span class="pre">str(obj)</span></tt> unless a you have defined a <tt class="docutils literal"><span class="pre">format</span></tt>
in the <a class="reference external" href="completion.html#sqlkit-table"><em>database attribute description</em></a> for that table.</p>
<div class="section" id="customizing-the-output-tab">
<h4>Customizing the output tab<a class="headerlink" href="#customizing-the-output-tab" title="Permalink to this headline">¶</a></h4>
<p>The default representation of records is a <a class="reference external" href="table.html#views"><em>View</em></a> with a single
column named <tt class="docutils literal"><span class="pre">__obj__</span></tt> that is a field that creates a str(obj) as
explained above.</p>
<p>If you want to change that representation you just need to substitute the
column in the treeview:</p>
<div class="highlight-python"><pre>from sqlkit.import fields
from sqlkit.db.utils import DictLike

class CountMovies(fields.IntegerField):
    '''
    A field that counts the movies
    '''
    def clean_value(self, value):
        ## missing a field_name attribute on obj the objct itselt is passed
        return len(value.movies)

my_mask.filter_panel.replace_column(CountMovies)</pre>
</div>
<p>Alternatively you can <a class="reference external" href="table.html#add-view-column"><em>add a column</em></a> to the output view
after creating the field and the column you would add it to the view as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">count</span> <span class="o">=</span> <span class="n">CountMovies</span><span class="p">(</span><span class="s">&#39;n_movies&#39;</span><span class="p">)</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">VarcharColumn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s">&#39;n_movies&#39;</span><span class="p">,</span> <span class="s">&#39;Movie Count&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
<span class="n">my_mask</span><span class="o">.</span><span class="n">filter_panel</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point you can sort the output on each column and even get totals in it.</p>
</div>
</div>
</div>
</div>


            </div>
        </div>
     </div>
   </div>

        
</div> <!-- wrap -->

            <div class="bottomnav footer">
                <div class="doc_copyright">
                Alessandro Dentella -- Copyright 2006-2007-2008-2009-2010
		  Sqlkit release 0.9.5.1
<!--                 % if hasdoc('copyright'): -->
<!--                     &copy; <a href="../copyright.html">Copyright</a> 2008, Sandro Dentella. -->
<!--                 % else: -->
<!--                     &copy; Copyright 2008, Sandro Dentella. -->
<!--                 % endif -->
                    creato usando  <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
                </div>
            </div>
        












<br style="clear: left" />

    </body>
</html>




