<div metal:define-macro="users_edit" tal:omit-tag=""
       xmlns:tal="http://xml.zope.org/namespaces/tal"
       xmlns:metal="http://xml.zope.org/namespaces/metal">
  <div class="listActions">
    <div class="first">
      <img src="/Static/Images/user22.png" alt="${_('Users')}"/>
    </div>
    <div class="last">
      ${form.submit_image('add?usr', _('Add user'), '/Static/Images/action_add.png')}
     </div>
  </div>
  <table class="list smallList">
    <caption>${_('Users')}</caption>
    <tr>
      <th>${_('Login')}</th>
      <th>${_('Name')}</th>
      <th>${_('Permission')}</th>
      <th class="last">${_('Action')}</th>
    </tr>
    <tr tal:repeat="user users">
      <td><a href="${route('user_view', user_id=user.user_id)}">${user.login}</a></td>
      <td><a href="${route('user_view', user_id=user.user_id)}">${user.name}</a></td>
      <td>
        ${form.select('perm_%d' % user.user_id, user.perm, perms.items())}
      </td>
      <td class="last" tal:switch="action == 'rmv?usr%d' % user.user_id">
        <span tal:case="True" tal:omit-tag="">
          ${form.submit('rmv!usr%d.x' % user.user_id, _('Confirm removal'), class_='button')}
          ${form.submit_cancel(_('Cancel'))}
        </span>
        <span tal:case="False" tal:omit-tag="">
          ${form.submit_image('rmv?usr%d' % user.user_id, _('Remove user'),
            '/Static/Images/action_remove_one.png')}
        </span>
      </td>
    </tr>
  </table>
</div>