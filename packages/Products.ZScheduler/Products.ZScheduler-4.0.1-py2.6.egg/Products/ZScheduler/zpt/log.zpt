<html tal:replace="structure container/manage_page_header"/>

  <div tal:omit-tag=""
       tal:define="results here/logger;
                   results_start python:0;
                   results_start request/results_start | results_start;
                   Batch python:modules['ZTUtils'].Batch;
                   mq python:modules['ZTUtils'].make_query;
                   results_batch python:Batch(results, here.log_batch_size, results_start, orphan=2)">

    <span tal:replace="structure here/manage_tabs"/>
 
    <br/>

    <form action="" tal:attributes="action request/URL1" name="objectItems">
       <table width="100%">
          <tr>
            <td class="form-text">
                 Logger contains <span tal:replace="python: len(results)"/> records(s).
            </td>
            <td align="right" class="list-item" tal:condition="results">
                 <input type="submit" name="manage_clearLog:method" value=" Clear Log "/>
            </td>
          </tr>
       </table>

       <table width="100%" cellspacing="0" cellpadding="2" border="0" tal:condition="results">
          <tr class="list-header">
             <td width="32" colspan="2" class="list-item" align="left"
                 tal:define="p results_batch/previous">
                <div tal:omit-tag="" tal:condition="p">
                    <a href=""
                         tal:define="qs python: mq(request.form, results_start=p.first)"
                         tal:attributes="href python: 'manage_log?%s' %  qs">
                      << Prev
                    </a>
                </div>
                <div tal:condition="not: p" tal:omit-tag="">&nbsp;</div>
             </td>
             <td width="15%" class="list-item">Process</td>
             <td width="25%" class="list-item">Time</td>
             <td width="50%" class="list-item" align="left">Message</td>
             <td class="list-item" align="right" nowrap 
                 tal:define="n results_batch/next">
                <div tal:omit-tag="" tal:condition="n">
                      <a href=""
                         tal:define="qs python: mq(request.form, results_start=n.first)"
                         tal:attributes="href python: 'manage_log?%s' % qs">
                        Next >>
                      </a>
                </div>
                <div tal:condition="not: n" tal:omit-tag="">&nbsp;</div>
             </td>
          </tr>
          <tr  class="row-hilite" 
               tal:repeat="logrec results_batch"
               tal:attributes="class python: test(repeat['logrec'].index % 2, 
                                                  'row-normal', 'row-hilite')">
            <tal:block tal:define="event logrec/event">
               <td class="list-item" valign="top">
                  <input type="checkbox" name="ids:list" value="" 
                         tal:attributes="value python:logrec.getId()">
               </td>
               <td class="list-item" valign="top">
                  <img src="" border="0" tal:attributes="src logrec/icon"/>
                  <img src="" tal:condition="python: not event"
                       tal:attributes="src string:${request/BASEPATH1}/p_/broken"/>
               </td>
               <td class="list-item" valign="top">
                  <a href="" tal:condition="nocall: event | nothing"
                     tal:attributes="href string:${logrec/url}/manage_workspace" tal:content="logrec/url"/>
                  <span tal:condition="python: not event" tal:replace="logrec/process"/>
               </td>
               <td class="list-item" nowrap valign="top" tal:content="logrec/timestamp"/>
               <td class="list-item" colspan="2" valign="top">
                   <div class="form-label" tal:condition="logrec/title" tal:content="logrec/title"/>
                   <div class="form-help" tal:condition="logrec/message" tal:content="logrec/message"/>
               </td>
             </tal:block>
          </tr>
          <tr>
               <td colspan="6" class="list-item">
                  <input type="submit" name="manage_delLogEntries:method" value=" Delete "/>
               </td>
          </tr>
       </table>
    </form>

  </div>
<html tal:replace="structure container/manage_page_footer"/>

