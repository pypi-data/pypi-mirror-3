<tal:video define="video nocall: view/video;
                    thumb string:${view/url}/thumbnailImage_thumb;
                    fullThumb string:${view/url}/thumbnailImage_preview;
                    hasThumb video/hasImageAndCaption;
                    thumbCaption string:'';">

 <span tal:omit-tag="" tal:condition="not:options/feature_video">
  <tal:image condition="hasThumb">
    <a class="featured-video-image"
       tal:attributes="href string:${view/url}/view; title thumbCaption">
      <img tal:attributes="src thumb; alt thumbCaption" />
    </a>
  </tal:image>
  </span>
 <span tal:omit-tag="" tal:condition="options/feature_video" 
        tal:define="mp4 video/isTranscodedPlumiVideoObj/mp4-low|nothing;
                    webm video/isTranscodedPlumiVideoObj/webm-low|nothing;">

     <video id="main-video" class="featured-video" controls width="320" height="183" tal:attributes="poster fullThumb" controls="controls" preload="none">
        <source tal:condition="python:webm and webm['status']=='ok'" tal:attributes="src string:${webm/address}/${webm/path}" type="video/webm" />
        <source tal:condition="python:mp4 and mp4['status']=='ok'" tal:attributes="src string:${mp4/address}/${mp4/path}" type="video/mp4" />
        <object width="320" height="183" type="application/x-shockwave-flash" data="++resource++collective.mediaelementjs/flashmediaelement.swf">
            <param name="movie" value="++resource++plumi.content.mediaelement/flashmediaelement.swf" />
            <param name="flashvars" tal:attributes="value string:controls=true&poster=${thumb}&file=${mp4}" />
            <!-- Image as a last resort -->
            <img tal:attributes="src thumb" width="320" height="183" title="No video playback capabilities" />
        </object>
     </video>
    <script language="javascript">
      var player = new MediaElementPlayer('video#main-video');
    </script>
  </span>

  <h4 tal:condition="options/show_title">

    <a class="video-download" title="View details about this video"
       tal:attributes="href string:${view/url}/view;">
       <img height="16" width="16" title="" alt="" src="video_icon.png"/>
    </a>

    <a class="featuredItemTitle" href=""
       tal:content="view/video_title"
       tal:attributes="href string:${view/url}/view;
		       title video/Description" />
  </h4>
  <div class="featured-video-duration"
        tal:define="duration video/videoDuration|nothing"
        tal:condition="duration">
     <img src="" tal:attributes="src string:clock.gif">
     <span class="discreet" tal:content="duration" /> 
  </div>		       

  <span class="featuredItemDetailsPosted discreet" i18n:translate="">
    Posted:
    <tal:date content="view/post_date" i18n:name="PostedDate"/>
     by <a tal:attributes="href string:${context/portal_url}/author/${view/creator}" 
           tal:content="view/creator" />
    <span tal:condition="view/total_comments">with <span tal:replace="view/total_comments">1</span> comments</span>
  </span>


  <p class="discreet plumi-nice-description rounded" tal:condition="not:options/feature_video">
    <tal:desc tal:content="video/Description" />
    <span class="featured-read-more">
      <a href=""
	 id="featured-video-more"
	 tal:attributes="href string:${view/url}/view;
			 title view/video_title"
     i18n:translate=""
	 >Read more&hellip;</a>
    </span>
 </p>

  <p class="feature discreet plumi-nice-description rounded" tal:condition="options/feature_video">
    <tal:desc tal:content="video/Description" />
    <span class="featured-read-more">
      <a href=""
	 id="featured-video-more"
	 tal:attributes="href string:${view/url}/view;
			 title view/video_title"
     i18n:translate=""
	 >Read more&hellip;</a>
    </span>
 </p>
  
  <dl class="plumi-categories plumi-props-listing"
      tal:define="categories video/categories"
      tal:condition="categories">
    <dt i18n:translate="">Categories</dt>
    <dd>
      <ul>
	<li tal:repeat="cat categories">
	  <a href="" title="" id=""
	     tal:attributes="href cat/url;
			     id cat/id;
			     title cat/title;
			     class string:category-${cat/id};"
	     tal:content="cat/title" />
	</li>
      </ul>
    </dd>
  </dl>

   <dl class="plumi-country plumi-props-listing"
      tal:define="country video/country; "
      tal:condition="country">
    <dt i18n:translate="">Country</dt>
    <dd><ul><li>
	  <a href="" title="" id=""
	     tal:attributes="href country/url|nothing ;
			     id country/id|nothing ;
			     title country/title|nothing ;
			     " tal:content="country/title" tal:omit-tag="not: country/url|nothing"/>
	     </li></ul>
    </dd>
  </dl>

   <dl class="plumi-videolanguage plumi-props-listing"
      tal:define="video_language video/video_language; "
      tal:condition="video_language">
    <dt i18n:translate="">Video Language</dt>
    <dd><ul><li>
	  <a href="" title="" id=""
	     tal:attributes="href video_language/url|nothing ;
			     id video_language/id|nothing ;
			     title video_language/title|nothing ;
			     " tal:content="video_language/title" tal:omit-tag="not: video_language/url|nothing"/>
	     </li></ul>
    </dd>
  </dl>
 
</tal:video>
