{% extends "admin/change_form.html" %}

{% block extrahead %}
{% if original.items.count %}
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = google.visualization.arrayToDataTable([
            ['Response', 'Selected'],
            {% for response_option, response_count in original.response_stats.items %}
            ['{{ response_option }}', {{ response_count }}],
            {% endfor %}
        ]);

        var options = {
            title: 'Current review stats'
        };

        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    }
</script>
{% endif %}
{% endblock %}

{% block form_top %}
{% if original.items.count %}
    <div id="chart_div" style="width: 300px; height: 300px;"></div>
{% endif %}
<ul>
{% for peer in original.peers.all %}
    <li>{{peer}}</li>
{% endfor %}
</ul>
{% endblock %}

{% block object-tools %}
{% if change %}{% if not is_popup %}
<ul class="object-tools">
    <li><a href="{% url peer-review-index %}">Frontend</a></li>
    <li><a href="{% url peer-review-items-list original.id %}">Assigned {{ original.content_type.name }}(s)</a></li>
    <li><a href="{% url peer-review-email-remainder original.id %}">Send email remainder to assigned peers</a></li>
    <li><a href="{% url peer-review-email-message original.id %}">Send specific message to assigned peers</a></li>
    <li><a href="history/" class="historylink">History</a></li>
</ul>
{% endif %}{% endif %}
{% endblock %}

{% block after_related_objects %}
{% if original.pk %}
<div class="submit-row">
    <p class="deletelink-box">Manage this request</p>
    <input type="submit" value="Approve" name="approve">
    <input type="submit" value="Deny" name="deny">
    <input type="submit" value="Complete" name="complete">
    <input type="submit" value="Reopen" name="reopen">
</div>
{% endif %}
{% endblock %}