<html tal:replace="structure context/manage_page_header"/>

    <span tal:replace="structure context/manage_tabs"/>

    <br/>
    <div class="form-label">Payment Status: <span tal:replace="context/status"/></div>
    <div class="form-label" tal:define="txn context/getTransactionRef">Transaction: 
            <a tal:condition="python: txn"
                         tal:attributes="href string:${txn/absolute_url}/manage_workspace"
                         tal:content="txn/title_or_id"/>
            <span tal:condition="python: not txn">N/a</span>
    </div>
    <div class="form-label">Reference: <tal:block tal:define="ref context/referenceObject">
                      <a tal:condition="python: ref"
                         tal:attributes="href string:${ref/absolute_url}/manage_workspace"
                         tal:content="ref/title_or_id"/>
                      <span tal:condition="python: not ref" tal:content="context/reference"/>
                   </tal:block></div>

       <table border="0" cellpadding="2" cellspacing="0" width="100%"
              tal:define="entries context/getReturnCodes">
           <tr tal:define="wf context/portal_workflow/bastionpayment_workflow;
                           actions python: context.getActionsFor(wf);"
               tal:condition="actions">
               <td colspan="7" align="right">
                  <form action="" tal:attributes="action request/URL1">
	             <select name="action">           
                        <option tal:repeat="action actions"
                                tal:content="action"/>
                     </select>
                     <input type="hidden" name="wfid" value="" tal:attributes="value wf/getId">
                     <input type="submit" name="manage_changeStatus:method" value=" Change ">
                  </form>
               </td>
           </tr>
           <tr class="list-header" tal:condition="entries">
               <td class="list-item">Date</td>
               <td class="list-item">Instigator</td>
               <td class="list-item">Reference</td>
               <td class="list-item">Amount</td>
               <td class="list-item">Return Code</td>
               <td class="list-item">Severity</td>
     	       <td class="list-item">Message</td>
           </tr>
           <div tal:repeat="item_tuple entries" tal:omit-tag="">
               <tr class="row-hilite"
                   tal:define="item python:item_tuple[1]; item_id python: item_tuple[0]"
                   tal:attributes="class python: test(repeat['item_tuple'].index % 2, 'row-normal', 'row-hilite')">
                   <td class="list-item">
                       <a href="" tal:attributes="href string:returncodes/${item_id}/manage_workspace"
                          tal:content="python: item.bobobase_modification_time().strftime('%Y-%m-%d %H:%M')"/>
                   </td>
                   <td class="list-item" tal:content="item/instigator"/>
                   <td class="list-item" tal:content="item/reference"/>
                   <td class="list-item" tal:content="item/amount"/>
                   <td class="list-item" tal:content="item/returncode"/>
                   <td class="list-item" tal:content="item/severity"/>
                   <td class="list-item" tal:content="item/message"/>
               </tr>
           </div>
         </table>

<html tal:replace="structure context/manage_page_footer"/>
