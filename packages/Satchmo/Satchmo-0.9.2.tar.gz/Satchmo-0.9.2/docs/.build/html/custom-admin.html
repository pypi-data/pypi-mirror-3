

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Customizing Admin &mdash; Satchmo v0.9.2-development documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.2-development',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Satchmo v0.9.2-development documentation" href="index.html" />
    <link rel="next" title="Custom Payment Modules" href="custom-payment.html" />
    <link rel="prev" title="Store Customization" href="customization.html" /> 
  </head>
  <body>

<div style="background-image: url(_static/satchmo-sliver.jpg); background-repeat: repeat-x; background-color: white; text-align: left;">
<img src="_static/satchmo-front.jpg">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="custom-payment.html" title="Custom Payment Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="customization.html" title="Store Customization"
             accesskey="P">previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Customizing Admin</a><ul>
<li><a class="reference internal" href="#modifying-the-product-model">Modifying the Product Model</a></li>
<li><a class="reference internal" href="#using-mix-ins-to-customize-the-admin">Using Mix-ins to customize the admin</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="customization.html"
                        title="previous chapter">Store Customization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="custom-payment.html"
                        title="next chapter">Custom Payment Modules</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<p>Documentation Version:</p>
<ul>
    <li><a href="/docs/dev">Current development version</a></li>
    <li><a href="/docs/rel/latest">Latest Release version</a></li>
    <li><a href="http://bitbucket.org/chris1610/satchmo/downloads/Satchmo-0-9-1.pdf">PDF Documentation</a></li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="customizing-admin">
<h1>Customizing Admin<a class="headerlink" href="#customizing-admin" title="Permalink to this headline">¶</a></h1>
<p>Satchmo does not make extensive modifications to the default
Django admin. However, it is relatively straightforward to make
changes to the admin for your needs - without modifying Satchmo&#8217;s
core.</p>
<div class="section" id="modifying-the-product-model">
<h2>Modifying the Product Model<a class="headerlink" href="#modifying-the-product-model" title="Permalink to this headline">¶</a></h2>
<p>The default Product admin model displays all possible fields and makes some
assumptions about what you would like to see. If you would like to modify
the admin to use special widgets or change fields that are displayed, use
<tt class="docutils literal"><span class="pre">admin.site.unregister</span></tt> to unregister the current product model and add
your own.</p>
<p>Assuming you have a localapp <tt class="docutils literal"><span class="pre">admin.py</span></tt> file, use code similar to the example below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">product.models</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">product.admin</span> <span class="kn">import</span> <span class="n">ProductOptions</span>
<span class="kn">from</span> <span class="nn">tinymce.widgets</span> <span class="kn">import</span> <span class="n">AdminTinyMCE</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Rest of your admin models go here.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">Product</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CustomProductAdmin</span><span class="p">(</span><span class="n">ProductOptions</span><span class="p">):</span>
    <span class="n">formfield_overrides</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;widget&#39;</span><span class="p">:</span> <span class="n">AdminTinyMCE</span><span class="p">},</span>
        <span class="p">}</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s">&#39;items_in_stock&#39;</span><span class="p">,</span> <span class="s">&#39;active&#39;</span><span class="p">,</span><span class="s">&#39;featured&#39;</span><span class="p">)</span>
    <span class="n">list_display_links</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,)</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Product</span><span class="p">,</span> <span class="n">CustomProductAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>This code does a couple of things:</p>
<blockquote>
<ul class="simple">
<li>Replace the default Text Editor widget with <a class="reference external" href="http://code.google.com/p/django-tinymce/">TinyMCE widget</a></li>
<li>Changes the columns in the list_display to be a subset of the default</li>
<li>Ensures that the name is a link to the product</li>
</ul>
</blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These changes must be included in an application that is listed after
all the other Satchmo Apps in <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt></p>
</div>
</div>
<div class="section" id="using-mix-ins-to-customize-the-admin">
<h2>Using Mix-ins to customize the admin<a class="headerlink" href="#using-mix-ins-to-customize-the-admin" title="Permalink to this headline">¶</a></h2>
<p>Mix-ins are a very powerful feature available in python that allow for
advanced customization of Satchmo.  With mix-ins you can add arbitrary
elements (functions, model attributes, etc...) to any class/model.
The full uses of mix-ins are outside the scope of this document but
let’s start with an example.</p>
<p>Suppose you want to show product SKUs of all the products in an order
on the Product Orders page. The screenshot below shows you what the current
order screen looks like:</p>
<img alt="_images/order-screen2.png" src="_images/order-screen2.png" />
<p>We will modify it to show all the skus in an order like this:</p>
<img alt="_images/order-screen1.png" src="_images/order-screen1.png" />
<p>Here is a chunk of code that would create a list of skus for a given order:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">order_sku</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">allsku</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">allsku</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">&lt;br /&gt;&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">sku</span>
    <span class="k">return</span> <span class="n">allsku</span>
<span class="n">order_sku</span><span class="o">.</span><span class="n">allow_tags</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">order_sku</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&quot;Order SKUs&quot;</span>
</pre></div>
</div>
<p>You could then add ‘order_sku’ to the list display of Order.  The
problem is, where do you put the chunk of code listed above?  You
could add it to the Order models but that would be forking Satchmo and
later when it was time to upgrade to the next version of Satchmo
things could be much more difficult.  The solution is mix-ins.</p>
<p>Mix-ins allow you to dynamically change the inheritance of a class.
We will change Orders from looking like this:</p>
<div class="highlight-python"><pre>class Order(models.Model):</pre>
</div>
<p>to this:</p>
<div class="highlight-python"><pre>class Order(models.Model, ourNewClass):</pre>
</div>
<p>In order to accomplish this without actually modifying existing Satchmo done, you
can put order_sku in a class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">OrderExtend</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">order_sku</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">allsku</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">allsku</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">&lt;br /&gt;&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">sku</span>
        <span class="k">return</span> <span class="n">allsku</span>
    <span class="n">order_sku</span><span class="o">.</span><span class="n">allow_tags</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">order_sku</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&quot;Order SKUs&quot;</span>
</pre></div>
</div>
<p>and adding:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Order</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">+=</span> <span class="p">(</span><span class="n">OrderExtend</span><span class="p">,)</span>
</pre></div>
</div>
<p>The last bit takes the __bases__ of Order (which are its base
inheritance classes) and adds OrderExtend to it.  Because Order now
inherits from OrderExtend we can use order_sku.  To make skus show up
in the admin we create <tt class="docutils literal"><span class="pre">localsite/admin.py</span></tt> and put all of our code in
it so it looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">satchmo_store.shop.models</span> <span class="kn">import</span> <span class="n">Order</span><span class="p">,</span> <span class="n">OrderItem</span>
<span class="kn">from</span> <span class="nn">satchmo_store.shop.admin</span> <span class="kn">import</span> <span class="n">OrderOptions</span>

<span class="k">class</span> <span class="nc">OrderExtend</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">order_sku</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">allsku</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">allsku</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">&lt;br /&gt;&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">sku</span>
        <span class="k">return</span> <span class="n">allsku</span>
    <span class="n">order_sku</span><span class="o">.</span><span class="n">allow_tags</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">order_sku</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&quot;Order SKUs&quot;</span>

<span class="n">Order</span><span class="o">.</span><span class="n">__bases__</span> <span class="o">+=</span> <span class="p">(</span><span class="n">OrderExtend</span><span class="p">,)</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">Order</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CustomOrderAdmin</span><span class="p">(</span><span class="n">OrderOptions</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;order_sku&#39;</span><span class="p">,</span> <span class="s">&#39;contact&#39;</span><span class="p">,</span> <span class="s">&#39;time_stamp&#39;</span><span class="p">,</span>
                    <span class="s">&#39;order_total&#39;</span><span class="p">,</span> <span class="s">&#39;balance_forward&#39;</span><span class="p">,</span> <span class="s">&#39;status&#39;</span><span class="p">,</span>
                    <span class="s">&#39;invoice&#39;</span><span class="p">,</span> <span class="s">&#39;packingslip&#39;</span><span class="p">,</span><span class="s">&#39;shippinglabel&#39;</span><span class="p">)</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span> <span class="n">CustomOrderAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>Obviously you could do a lot more with mix-ins. You can add arbitray functions
and attributes to any model and any class.  A much longer
explaination that is not django specific but has more examples (and the document used as a reference
for writing this up) can be found <a class="reference external" href="http://www.linuxjournal.com/node/4540/print">here</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="custom-payment.html" title="Custom Payment Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="customization.html" title="Store Customization"
             >previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010, Chris Moffitt.
      Last updated on Mar 10, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
<script src='http://www.google-analytics.com/ga.js' type='text/javascript'></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1711397-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>