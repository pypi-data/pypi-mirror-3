<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="redomino.tokenrole">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('enable_border',1)" />

<body>
  <div metal:fill-slot="main" tal:define="here_url context/@@plone_context_state/object_url;">
    <h1 class="documentFirstHeading"
        i18n:translate="heading_tokenrole_manage">Token Role management</h1>
    
    <ul tal:define="tokens_data view/tokens_data;">
    <tal:block tal:repeat="tokenid view/token_ids">
        <li>
            <strong tal:content="tokenid" >token id</strong><br />
            <span i18n:translate="token_end_date">End date:</span>
            <span tal:content="python:tokens_data[tokenid].get('token_end')">end date</span> <br />
            <a href="" 
               tal:attributes="href string:$here_url/@@token_edit?form.widgets.token_id=$tokenid"
               i18n:translate="tokenrole_modify_token">
                Modify</a>,
            <a href="" 
               tal:attributes="href string:$here_url/@@token_delete?form.widgets.token_id=$tokenid"
                   i18n:translate="tokenrole_delete_token">
                Delete</a>,
            <a href="" 
               tal:attributes="href string:$here_url/@@token_send?form.widgets.token_id=$tokenid"
                   i18n:translate="tokenrole_send_token">
                Distribute Token</a>
            <p i18n:translate="token_url">URL:<br/>
                <a href="" tal:define="token_url string:$here_url?token=$tokenid"
                   tal:attributes="href token_url" tal:content="token_url">url token</a></p>
        </li>
    </tal:block>
    </ul>
    
    <strong><a href="" tal:attributes="href string:$here_url/@@token_add" i18n:translate="new_token">New token</a>
    </strong>    
    <strong tal:condition="nothing"><a href="" i18n:translate="token_back"
               tal:attributes="href string:$here_url">Back to context</a>
    </strong>
</div>
</body>
</html>
