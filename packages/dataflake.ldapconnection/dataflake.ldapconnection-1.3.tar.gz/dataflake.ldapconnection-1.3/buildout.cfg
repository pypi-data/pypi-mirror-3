# This buildout is used for development of dataflake.ldapconnection.
# It gets the necessary eggs and creates a test runner and a python
# interpreter.

[buildout]
develop = .
parts = 
    test 
    coverage
    sphinx
    docbuilder
    pdfbuilder

[test]
recipe = zc.recipe.testrunner
defaults = ['-cv']
eggs = dataflake.ldapconnection

[coverage]
recipe = zc.recipe.testrunner
defaults = ['--coverage=parts/coverage']
eggs = dataflake.ldapconnection

[sphinx]
recipe = zc.recipe.egg
eggs =  
    dataflake.ldapconnection
    sphinx
    sphinx-pypi-upload
    zc.rst2
    pkginfo
    repoze.sphinx.autointerface
scripts =
    sphinx-build

[docbuilder]
recipe = collective.recipe.template
input = inline:
    #!/bin/sh
    # Build the Sphinx documentation in one step
    export PATH="${buildout:bin-directory}:$PATH"
    cd "${buildout:directory}/docs"
    make clean
    make doctest html
output = ${buildout:bin-directory}/docbuilder.sh
mode = 755

[pdfbuilder]
recipe = collective.recipe.template
input = inline:
    #!/bin/sh
    # Build the Sphinx documentation as PDF in one step
    export PATH="${buildout:bin-directory}:$PATH"
    cd "${buildout:directory}/docs"
    make latex
    cd _build/latex
    make all-pdf
    cp dataflake.ldapconnection.pdf ../html/
output = ${buildout:bin-directory}/pdfbuilder.sh
mode = 755
