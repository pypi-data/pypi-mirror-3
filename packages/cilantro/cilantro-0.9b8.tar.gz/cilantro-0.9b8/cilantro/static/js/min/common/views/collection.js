var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define(["common/utils"],function(a){var b,c,d;return b=function(){function a(){this.update=__bind(this.update,this),this.destroy=__bind(this.destroy,this),this.remove=__bind(this.remove,this),this.reset=__bind(this.reset,this),this.add=__bind(this.add,this),this.all=__bind(this.all,this),a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a.prototype.viewClass=Backbone.View,a.prototype.defaultContent=null,a.prototype.initialize=function(){this.childViews={},this.collection.bind("add",this.add),this.collection.bind("reset",this.reset),this.collection.bind("remove",this.remove),this.collection.bind("destroy",this.destroy),this.collection.bind("change",this.update);if(this.defaultContent)return this.collection.bind("all",this.all),this.defaultContent=this.$(this.defaultContent).detach(),this.el.append(this.defaultContent)},a.prototype.insertChild=function(a){return this.el.append(a.el)},a.prototype.all=function(){return this.collection.length?this.defaultContent.hide():this.defaultContent.show()},a.prototype.add=function(a){var b;return(b=this.childViews[a.id||a.cid])?clearTimeout(b._destroyTimer):(b=this.childViews[a.id||a.cid]=(new this.viewClass({model:a})).render(),this.insertChild(b)),b},a.prototype.reset=function(a,b){a.each(this.add);if(b.initial)return this.el.animate({opacity:100},500)},a.prototype.remove=function(a){var b;return b=this.childViews[a.id||a.cid],b.el.detach(),b._destroyTimer=setTimeout(__bind(function(){return this.destroy(a)},this),1e4)},a.prototype.destroy=function(a){return this.childViews[a.id||a.cid].el.remove()},a.prototype.update=function(a){var b;return b=this.childViews[a.id||a.cid],!b&&(b=this.childViews[a.cid])&&(this.childViews[a.id]=b,delete this.childViews[a.cid]),b.render()},a}(),c={collapsedLength:5,getItems:function(){return this.el.children()},getHiddenItems:function(){return this.getItems().filter(":gt("+(this.collapsedLength-1)+")")},getExpanderText:function(){return"Show "+this.getHiddenItems().length+" more.."},renderExpander:function(){return this.expander=$('<a class="expand-list" href="#">'+this.getExpanderText()+"</a>").bind("click",__bind(function(){return this.expand(),!1},this)),this.el.after(this.expander)},expand:function(){return this.getHiddenItems().show(),this.expander.remove()},collapse:function(){this.expander&&this.expander.remove();if(this.getItems().length>this.collapsedLength)return this.getHiddenItems().hide(),this.renderExpander()}},d=function(){function a(){a.__super__.constructor.apply(this,arguments)}return __extends(a,Backbone.View),a}(),a.include(d,c),{View:b,ExpandableListMixin:c,ExpandableList:d}})