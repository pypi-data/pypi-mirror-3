

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Add an import wizard to an application &mdash; Camelot  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Camelot  documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="index.html" />
    <link rel="next" title="Camelot Documentation" href="../doc/index.html" />
    <link rel="prev" title="Creating a Report with Camelot" href="reporting.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2652891-3']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../doc/index.html" title="Camelot Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reporting.html" title="Creating a Report with Camelot"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="add-an-import-wizard-to-an-application">
<span id="tutorial-importer"></span><h1>Add an import wizard to an application<a class="headerlink" href="#add-an-import-wizard-to-an-application" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial depends on functionallity under development in the trunk.
This functionallity is not yet available in the latest release.</p>
</div>
<p>In this tutorial we will add an import wizard to the movie database
application created in the <a class="reference internal" href="videostore.html#tutorial-videostore"><em>Creating a Movie Database Application</em></a> tutorial.</p>
<p>We assume Camelot is properly <a class="reference internal" href="../doc/install.html#doc-install"><em>installed</em></a> and the movie
database application is working.</p>
<img alt="../_images/main_window.png" src="../_images/main_window.png" />
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Most applications need a way to import data.  This data is often delivered
in files generated by another application or company.  To demonstrate this
process we will build a wizard that allows the user to import cover images
into the movie database.  For each image the user selects, a new Movie will
be created with the selected image as a cover image.</p>
</div>
<div class="section" id="create-an-action">
<h2>Create an action<a class="headerlink" href="#create-an-action" title="Permalink to this headline">¶</a></h2>
<p>All user interaction in Camelot is handled through <a class="reference internal" href="../doc/actions.html#doc-actions"><em>Actions</em></a>.  For
actions that run in the context of the application, we use the
<a class="reference internal" href="../doc/actions.html#doc-application-action"><em>Application Actions</em></a>.  We first create a file <tt class="file docutils literal"><span class="pre">importer.py</span></tt> in
the same directory as <tt class="file docutils literal"><span class="pre">application_admin.py</span></tt>.</p>
<p>In this file we create subclass of <a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.Action" title="camelot.admin.action.Action"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.Action</span></tt></a> which
will be the entry point of the import wizard:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">camelot.admin.action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">camelot.core.utils</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">ImportCovers</span><span class="p">(</span> <span class="n">Action</span> <span class="p">):</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Import cover images&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">model_run</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">model_context</span> <span class="p">):</span>
        <span class="k">yield</span>
</pre></div>
</div>
<p>So now we haven an <tt class="docutils literal"><span class="pre">ImportCovers</span></tt> action.  Such an action has a
<tt class="docutils literal"><span class="pre">verbose_name</span></tt> class attribute with the name of the action as shown to the
user.</p>
<p>The most important method of the action is the <tt class="docutils literal"><span class="pre">model_run</span></tt> method, which
will be triggered when the user clicks the action.  This method should be a
generator that yields an object whenever user interaction is required.
Everything that happens inside the <tt class="docutils literal"><span class="pre">model_run</span></tt> method happens in a different
thread than the GUI thread, so it will not block the GUI.</p>
</div>
<div class="section" id="add-the-action-to-the-gui">
<h2>Add the action to the GUI<a class="headerlink" href="#add-the-action-to-the-gui" title="Permalink to this headline">¶</a></h2>
<p>Now the user needs to be able to trigger the action.  We edit the
<tt class="file docutils literal"><span class="pre">application_admin.py</span></tt> file and make sure the <tt class="docutils literal"><span class="pre">ImportCoversAction</span></tt>
is imported.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="kn">from</span> <span class="nn">camelot_example.importer</span> <span class="kn">import</span> <span class="n">ImportCovers</span>
</pre></div>
</div>
<p>Then we add an instance of the <tt class="docutils literal"><span class="pre">ImportCovers</span></tt> action to the sections
defined in the <tt class="docutils literal"><span class="pre">get_sections</span></tt> method of the <tt class="docutils literal"><span class="pre">ApplicationAdmin</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>                <span class="n">Section</span><span class="p">(</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Movies&#39;</span><span class="p">),</span>
                         <span class="bp">self</span><span class="p">,</span>
                         <span class="n">Icon</span><span class="p">(</span><span class="s">&#39;tango/22x22/mimetypes/x-office-presentation.png&#39;</span><span class="p">),</span>
                         <span class="n">items</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Movie</span><span class="p">,</span> 
                                   <span class="n">Tag</span><span class="p">,</span> 
                                   <span class="n">VisitorReport</span><span class="p">,</span> 
                                   <span class="n">VisitorsPerDirector</span><span class="p">,</span>
                                   <span class="n">ImportCovers</span><span class="p">()</span> <span class="p">]),</span>
</pre></div>
</div>
<p>This will make sure the action pops up in the <strong>Movies</strong> section of the
application.</p>
<img alt="../_images/navigation_pane.png" src="../_images/navigation_pane.png" />
</div>
<div class="section" id="select-the-files">
<h2>Select the files<a class="headerlink" href="#select-the-files" title="Permalink to this headline">¶</a></h2>
<p>To make the action do something usefull, we will implement its <tt class="docutils literal"><span class="pre">model_run</span></tt>
method.  Inside the <tt class="docutils literal"><span class="pre">model_run</span></tt> method, we can <tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt> various
<a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.base.ActionStep" title="camelot.admin.action.base.ActionStep"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.base.ActionStep</span></tt></a> objects to the GUI.  An <tt class="docutils literal"><span class="pre">ActionStep</span></tt>
is a part of the action that requires user interaction (the user answering
a question).  The result of this interaction is returned by the
<tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt> statement.</p>
<p>To ask the user for a number of image files to import, we will pop up a file
selection dialog inside the <tt class="docutils literal"><span class="pre">model_run</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">model_run</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">model_context</span> <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">camelot.view.action_steps</span> <span class="kn">import</span> <span class="n">SelectFile</span><span class="p">,</span> <span class="n">UpdateProgress</span><span class="p">,</span> <span class="n">Refresh</span>
        
        <span class="n">select_image_files</span> <span class="o">=</span> <span class="n">SelectFile</span><span class="p">(</span> <span class="s">&#39;Image Files (*.png *.jpg);;All Files (*)&#39;</span> <span class="p">)</span>
        <span class="n">select_image_files</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">select_image_files</span>
        <span class="n">file_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">file_names</span> <span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt> statement returns a list of file names selected by
the user.</p>
<img alt="../_images/select_file.png" src="../_images/select_file.png" />
</div>
<div class="section" id="create-new-movies">
<h2>Create new movies<a class="headerlink" href="#create-new-movies" title="Permalink to this headline">¶</a></h2>
<p>First make sure the <tt class="docutils literal"><span class="pre">Movie</span></tt> class has an <a class="reference internal" href="../doc/documents.html#camelot.types.Image" title="camelot.types.Image"><tt class="xref py py-class docutils literal"><span class="pre">camelot.types.Image</span></tt></a> field
named <tt class="docutils literal"><span class="pre">cover</span></tt> which will store the image files.</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">cover</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">camelot</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s">&#39;covers&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Next we add to the <tt class="docutils literal"><span class="pre">model_run</span></tt> method the actual creation of new movies.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">orm</span>
        <span class="kn">from</span> <span class="nn">camelot_example.model</span> <span class="kn">import</span> <span class="n">Movie</span>
              
        <span class="n">movie_mapper</span> <span class="o">=</span> <span class="n">orm</span><span class="o">.</span><span class="n">class_mapper</span><span class="p">(</span> <span class="n">Movie</span> <span class="p">)</span>
        <span class="n">cover_property</span> <span class="o">=</span> <span class="n">movie_mapper</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span> <span class="s">&#39;cover&#39;</span> <span class="p">)</span>
        <span class="n">storage</span> <span class="o">=</span> <span class="n">cover_property</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">storage</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_names</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">UpdateProgress</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_count</span> <span class="p">)</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span> <span class="n">file_name</span> <span class="p">)</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">stored_file</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">checkin</span><span class="p">(</span> <span class="n">file_name</span> <span class="p">)</span>
            <span class="n">movie</span> <span class="o">=</span> <span class="n">Movie</span><span class="p">(</span> <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="p">)</span>
            <span class="n">movie</span><span class="o">.</span><span class="n">cover</span> <span class="o">=</span> <span class="n">stored_file</span>
            
        <span class="n">Movie</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>In this part of the code several things happen :</p>
<p><strong>Store the images</strong></p>
<p>In the first lines, we do some sqlalchemy magic to get access to the
<tt class="docutils literal"><span class="pre">storage</span></tt> attribute of the <tt class="docutils literal"><span class="pre">cover</span></tt> field.  This <tt class="docutils literal"><span class="pre">storage</span></tt> attribute
is of type <a class="reference internal" href="../doc/documents.html#camelot.core.files.storage.Storage" title="camelot.core.files.storage.Storage"><tt class="xref py py-class docutils literal"><span class="pre">camelot.core.files.storage.Storage</span></tt></a>.  The <tt class="docutils literal"><span class="pre">Storage</span></tt>
represents the files managed by Camelot.</p>
<p><strong>Create Movie objects</strong></p>
<p>Then for each file, a new <tt class="docutils literal"><span class="pre">Movie</span></tt> object is created with as title the
name of the file.  For the <tt class="docutils literal"><span class="pre">cover</span></tt> attribute, the file is checked in into
the <tt class="docutils literal"><span class="pre">Storage</span></tt>.  This actually means the file is copied from its original
directory to a directory managed by Camelot.</p>
<p><strong>Write to the database</strong></p>
<p>In the last line, the <tt class="docutils literal"><span class="pre">session</span></tt> is flushed and thus all changes are
written to the database.</p>
<p><strong>Keep the user informed</strong></p>
<p>For each movie imported, a <a class="reference internal" href="../api2/camelot.view.action_steps.html#camelot.view.action_steps.update_progress.UpdateProgress" title="camelot.view.action_steps.update_progress.UpdateProgress"><tt class="xref py py-class docutils literal"><span class="pre">camelot.view.action_steps.update_progress.UpdateProgress</span></tt></a>
object is <tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt> to the GUI to inform the user of the import progress.
Each time such an object is yielded, the progress bar is updated.</p>
<img alt="../_images/progress_dialog.png" src="../_images/progress_dialog.png" />
</div>
<div class="section" id="refresh-the-gui">
<h2>Refresh the GUI<a class="headerlink" href="#refresh-the-gui" title="Permalink to this headline">¶</a></h2>
<p>The last step of the <tt class="docutils literal"><span class="pre">model_run</span></tt> method will be to refresh the GUI.  So if
the user has the <tt class="docutils literal"><span class="pre">Movies</span></tt> table open when importing, this table will show the
newly created movies.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="k">yield</span> <span class="n">Refresh</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="result">
<h2>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<p>This is how the resulting <tt class="file docutils literal"><span class="pre">importer.py</span></tt> file looks like :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">camelot.admin.action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">camelot.core.utils</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">camelot.view.art</span> <span class="kn">import</span> <span class="n">Icon</span>

<span class="k">class</span> <span class="nc">ImportCovers</span><span class="p">(</span> <span class="n">Action</span> <span class="p">):</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Import cover images&#39;</span><span class="p">)</span>
    <span class="n">icon</span> <span class="o">=</span> <span class="n">Icon</span><span class="p">(</span><span class="s">&#39;tango/22x22/mimetypes/image-x-generic.png&#39;</span><span class="p">)</span>
    
<span class="c"># begin select files</span>
    <span class="k">def</span> <span class="nf">model_run</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">model_context</span> <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">camelot.view.action_steps</span> <span class="kn">import</span> <span class="n">SelectFile</span><span class="p">,</span> <span class="n">UpdateProgress</span><span class="p">,</span> <span class="n">Refresh</span>
        
        <span class="n">select_image_files</span> <span class="o">=</span> <span class="n">SelectFile</span><span class="p">(</span> <span class="s">&#39;Image Files (*.png *.jpg);;All Files (*)&#39;</span> <span class="p">)</span>
        <span class="n">select_image_files</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">select_image_files</span>
        <span class="n">file_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">file_names</span> <span class="p">)</span>
<span class="c"># end select files</span>
<span class="c"># begin create movies</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">orm</span>
        <span class="kn">from</span> <span class="nn">camelot_example.model</span> <span class="kn">import</span> <span class="n">Movie</span>
              
        <span class="n">movie_mapper</span> <span class="o">=</span> <span class="n">orm</span><span class="o">.</span><span class="n">class_mapper</span><span class="p">(</span> <span class="n">Movie</span> <span class="p">)</span>
        <span class="n">cover_property</span> <span class="o">=</span> <span class="n">movie_mapper</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span> <span class="s">&#39;cover&#39;</span> <span class="p">)</span>
        <span class="n">storage</span> <span class="o">=</span> <span class="n">cover_property</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">storage</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_names</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">UpdateProgress</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_count</span> <span class="p">)</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span> <span class="n">file_name</span> <span class="p">)</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">stored_file</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">checkin</span><span class="p">(</span> <span class="n">file_name</span> <span class="p">)</span>
            <span class="n">movie</span> <span class="o">=</span> <span class="n">Movie</span><span class="p">(</span> <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="p">)</span>
            <span class="n">movie</span><span class="o">.</span><span class="n">cover</span> <span class="o">=</span> <span class="n">stored_file</span>
            
        <span class="n">Movie</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="c"># end create movies</span>
<span class="c"># begin refresh</span>
        <span class="k">yield</span> <span class="n">Refresh</span><span class="p">()</span>
<span class="c"># end refresh</span>
</pre></div>
</div>
</div>
<div class="section" id="unit-tests">
<h2>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h2>
<p>Once an action works, its important to keep it working as the development of
the application continues.  One of the advantages of working with generators
for the user interaction, is that its easy to simulate the user interaction
towards the <tt class="xref py py-meth docutils literal"><span class="pre">model_run()</span></tt> method of the action.  This is done by using
the <tt class="xref py py-meth docutils literal"><span class="pre">send()</span></tt> method of the generator that is returned when calling
<tt class="xref py py-meth docutils literal"><span class="pre">model_run()</span></tt> :</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">test_example_application_action</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">camelot_example.importer</span> <span class="kn">import</span> <span class="n">ImportCovers</span>
        <span class="kn">from</span> <span class="nn">camelot_example.model</span> <span class="kn">import</span> <span class="n">Movie</span>
        <span class="c"># count the number of movies before the import</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="n">Movie</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="c"># create an import action</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">ImportCovers</span><span class="p">()</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">model_run</span><span class="p">(</span> <span class="bp">None</span> <span class="p">)</span>
        <span class="n">select_file</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span> <span class="n">select_file</span><span class="o">.</span><span class="n">single</span> <span class="p">)</span>
        <span class="c"># pretend the user selected a file</span>
        <span class="n">generator</span><span class="o">.</span><span class="n">send</span><span class="p">(</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;camelot_example&#39;</span><span class="p">,</span> <span class="s">&#39;media&#39;</span><span class="p">,</span> <span class="s">&#39;covers&#39;</span><span class="p">,</span> <span class="s">&#39;circus.jpg&#39;</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
        <span class="c"># continue the action till the end</span>
        <span class="nb">list</span><span class="p">(</span> <span class="n">generator</span> <span class="p">)</span>
        <span class="c"># a movie should be inserted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span> <span class="n">movies</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Movie</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>We went through the basics of the action framework Camelot :</p>
<blockquote>
<div><ul class="simple">
<li>Subclassing a <a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.Action" title="camelot.admin.action.Action"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.Action</span></tt></a>
class</li>
<li>Implementing the <tt class="docutils literal"><span class="pre">model_run</span></tt> method</li>
<li><tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt> <a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.base.ActionStep" title="camelot.admin.action.base.ActionStep"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.base.ActionStep</span></tt></a> objects to
interact with the user</li>
<li>Add the <a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.base.Action" title="camelot.admin.action.base.Action"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.base.Action</span></tt></a> object to a
<a class="reference internal" href="../api2/camelot.admin.html#camelot.admin.section.Section" title="camelot.admin.section.Section"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.section.Section</span></tt></a> in the side pane</li>
</ul>
</div></blockquote>
<p>More <a class="reference internal" href="../api2/camelot.admin.action.html#camelot.admin.action.base.ActionStep" title="camelot.admin.action.base.ActionStep"><tt class="xref py py-class docutils literal"><span class="pre">camelot.admin.action.base.ActionStep</span></tt></a> classes can be found in
the <a class="reference internal" href="../api2/camelot.view.action_steps.html#module-camelot.view.action_steps" title="camelot.view.action_steps"><tt class="xref py py-mod docutils literal"><span class="pre">camelot.view.action_steps</span></tt></a> module.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Add an import wizard to an application</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#create-an-action">Create an action</a></li>
<li><a class="reference internal" href="#add-the-action-to-the-gui">Add the action to the GUI</a></li>
<li><a class="reference internal" href="#select-the-files">Select the files</a></li>
<li><a class="reference internal" href="#create-new-movies">Create new movies</a></li>
<li><a class="reference internal" href="#refresh-the-gui">Refresh the GUI</a></li>
<li><a class="reference internal" href="#result">Result</a></li>
<li><a class="reference internal" href="#unit-tests">Unit tests</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reporting.html"
                        title="previous chapter">Creating a Report with Camelot</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../doc/index.html"
                        title="next chapter">Camelot Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/tutorial/importer.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../doc/index.html" title="Camelot Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="reporting.html" title="Creating a Report with Camelot"
             >previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>

<br/>
<a href="http://example.com/my_article.html#disqus_thread">Comments</a>
<br/>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /**
    * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
    */

  /** var disqus_developer = 1 **/

  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://camelot.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=camelot">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 2009 - 2011, Conceptive Engineering.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
<div class="footer">
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

<script type="text/javascript">
var disqus_shortname = 'camelot';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://disqus.com/forums/camelot/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



  </body>
</html>