<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="bg.solr">
<body>
    <metal:slot fill-slot="main">
        <fieldset>
            <legend>Solr Suche</legend>
            <form tal:attributes="action string:${context/absolute_url}/@@solr-search" method="get">
                Query: <input type="text" name="query:ustring:utf-8" size="60" maxlength="60" tal:attributes="value request/query|nothing" />
                <br/>
                Max hits: <input type="text" name="rows:int" size="4" maxlength="4" tal:attributes="value request/rows|string:10" />
                <br/>
                <input type="submit" value="Suchen" />
            </form>
        </fieldset>
        <tal:def condition="request/query | nothing"
                 define="result view/search">
            <div tal:condition="not: result/rows">
                No results
            </div>
            <dl tal:condition="result/rows"
                tal:define="hl result/highlighting|nothing;
                            rows result/rows">
                <div>
                    <span tal:replace="python: len(rows)" /> results
                </div>
                <tal:loop repeat="row rows">
                    <dt>

                    <span tal:content="repeat/row/number" />)
                    <a tal:condition="not: row/renderurl"
                       tal:attributes="href string:${context/absolute_url}/@@solr-view-hit?id=${row/id}"
                       tal:content="row/relpath" />
                    <a tal:condition="row/renderurl"
                       tal:attributes="href row/renderurl"
                       tal:content="row/relpath" />
                    (<span tal:define="filesize python: view.filesize(row['filesize'])" 
                           tal:replace="string:${row/mimetype}, ${row/tag}, ${row/created}, $filesize" />)

                    </dt> 
                    <dd class="result-item">
                        <ul>
                            <li 
                                tal:condition="hl"
                                tal:repeat="item python: hl[row['id']].get('text', ())"> 
                                <div tal:content="structure item" />
                            </li>
                        </ul>
                    </dd>
                </tal:loop>
            </dl>
        </tal:def>

    </metal:slot>
</body>
</html>

