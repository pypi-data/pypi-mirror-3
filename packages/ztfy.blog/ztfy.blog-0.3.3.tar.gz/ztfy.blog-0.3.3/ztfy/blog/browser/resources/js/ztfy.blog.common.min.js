(function(a){String.prototype.startsWith=function(d){var b=this.length;var c=d.length;if(b<c){return false}return(this.substr(0,c)==d)};String.prototype.endsWith=function(d){var b=this.length;var c=d.length;if(b<c){return false}return(this.substr(b-c)==d)};a.ZBlog={json:{getAddr:function(){var b=window.location.href;return b.substr(0,b.lastIndexOf("/")+1)},post:function(h,f,c,b,e){var g=a.ZBlog.json.getAddr();if(e){g+="/"+e}var d={url:g,type:"POST",method:h,params:f,success:c,error:b};a.jsonRpc(d)}},ajax:{check:function(b,c,d){if(typeof(b)=="undefined"){a.getScript(c,d)}else{d()}},getAddr:function(){var b=window.location.href;return b.substr(0,b.lastIndexOf("/")+1)},post:function(e,g,c,b,f){if(e.startsWith("http://")){var h=e}else{var h=a.ZBlog.ajax.getAddr()+e}var d={url:h,type:"POST",data:a.param(g,true),dataType:f||"json",success:c,error:b||a.ZBlog.ajax.error};a.ajax(d)},submit:function(g,e,h,c,b,f){if(e.startsWith("http://")){var i=e}else{var i=a.ZBlog.ajax.getAddr()+e}var d={url:i,type:"POST",iframe:true,data:h,dataType:f||"json",success:c,error:b||a.ZBlog.ajax.error};a(g).ajaxSubmit(d)},error:function(d,b,c){a.ZBlog.ajax.check(jAlert,"/--static--/ztfy.jqueryui/js/jquery-alerts.min.js",function(){jAlert(b+":\n\n"+c,a.ZBlog.I18n.ERROR_OCCURED,null)})}},loader:{div:null,start:function(d){d.empty();var b=a('<div class="loader"></div>').appendTo(d);var c=a('<img class="loading" src="/--static--/ztfy.blog/img/loading.gif" />').appendTo(b);a.ZBlog.loader.div=b},stop:function(){if(a.ZBlog.loader.div!=null){a.ZBlog.loader.div.replaceWith("");a.ZBlog.loader.div=null}}},dialog:{options:{expose:{maskId:"mask",color:"#ccc",opacity:0.6,zIndex:9998},api:true,oneInstance:false,closeOnClick:false,onBeforeLoad:function(){a.ZBlog.loader.start(this.getContent());this.getContent().load(a.ZBlog.dialog.dialogs[a.ZBlog.dialog.getCount()-1].src);if(a.browser.msie&&(a.browser.version<"7")){a("select").css("visibility","hidden")}},onClose:function(){a.ZBlog.dialog.onClose();if(a.browser.msie&&(a.browser.version<"7")){a("select").css("visibility","hidden")}}},dialogs:[],getCount:function(){return a.ZBlog.dialog.dialogs.length},getCurrent:function(){var b=a.ZBlog.dialog.getCount();return a("#dialog_"+b)},open:function(e){if(!a.ZBlog.dialog.dialogs){a.ZBlog.dialog.dialogs=new Array()}var c=a.ZBlog.dialog.getCount()+1;var f="dialog_"+c;var b={};var d={maskId:"mask",color:"#ccc",opacity:0.6,zIndex:a.ZBlog.dialog.options.expose.zIndex+c};a.extend(b,a.ZBlog.dialog.options,{expose:d});a.ZBlog.dialog.dialogs.push({src:e,body:a('<div class="overlay"></div>').attr("id",f).appendTo(a("body"))});a("#"+f).empty().overlay(b).load()},close:function(){var b=a.ZBlog.dialog.getCount();var c="dialog_"+b;a("#"+c).overlay().close()},onClose:function(){if(typeof(tinyMCE)!="undefined"){if(tinyMCE.activeEditor){tinyMCE.execCommand("mceRemoveControl",false,tinyMCE.activeEditor.id)}}a("BODY DIV:last").remove();a.ZBlog.dialog.dialogs.pop()}},properties:{switcher:function(b){a("DIV.properties DIV.switch").toggle()}}}})(jQuery);