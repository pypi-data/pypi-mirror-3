<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="bastionbanking">

<body>
  <div metal:fill-slot="main"
       tal:define="errors options/state/getErrors;
                   formaction python:context.service.formAction(request)">

      <h1><img src="" tal:attributes="src context/icon">&nbsp;<span tal:replace="context/title_or_id"/></h1>

      <a href=""
           class="link-parent"
           tal:define="parent_url python:context.navigationParent(context, template.getId())"
           tal:condition="parent_url"
           tal:attributes="href parent_url"
           i18n:translate="go_to_parent_url">Up one level</a>

      <fieldset tal:condition="python: formaction == 'thank'">

         <legend>Thank You</legend>

         <p>Thank you very much for your payment.</p>

      </fieldset>

      <fieldset tal:condition="python: formaction == 'rejected'">

         <legend>Rejected</legend>

         <p>Unfortunately there has been a problem with your payment.  Please try again.</p>

      </fieldset>

      <form action="" method="post" tal:attributes="action template/getId" 
            tal:condition="python: formaction in ('capture', 'rejected')">

          <img src="" alt="" tal:attributes="src context/serviceIcon"/>

          <div class="field"
               tal:define="error errors/amount|nothing;
                           Amount request/amount | nothing;"
               tal:attributes="class python:test(error, 'field error', 'field')">

             <label for="amount" i18n:translate="label_amount">Amount</label>

             <span class="fieldRequired" title="Required"
                   i18n:attributes="title"
                   i18n:translate="label_required">(Required)</span>

            <div class="formHelp" i18n:translate="help_amount">
               Enter the amount (including currency code).
            </div>

             <div tal:content="error">Validation error output</div>

             <input type="text" id="amount" name="amount" value="" size="12"
                    tal:attributes="value Amount;"/>

          </div>

          <div class="field"
               tal:define="error errors/reference|nothing;
                           Reference request/reference | nothing;"
               tal:attributes="class python:test(error, 'field error', 'field')">

             <label for="reference" i18n:translate="label_reference">Reference</label>

            <div class="formHelp" i18n:translate="help_retentions">
               Enter any transaction reference.
            </div>

             <div tal:content="error">Validation error output</div>

             <input type="text" id="reference" name="reference" value="" size="40"
                    tal:attributes="value Reference;"/>
          </div>

          <div class="formControls">
              <input type="submit" name="form.button.Pay" class="context" value=" Pay "/>
          </div>

          <input type="hidden" name="form.submitted" value="1"/>
      </form>

  </div>
 
</body>
</html>
