<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      
      <title>
    Sqlwidget
 &mdash; sqlkit v0.9.5.1 documentation</title>
      
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sqlkit.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="sqlkit v0.9.5.1 documentation" href="../index.html" />
        <link rel="up" title="Widgets" href="widgets.html" />
        <link rel="next" title="SqlMask" href="mask.html" />
        <link rel="prev" title="Widgets" href="widgets.html" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '0.9.5.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>


<!-- <link rel="stylesheet" href="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.css" type="text/css" /> -->
      <link rel="stylesheet" href="../_static/jMenu.jquery.css" type="text/css" />

      <!-- <script type="text/javascript" src="http://www.myjqueryplugins.com/plugins/jmenu/demo/jquery/jMenu.jquery.js"></script> -->

      <script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-18221996-2']);
	_gaq.push(['_trackPageview']);

	(function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

      </script>
      <script type="text/javascript" src="../_static/jMenu.jquery.js"></script>
      <script type="text/javascript">
	      $(document).ready(function(){
		      $("#jMenu").jMenu({
			      ulWidth : '150',
			      effects : {
				      effectSpeedOpen : 300,
				      effectSpeedClose : 300,
				      effectTypeOpen : 'slide',
				      effectTypeClose : 'slide',
				      effectOpen : 'linear',
				      effectClose : 'linear'
			      },
			      TimeBeforeOpening : 100,
			      TimeBeforeClosing : 400,
			      animatedText : false,
			      paddingLeft: 1		});
	      })
      </script>
<!-- Preview -->
     <script type="text/javascript" src="../_static/imgpreview.js"></script>
     <script type="text/javascript">
       $(document).ready(function(){
           $('.preview').imgPreview();
       });
     </script>
     
     <!--[if !IE 7]>
	     <style type="text/css">
		     #wrap {display:table;height:100%}
	     </style>
     <![endif]-->
    </head>
    <body>
        




<div id="wrap">
    
<div id="header">

	<div class="logo"><a href="../misc/tour.html">
       <img src="../_static/sqlkit.png" align="left"  alt="Logo" border="0"/></a>
        </div>
	<div id="description">Acces to db made easy</div>
</div>


   <div style="clear:left;"></div>


<div >
	<ul id="jMenu">
            <li><a class="fNiv" href="../index.html" title="Home" 
                  >Home</a></li>

            <li><a li class="fNiv" href="contents.html"
                  title="Sqlkit - the python package" 
                  >Sqlkit</a>

	       <ul>
		 <li ><a href="contents.html"
		       title="Sqlkit - the python package" 
		       >Sqlkit</a></li>

		 <li ><a href="#" title="Widgets" 
		       >Widgets</a>
		       <ul> 
			 <li ><a href="mask.html" title="Mask" 
			       >Mask view</a></li>
			 <li ><a href="table.html" title="Table" 
			       >Table view</a></li>
		       </ul>
                 </li>
		 <li ><a href="browsing.html" title="Browsing Data" 
		       >Browsing data</a>
		    <ul> 
		      <li ><a href="constraints.html" title="Constraints" 
			    >Constraints</a></li>
		      <li ><a href="filters.html" title="Filters" 
			    >Filters</a></li>
		      <li ><a href="totals.html" title="Totals" 
			    >Totals</a></li>
		    </ul>
                 </li>
		 <li ><a href="editing.html" title="Editing Data" 
		       >Editing data</a>
			 <ul> 
			   <li ><a href="completion.html" title="Completion" 
				 >Completion</a></li>
			   <li ><a href="validation.html" title="Validation" 
				 >Validation</a></li>
			   <li ><a href="relationship.html" title="Relationships" 
				 >Relationships</a></li>
			 </ul>
		       </li>
		 <li ><a href="printing.html" title="Printing" 
		       ><span>Printing</span></a></li>
		 <li ><a href="advanced/contents.html" title="Advanced configuration" 
		       >Advanced configuration</a>
			 <ul> 
			   <li ><a href="advanced/fields.html" title="Fields" 
				 >Fields</a></li>
			   <li ><a href="advanced/views.html" title="Views" 
				 >Views</a></li>
			 </ul>
		       </li>

	       </ul>
            </li>

            <li><a class="fNiv" href="../misc/sqledit.html"
                  title="Sqledit GUI" 
                  >Sqledit GUI</a></li>

            <li><a class="fNiv" href="../misc/tutorials.html"
                  title="Support & tutorials" 
                  >Support & Tutorials</a>
	       <ul>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Sqledit - the application</a></li>
		 <li ><a href="../misc/tour.html"
		       title="Sqlkit - the features'tour"
		       >Sqlkit - features' tour</a></li>
		 <li ><a href="../misc/sqledit.html"
		       title="Sqledit - the application" 
		       >Installing instructions</a></li>
		</ul> 
            </li>

            <li><a class="fNiv" href="../layout/contents.html" title="Layout"
                  >Layout</a></li>

            <li><a  class="fNiv"href="../misc/contents.html" title="Download" 
                  >Download</a>

	       <ul>
		 <li ><a href="../misc/contents.html"
		       title="Download"
		       >Download</a></li>
		 <li ><a href="http://sqlkit.argolinux.org/download/Changelog"  title="Changelog"
		       title="Changelog"
		       >Changelog</a></li>
		 <li ><a href="../misc/backward_incompatibilities.html"
		       title="Backward incompatibilities"
		       >Backward incompatibilities</a></li>
	       </ul>
            </li>



        </ul>
</div>
   <div style="clear:left;"></div>

    
    <div class="related">
      <ul>
	
<!-- <div class="prevnext"> -->
<!--    <li class="right"  style="margin-right: 10px">Indice -->
<!--      <a href="../genindex.html" title="Indice generale" -->
<!--                accesskey="I">indice</a></li> -->

        <li class="right">Prev:
        <a href="widgets.html" title="previous chapter">Widgets</a></li>
        <li class="right">Next:
        <a href="mask.html" title="next chapter">SqlMask</a></li>
<!-- </div> -->


      </ul>

    </div>

    
  <div class="sphinxsidebar">
     <div class="sphinxsidebarwrapper">


	    <div class="topnav">
    <h3>Table of contents</h3>
		    <ul>
<li><a class="reference external" href="#">Sqlwidget</a><ul>
<li><a class="reference external" href="#mandatory-argument">mandatory argument</a></li>
<li><a class="reference external" href="#main-options">main options</a><ul>
<li><a class="reference external" href="#dbproxy">dbproxy</a></li>
</ul>
</li>
<li><a class="reference external" href="#session-expire-on-commit">session &amp; expire_on_commit</a></li>
<li><a class="reference external" href="#attributes">Attributes</a></li>
<li><a class="reference external" href="#signals">Signals</a></li>
<li><a class="reference external" href="#hooks">Hooks</a><ul>
<li><a class="reference external" href="#hooks-for-related-widgets">Hooks for related widgets</a><ul>
<li><a class="reference external" href="#example">example</a></li>
</ul>
</li>
<li><a class="reference external" href="#registered-hooks-and-sessionetensions">Registered hooks and SessionEtensions</a></li>
<li><a class="reference external" href="#get-differences">get_differences</a></li>
</ul>
</li>
<li><a class="reference external" href="#saving-varchar-and-text-fields">Saving varchar and text fields</a></li>
<li><a class="reference external" href="#uimanager-menu-and-actions">UiManager: menu and actions</a><ul>
<li><a class="reference external" href="#changing-an-entry">Changing an entry</a></li>
<li><a class="reference external" href="#adding-an-entry">Adding an entry</a></li>
</ul>
</li>
</ul>
</li>
</ul>

		<div class="clearboth"></div>
	    </div>



    <h3>Questions?</h3>

    <p>Subscribe to out mailing list <a href="http://groups.google.com/group/sqlkit">
       Google group</a>:</p>

    <form action="http://groups.google.com/group/sqlkit/boxsubscribe" style="padding-left: 1em">
      <input type="text" name="email" value="your@email"/>
      <input type="submit" name="sub" value="Subscribe" />
    </form>
    <div id="searchbox" style="display: none">

    <h3>Quick search</h3>
	<form class="search" action="../search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />

	  <input type="hidden" name="area" value="default" />
	</form>
	<p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
	</p>
    <h3>License</h3>
	<img src="../_static/gplv3.png" alt="logo GPLv3">

    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>

     </div>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">

            <div class="body">
                
<div class="section" id="sqlwidget">
<h1>Sqlwidget<a class="headerlink" href="#sqlwidget" title="Permalink to this headline">¶</a></h1>
<p>This is the base class for <a class="reference external" href="mask.html#mask"><em>SqlMask</em></a> and <a class="reference external" href="table.html#table"><em>SqlTable</em></a> that implements the
common interface.</p>
<div class="section" id="mandatory-argument">
<h2>mandatory argument<a class="headerlink" href="#mandatory-argument" title="Permalink to this headline">¶</a></h2>
<p>The first and mandatory argument is the <tt class="docutils literal"><span class="pre">mapper</span></tt> of the object that will
be retrieved and displayed. Alternatively any other objects from which the
sqlwidget infers them (e.g.: the tablename and the metadata where the table
can be autoloaded):</p>
<ul class="simple">
<li>a mapper</li>
<li>a mapped class</li>
<li>table name (requires you also pass metadata)</li>
</ul>
<p>In older releases different options: <tt class="docutils literal"><span class="pre">class_</span></tt>, <tt class="docutils literal"><span class="pre">table</span></tt>, or <tt class="docutils literal"><span class="pre">mapper</span></tt>
where used. Now a DeprecationWarning is raised if you use those opts.</p>
</div>
<div class="section" id="main-options">
<h2>main options<a class="headerlink" href="#main-options" title="Permalink to this headline">¶</a></h2>
<p>Any sqlwidget needs a <tt class="docutils literal"><span class="pre">session</span></tt> as well.</p>
<p>Metadata is also used when auto-loading tables referenced by foreign keys to
display a better representation of the referenced record.</p>
<div class="section" id="dbproxy">
<span id="id1"></span><h3>dbproxy<a class="headerlink" href="#dbproxy" title="Permalink to this headline">¶</a></h3>
<p>Since a typical scenario is to have to provide a session different in each
SqlWidget and a metadata, an object is provided -<tt class="docutils literal"><span class="pre">dbproxy</span></tt>- that can be
initialized from the engine specification:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sqlkit.widgets</span> <span class="kn">import</span> <span class="n">SqlMask</span><span class="p">,</span> <span class="n">SqlTable</span>
<span class="kn">from</span> <span class="nn">sqlkit</span> <span class="kn">import</span> <span class="n">dbproxy</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">DbProxy</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&quot;sqlite:///model/movies.sqlite&quot;</span><span class="p">)</span>
<span class="n">SqlTable</span><span class="p">(</span><span class="s">&quot;movies&quot;</span><span class="p">,</span> <span class="n">dbproxy</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
</pre></div>
</div>
<p>below you can see some alternatives that would work as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">bind</span><span class="p">,</span> <span class="n">autocommit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">meta</span><span class="o">.</span><span class="n">bind</span> <span class="o">=</span> <span class="s">&quot;sqlite:///model/movies.sqlite&quot;</span>
<span class="c">#</span>
<span class="n">SqlTable</span><span class="p">(</span><span class="s">&quot;movies&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">sess</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>

<span class="c"># passing a mapped class (Movie here is build with declarative layer):</span>
<span class="c"># the metadata is found from the mapper.local_table.metadata</span>

<span class="n">SqlTable</span><span class="p">(</span><span class="n">Movies</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">sess</span><span class="p">)</span>
</pre></div>
</div>
<p>Session are created with  <tt class="docutils literal"><span class="pre">autoflush=False</span></tt>, <tt class="docutils literal"><span class="pre">expire_on_commit=False</span></tt> but
can be changed when building <tt class="docutils literal"><span class="pre">DbProxy</span></tt>.</p>
<p>Since version 0.8.6 default value for <em>autocommit</em> has been turned to  <em>True</em>
to prevent <a class="reference external" href="http://groups.google.it/group/sqlalchemy/browse_frm/thread/6abb815a3728d41c?hl=it&amp;tvc=1&amp;q=idle">idle in transaction</a> in postgresql.</p>
</div>
</div>
<div class="section" id="session-expire-on-commit">
<h2>session &amp; expire_on_commit<a class="headerlink" href="#session-expire-on-commit" title="Permalink to this headline">¶</a></h2>
<p>The reason to have <tt class="docutils literal"><span class="pre">expire_on_commit=False</span></tt> is that if you don&#8217;t set it,
after every commit, you have to reload all objects and the interface turns
very slow, especially when working with a remote database.</p>
<p><tt class="docutils literal"><span class="pre">expire_on_commit</span></tt> is a recent addition to sqlalchemy session (around sa
rel. 5.03rc) so I try it and fallback to default that would turn to be
slower. Previous 0.5 rel called it <tt class="docutils literal"><span class="pre">autoflush</span></tt></p>
<dl class="class">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget">
<em class="property">class </em><tt class="descclassname">sqlkit.widgets.common.sqlwidget.</tt><tt class="descname">SqlWidget</tt><big>(</big><em>see_below</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget" title="Permalink to this definition">¶</a></dt>
<dd><p>The main widget used to edit a table or sqlalchemy selectable, i.e. almost everything you can
express as table or for which you can provide a mapper or a mapped class.</p>
<p>You won&#8217;t use this as such: this is just the parent of SqlTable an SqlMask.</p>
<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.__init__">
<tt class="descname">__init__</tt><big>(</big><em>what=None</em>, <em>mapper=None</em>, <em>layout=None</em>, <em>layout_nick='default'</em>, <em>naked=False</em>, <em>geom=(-1</em>, <em>-1)</em>, <em>rows=10</em>, <em>addto=None</em>, <em>gui_field_mapping=None</em>, <em>title=None</em>, <em>show=True</em>, <em>icons=''</em>, <em>col_width=None</em>, <em>table=None</em>, <em>tables=None</em>, <em>class_=None</em>, <em>join=None</em>, <em>ro=False</em>, <em>noup=</em><span class="optional">[</span><span class="optional">]</span>, <em>sql=None</em>, <em>constraint={}</em>, <em>dbproxy=None</em>, <em>order_by=None</em>, <em>limit=200</em>, <em>field_list=None</em>, <em>session=None</em>, <em>metadata=None</em>, <em>ignore_fields=None</em>, <em>hide_fields=None</em>, <em>single=False</em>, <em>nick=None</em>, <em>about_dialog=None</em>, <em>dev=False</em>, <em>xml=False</em>, <em>relationship_mode='SINGLE'</em>, <em>relationship_path=None</em>, <em>relationship_leader=None</em>, <em>format=None</em>, <em>label_map=None</em>, <em>hooks=None</em>, <em>mode='biud'</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>what</em> &#8211; this is the table/mapper/class to be displayed. You are
encouraged to use it as first argument. The keyword &#8216;what&#8217; is
just here for backward compatibility as the first versiona had
different keywork for table/classes/mappers</li>
<li><em>table</em> &#8211; <p>the table to be edited. May be a string in which case it will
be autoloaded or a <cite>sqlalchemy.Table</cite> object. When using table argument
no info on relationship to other table are passed except those
contained in the Foreignkey, so you won&#8217;t be able to show one2many or
many2many relationships</p>
<p>If you pass 2 table as in <tt class="docutils literal"><span class="pre">movie</span> <span class="pre">director</span></tt> sqlkit will try to join
them and build a proper mapper.</p>
<p>This keyword is now <strong>deprecated</strong> and will disappear in future releases.
You are encouraged to use the table as first argument istead.</p>
</li>
<li><em>class_</em> &#8211; <p>a sqlalchemy mapped class (eg: that defined via declarative
layer). The mapper will be automatically found</p>
<p>This keyword is now <strong>deprecated</strong> and will disappear in future releases.
You are encouraged to use the class as first argument istead.</p>
</li>
<li><em>mapper</em> &#8211; <p>a mapper. All fields will be desumed by introspection</p>
<p>This keyword is now <strong>deprecated</strong> and will disappear in future releases.
You are encouraged to use the mapper as first argument istead.</p>
</li>
<li><em>session</em> &#8211; the session to be used</li>
<li><em>dbproxy</em> &#8211; a <a class="reference internal" href="#dbproxy"><em>dbproxy</em></a> object that holds info on metadata and can
create sessions</li>
<li><em>metadata</em> &#8211; a metadata object needed for introspection if reflection
is required</li>
<li><em>hooks</em> &#8211; the <a class="reference internal" href="#hooks"><em>Hooks</em></a> class to be used for this widget</li>
<li><em>ro=False</em> &#8211; if set to True the table is not updateable. Old way to set mode=&#8217;b&#8217;</li>
<li><em>mode</em> &#8211; mode for the widget. See <a class="reference internal" href="#set-mode"><em>set_mode</em></a> for more explanations</li>
<li><em>noup=[]</em> &#8211; a list of field names that will not be allowed to update. The list may be
also a string space or comma separated</li>
<li><em>order_by=None</em> &#8211; <p>order by column to be used when selecting. Can be</p>
<blockquote>
<ul>
<li>a list of sqlalchemy order_by clause elements</li>
<li>a string as would be  set in ordinary SQL statements</li>
<li>a string of fields as would be used in filters:
<tt class="docutils literal"><span class="pre">user_id__username</span></tt> (note the double_underscore). If you also have
a relation <tt class="docutils literal"><span class="pre">user</span></tt> that points to the same table you can use 
<tt class="docutils literal"><span class="pre">user__username</span></tt> with the same effect.</li>
</ul>
</blockquote>
</li>
<li><em>limit=200</em> &#8211; limit attribute to be used selecting</li>
<li><em>field_list=None</em> &#8211; a field_list to be shown. This can also be set via &#8220;set_field_list&#8221;. Operate
via toggling visibility of the columns in Tables or preventing
autogenerated layout to show.</li>
<li><em>ignore_fields = None</em> &#8211; field to be ignores (will be deleted from field list to field_list).
Can be a list or a comma  separated string.</li>
<li><em>hide_fields = None</em> &#8211; Only valid for SqlTable. List of columns to be hidden (but can be
interactively made to show up from menu). Can be a list or a comma
separated string.</li>
<li><em>single=False</em> &#8211; if a table is opened in single mode, destroying the table quits the gtk
main loop.</li>
<li><em>format=format_dict</em> &#8211; equivalent to using:  .set_format(format_dict).  See <a class="reference external" href="localization.html#localization"><em>Localization</em></a>
for more info</li>
<li><em>col_width</em> &#8211; a dictionary of field_name/width for columns (e.g: {&#8216;zip_code&#8217; : 6}). It
can be passed to masks also that will handle on to nested tables. In this
case if you have a relation with attribute &#8216;address&#8217; you may use: 
{&#8216;address.zip_code&#8217;: 6}</li>
<li><em>gui_field_mapping</em> &#8211; a dict that maps field names to Field classes. You
only need to set this for non persisted fields, i.e. field that are not
already defined in the mapper</li>
<li><em>title</em> &#8211; the title for the gtk.Window.</li>
<li><em>show</em> &#8211; a boolean to tell if the Window will be visible</li>
<li><em>dev</em> &#8211; if a sqlwidget is opened in dev mode and no field_list is passed, the
primary key is shown even if it&#8217;s  a serial, if it&#8217;s not in dev mode it
will be hidden</li>
<li><em>naked=False</em> &#8211; the table will be rendered without any buttons. It&#8217;s used in layout when
you want to add the table/mask to another layout (eg: in
relationships). Default: False.</li>
<li><em>addto=None</em> &#8211; if set must be a container to which the sqlwidget will be added</li>
<li><em>about_dialog</em> &#8211; Pass a dialog to invoke when info is called. A gtk.AboutDialog info will be
created by default if no about_dialog is passed</li>
<li><em>label_map</em> &#8211; argument:  label_map dictionary as explained in <a class="reference external" href="localization.html#localization"><em>Localization</em></a>
Adds a mapping between field_names and msgid/translation for gettext and
tooltips</li>
<li><em>layout</em> &#8211; string description of the layout as described in <a class="reference external" href="mask.html#mask"><em>SqlMask</em></a>. It&#8217;s used
to generate the layout for SqlMask also for table&#8217;s
<a class="reference external" href="table.html#recordinmask"><em>RecordInMask</em></a>.</li>
<li><em>layout_nick</em> &#8211; nick name of a layout to be used. Defaults to <tt class="docutils literal"><span class="pre">default</span></tt>. A layout can
be registered under a nick via <tt class="xref docutils literal"><span class="pre">register</span> <span class="pre">layout</span> </tt>
function</li>
<li><em>relationship_mode</em> &#8211; SINGLE, m2m, m2o, o2m</li>
<li><em>relationship_path</em> &#8211; the path needed to join two tables. See sqlalchemy on &#8216;quering
with joins&#8217;. Used by filter_panel to setup join condition when filtering
when relationship_mode is not SINGLE. May be a list or a string:
&#8216;genres&#8217;, &#8216;director nationality&#8217;, [&#8216;director&#8217;,&#8217;nationality&#8217;]</li>
<li><em>relationship_leader</em> &#8211; the main sqlmask (sqltable) that &#8220;owns&#8221; the filter_panel</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.add_constraint">
<tt class="descname">add_constraint</tt><big>(</big><em>OR=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.add_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Add <a class="reference external" href="constraints.html#constraints"><em>Constraints</em></a>. A constraint may be expressed via keyworks in django-like
syntax. Eg.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">name_like</span><span class="o">=</span><span class="s">&#39;uno%&#39;</span>
<span class="n">genres__name__regexp</span><span class="o">=</span><span class="s">&#39;sto&#39;</span>
<span class="n">director_id__birth_date__gte</span><span class="o">=</span><span class="s">&#39;1/1/1970&#39;</span>
</pre></div>
</div>
<p>if multiple conditions are passed, they will be ANDed unless &#8216;or_=True&#8217;</p>
<p>A constraint may also be build directly into the self.query object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>OR</em> &#8211; the condition will be ORed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.add_filter">
<tt class="descname">add_filter</tt><big>(</big><em>active=True</em>, <em>force_=True</em>, <em>**kw</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.add_filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>active</em> &#8211; boolean: make the filter active/inactive</td>
</tr>
</tbody>
</table>
<p>see <a class="reference external" href="filters.html#filters"><em>Filters</em></a> and <tt class="docutils literal"><span class="pre">add_constraint</span></tt> above. Note that filter are always 
ANDed (OR arameter is not available).</p>
<p>If you have a field_name named &#8216;active&#8217;, the active parameter will hide it. Use
keyword <tt class="docutils literal"><span class="pre">active__eq</span></tt> to bypass it.</p>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.resize">
<tt class="descname">resize</tt><big>(</big><em>width</em>, <em>height</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.resize" title="Permalink to this definition">¶</a></dt>
<dd>Resize the window. It accepts also -1 as value in which case sets
the current value, so it can be used to change just one dimention.</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.set_records">
<tt class="descname">set_records</tt><big>(</big><em>records=None</em>, <em>pk=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.set_records" title="Permalink to this definition">¶</a></dt>
<dd><p>set &#8216;records&#8217; as the list of record to manage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>records</em> &#8211; use &#8216;records&#8217;  as the list of records</li>
<li><em>pk</em> &#8211; use primary key pk as te pk to show (TODO make it work with composite pks)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.set_format">
<tt class="descname">set_format</tt><big>(</big><em>format_dict</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.set_format" title="Permalink to this definition">¶</a></dt>
<dd><p>set_format(format_dict). format_dict is a dictionary whose key is the
field_name and the value is the format of the column. Format_dict can
have keys that do not correspond to any field in the widget. That
makes it possible to reuse a format dict.</p>
<p>The format dict is passed to related widgets as well.</p>
<p>See <a class="reference external" href="localization.html#localization"><em>Localization</em></a> for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>format_dict</em> &#8211; a dict of field_name/format strings</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.is_mask">
<tt class="descname">is_mask</tt><big>(</big><em>obj=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.is_mask" title="Permalink to this definition">¶</a></dt>
<dd>Return True if the sqlwidget is a Sqlmask</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.is_table">
<tt class="descname">is_table</tt><big>(</big><em>obj=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.is_table" title="Permalink to this definition">¶</a></dt>
<dd>Return True if the sqlwidget is a SqlTable</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.sb">
<tt class="descname">sb</tt><big>(</big><em>text</em>, <em>seconds=10</em>, <em>delay=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.sb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write on the status bar if present in this  sqlwidget or in the <tt class="docutils literal"><span class="pre">relationship_leader</span></tt></p>
<p>Adds a message in the stack of messages of the status bar, and removes it
after seconds seconds. If delay=True it uses gobject.idle_add to give
more chance to be visible (not hidden by other automatic messages)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>text</em> &#8211; the text to be written</li>
<li><em>seconds</em> &#8211; how may seconds the text should stay visible</li>
<li><em>delay</em> &#8211; boolean. If True message is added in an idle cicle. It means it will be shown
after other possibly scheduled automatic messages that would hide its visibility.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.get_value">
<tt class="descname">get_value</tt><big>(</big><em>field_name</em>, <em>shown=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.get_value" title="Permalink to this definition">¶</a></dt>
<dd><p>return the value from the widget</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>field_name</em> &#8211; the field_name</li>
<li><em>shown</em> &#8211; boolean: in case field is a foreign key, <tt class="xref docutils literal"><span class="pre">True</span></tt> indicates we want the
dislayed value rather than the real one</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.set_value">
<tt class="descname">set_value</tt><big>(</big><em>field_name</em>, <em>field_value</em>, <em>fkvalue=None</em>, <em>initial=False</em>, <em>shown=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.set_value" title="Permalink to this definition">¶</a></dt>
<dd><p>set the value of any field present in <tt class="docutils literal"><span class="pre">gui_fields</span></tt>. Uses field.set_value
if <tt class="docutils literal"><span class="pre">initial</span></tt> is False, run <tt class="docutils literal"><span class="pre">on_change_value</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>field_name</em> &#8211; the field_name to be changed</li>
<li><em>field_value</em> &#8211; the new value</li>
<li><em>fkvalue</em> &#8211; a possible foreign key value. It&#8217;s here just  for compatibility with SqlTable&#8217;s one</li>
<li><em>initial</em> &#8211; a boolean indicating if it&#8217;s an initial value (passed to field)</li>
<li><em>shown</em> &#8211; a boolean indicating if the  value is the displayed value (passed to field)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.get_current_obj">
<tt class="descname">get_current_obj</tt><big>(</big><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.get_current_obj" title="Permalink to this definition">¶</a></dt>
<dd>Return the corrently edited obj. Note that in Table widgets,
selection can already be elsewhere (as in on_selection_change).</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.set_mode">
<tt class="descname">set_mode</tt><big>(</big><em>mode=None</em>, <em>reset=False</em>, <em>delay=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.set_mode" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" id="set-mode" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>mode</em> &#8211; the mode as explained below. If None, mode will be refreshed to last <em>declared</em>
state (i.e.: reguardless of what you may have changed by hand acting on actiongroups).</li>
<li><em>reset</em> &#8211; if True the mode will be completely reset. Needed to make the mode
of a related table independent from the mode of the master</li>
<li><em>delay</em> &#8211; if True, the mode is set but interface is not immediately updated</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Set mode for this widget. Mode can be a string composed with the following letters that
correspond to permissions possibly preceded by <tt class="docutils literal"><span class="pre">+</span></tt> or <tt class="docutils literal"><span class="pre">-</span></tt>.</p>
<blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">s:</th><td class="field-body">SELECT. The user can view the records <em>already selected</em>
(i.e. use Forward/Backward) or set by <tt class="docutils literal"><span class="pre">set_records</span></tt>. This is <em>always</em> granted and
as such it&#8217;s pointless to set it (or revoke it)</td>
</tr>
<tr class="field"><th class="field-name">i:</th><td class="field-body">INSERT. The user can insert new records</td>
</tr>
<tr class="field"><th class="field-name">u:</th><td class="field-body">UPDATE. The user can update records</td>
</tr>
<tr class="field"><th class="field-name">d:</th><td class="field-body">DELETE. The user can delete records</td>
</tr>
<tr class="field"><th class="field-name">b:</th><td class="field-body">browse. The user can use the filter panel</td>
</tr>
</tbody>
</table>
</blockquote>
<p>If mode start with + or - the following permissions are granted/revoked for the widget
by adding or removing from the modes already present. If no sign is used the mode is set.</p>
<p><tt class="docutils literal"><span class="pre">mode</span></tt> is a property, you can set it directly: <tt class="docutils literal"><span class="pre">self.mode</span> <span class="pre">=</span> <span class="pre">'b'</span></tt></p>
<p>The mode influences permission by setting menu entries active or not. It&#8217;s not acting on
the session. If an object has been inserted in the session a simple update operation
can let it be inserted. This is by design.</p>
<p>Related table inheritate the same mode but you can programmatically reset it and make it
independent from the master using option reset=True.</p>
<p><em>Implementation</em></p>
<p>Mode are implemented acting on uimanager/actionsgroup. You may read <a class="reference internal" href="#uimanager"><em>UiManager: menu and actions</em></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">at present it&#8217;s not possible to insert a record in a table that is not updatable</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.add_temporary_item">
<tt class="descname">add_temporary_item</tt><big>(</big><em>item</em>, <em>menu</em>, <em>position=0</em>, <em>separator=False</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.add_temporary_item" title="Permalink to this definition">¶</a></dt>
<dd><p id="add-temporary-item">Adds an action to a menu and removes it with &#8216;selection-done&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>item</em> &#8211; the gtk.MenuItem that must be added</li>
<li><em>menu</em> &#8211; the menu where the item needs to be added</li>
<li><em>position</em> &#8211; the position where to insert the item (default: 0)</li>
<li><em>separator</em> &#8211; boolean: add a separator (not implemented)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.reload">
<tt class="descname">reload</tt><big>(</big><em>limit=None</em>, <em>display=True</em>, <em>order_by=None</em>, <em>OR=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>reload the data from the database taking all filter/constraints into
consideration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>limit</em> &#8211; add a LIMIT clause (integer) to limit number of returned
records. Permanent effect</li>
<li><em>order_by</em> &#8211; reset order_by and apply when reloading. Permanent effect.</li>
<li><em>OR</em> &#8211; (boolean, default False) as in <tt class="docutils literal"><span class="pre">add_constraint</span></tt> you can specify if
conditions as in kwargs below should be ORed or ANDed (default)</li>
<li><em>kwargs</em> &#8211; any filters accepted by the <a class="reference external" href="constraints.html#django-syntax"><em>Django-like syntax</em></a> and by add_filter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>sql may be a tuple (sql_statement, bind_params) or just a sql_statement</p>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.commit">
<tt class="descname">commit</tt><big>(</big><em>message='Salvato'</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>run session.commit() and take care of possible exceptions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>message</em> &#8211; a message to be written in the status bar (default: Saved)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.add_validation_error">
<tt class="descname">add_validation_error</tt><big>(</big><em>error</em>, <em>field_name=None</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.add_validation_error" title="Permalink to this definition">¶</a></dt>
<dd><p>keep track of the error in self.validation_errors/validation_warnings
so that a further process can collect them and present them to the user</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>error</em> &#8211; the ValidationError or an error message string</td>
</tr>
<tr class="field"><th class="field-name">Field_name:</th><td class="field-body">the field_name to which the error refers. Defaults to &#8216;record validation&#8217;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.widgets.common.sqlwidget.SqlWidget.add_not_null_error">
<tt class="descname">add_not_null_error</tt><big>(</big><em>field_name</em><big>)</big><a class="headerlink" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.add_not_null_error" title="Permalink to this definition">¶</a></dt>
<dd><p>simple way to add a not nullable field error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>field_name</em> &#8211; the field_name that cannot be nullable</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="filter_panel">
<tt class="descname">filter_panel</tt><a class="headerlink" href="#filter_panel" title="Permalink to this definition">¶</a></dt>
<dd>The <a class="reference external" href="filters.html#filter-panel"><em>FilterPanel</em></a> widget</dd></dl>

<dl class="attribute">
<dt id="related">
<tt class="descname">related</tt><a class="headerlink" href="#related" title="Permalink to this definition">¶</a></dt>
<dd><p>a container for all related sqlwidgets (i.e.: SqlWidgets that have a
relation with this sqlwidget defined by sqlalchemy and that are
displayed in the widget).</p>
<p>This is used in all situation in which you need to fine-tune the
configuration of a related table (completion, layout, ...)</p>
</dd></dl>

<dl class="attribute">
<dt id="completions">
<tt class="descname">completions</tt><a class="headerlink" href="#completions" title="Permalink to this definition">¶</a></dt>
<dd>a container of all completion objects. Needed to change the behavior of
some completion (see <a class="reference external" href="completion.html#completion"><em>Completion</em></a>)</dd></dl>

<dl class="attribute">
<dt id="gui_fields">
<tt class="descname">gui_fields</tt><a class="headerlink" href="#gui_fields" title="Permalink to this definition">¶</a></dt>
<dd>a container for all validation fields. A validation fields is an object
that lives in <tt class="docutils literal"><span class="pre">sqlkit.fields</span></tt> and that knows how to represent a field
and how to validate it.</dd></dl>

<dl class="attribute">
<dt id="gui_field_mapping">
<tt class="descname">gui_field_mapping</tt><a class="headerlink" href="#gui_field_mapping" title="Permalink to this definition">¶</a></dt>
<dd>A dict used to force a map between a <tt class="docutils literal"><span class="pre">sqlkit.Field</span></tt> and a gui
field. Read more in <a class="reference external" href="advanced/fields.html#fields"><em>Fields</em></a>.</dd></dl>

<dl class="attribute">
<dt id="query">
<tt class="descname">query</tt><a class="headerlink" href="#query" title="Permalink to this definition">¶</a></dt>
<dd>the sqlalchemy query object (<tt class="docutils literal"><span class="pre">session.query(mapper)</span></tt>) with all
constraints applied. Can be manipulated as necessary as long as it stay a
query object.</dd></dl>

<dl class="attribute">
<dt id="layout">
<tt class="descname">layout</tt><a class="headerlink" href="#layout" title="Permalink to this definition">¶</a></dt>
<dd><p>the layout definition for this SqlWidget. This is the used definition for
SqlMask while for SqlTable is only used if the record is opened in SqlMask
(right click on the record in SqlTable).</p>
<p>You can also set it on a related table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GUI</span><span class="o">=</span><span class="s">&quot;director @ m2m=movies&quot;</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">SqlMask</span><span class="p">(</span><span class="n">Director</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">GUI</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">related</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;title @ m2m=actors&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="lay_obj">
<tt class="descname">lay_obj</tt><a class="headerlink" href="#lay_obj" title="Permalink to this definition">¶</a></dt>
<dd>the sqlkit.layout.Layout object used to create the layout</dd></dl>

<dl class="attribute">
<dt id="current">
<tt class="descname">current</tt><a class="headerlink" href="#current" title="Permalink to this definition">¶</a></dt>
<dd>the object represented by a mask or a possible selected record in a table
or None. In <a title="sqlkit.widgets.SqlTable" class="reference external" href="table.html#sqlkit.widgets.SqlTable"><tt class="xref docutils literal"><span class="pre">SqlTable</span></tt></a> in the transient
in which you are saving a record in a table (when selection changes)
<tt class="docutils literal"><span class="pre">self.current</span></tt> will point to the obj that is to be saved (while the
selected object may already be another one).</dd></dl>

<dl class="attribute">
<dt id="field_list">
<tt class="descname">field_list</tt><a class="headerlink" href="#field_list" title="Permalink to this definition">¶</a></dt>
<dd>a list of the field names the GUI is handling. It comprises
PropertyLoaders (i.e. properties of the class that act as a loader of
other info - all relation are seen as PropertLoaders w/o column)</dd></dl>

<dl class="attribute">
<dt id="order_by">
<tt class="descname">order_by</tt><a class="headerlink" href="#order_by" title="Permalink to this definition">¶</a></dt>
<dd>an order_by string or clause element. Same as parameter passed to the
class. It&#8217;s a property, can be set in any moment.</dd></dl>

<dl class="attribute">
<dt id="session">
<tt class="descname">session</tt><a class="headerlink" href="#session" title="Permalink to this definition">¶</a></dt>
<dd>the sqlalchemy session used for querying</dd></dl>

<dl class="attribute">
<dt id="defaults">
<tt class="descname">defaults</tt><a class="headerlink" href="#defaults" title="Permalink to this definition">¶</a></dt>
<dd>an instance of <tt class="docutils literal"><span class="pre">sqlkit.db.defaults.Defauls</span></tt> instantiated with
local=True as explained in <a class="reference external" href="defaults.html#local-defaults"><em>Defaults local to the application</em></a>. Any default set with
this instance will only be visible in this sqlwidget.</dd></dl>

<dl class="attribute">
<dt id="title">
<tt class="descname">title</tt><a class="headerlink" href="#title" title="Permalink to this definition">¶</a></dt>
<dd>the title of the Window.</dd></dl>

<dl class="attribute">
<dt id="mode">
<tt class="descname">mode</tt><a class="headerlink" href="#mode" title="Permalink to this definition">¶</a></dt>
<dd>the mode describing permissions of the widget. See <a class="reference internal" href="#set-mode"><em>set_mode</em></a></dd></dl>

<dl class="attribute">
<dt id="noup">
<tt class="descname">noup</tt><a class="headerlink" href="#noup" title="Permalink to this definition">¶</a></dt>
<dd><p>noup can be a set of field_name or a comma separated string with possible +- sign
to add/remove field_names to the set of field_names that will not be possible to update</p>
<p>Note that to add a non editable field_name you must used &#8216;+field_name&#8217;. Using simply &#8216;field_name&#8217;
will reset the list to only  that field_name</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">actiongroup_*</tt></dt>
<dd>see <a class="reference internal" href="#uimanager"><em>UiManager: menu and actions</em></a></dd></dl>

<dl class="attribute">
<dt id="ui_manager">
<tt class="descname">ui_manager</tt><a class="headerlink" href="#ui_manager" title="Permalink to this definition">¶</a></dt>
<dd>see <a class="reference internal" href="#uimanager"><em>UiManager: menu and actions</em></a></dd></dl>

<dl class="attribute">
<dt id="relationship_leader">
<tt class="descname">relationship_leader</tt><a class="headerlink" href="#relationship_leader" title="Permalink to this definition">¶</a></dt>
<dd>Th case this sqlwidget is representing a relation of a SqlMask, that
SqlMask is referred to as a relationship_leader.</dd></dl>

</div>
<div class="section" id="signals">
<span id="id2"></span><h2>Signals<a class="headerlink" href="#signals" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">pre-display:</th><td class="field-body"><p class="first">A record is about to be displayed.</p>
<dl class="function">
<dt>
<tt class="descname">pre_display_cb(sqlwidget, obj):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the widget that emitted the signal</li>
<li><em>obj</em> &#8211; the object that is about to be displayed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">record-selected:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">A record has been displayed in Mask or selected in Table.
The callback will just receive the widget as argument.</p>
<dl class="function">
<dt>
<tt class="descname">records_selected_cb(sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the widget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">record-saved:</th><td class="field-body"><p class="first">A record has been saved. This signal is <em>not</em> emitted from within session
extension. That means you are sure there will be just one signal for each
button press on &#8220;save&#8221; button. This is issued from within the <tt class="xref docutils literal"><span class="pre">SqlWidget.commit()</span></tt>
method independently from the fact that a real modification occurred, so
you are not guaranteed any modification took place. Was originally added
to implement a destroy of the widget when the save operation was performed.</p>
<p>The callback will just receive the widget as argument.</p>
<dl class="function">
<dt>
<tt class="descname">record_saved_cb(sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the widget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">record-new:</th><td class="field-body"><p class="first">A new record has been added.
The callback will just receive the widget as argument.</p>
<dl class="function">
<dt>
<tt class="descname">record_new_cb(sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the widget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">record-deleted:</th><td class="field-body"><p class="first">A record has been deleted.
The callback will receive the widget and the obj.</p>
<dl class="function">
<dt>
<tt class="descname">record_new_cb(sqlwidget, deleted_obj):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the widget that emitted the signal</li>
<li><em>deleted_obj</em> &#8211; the obje that was deleted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Note that this signal is emitted only for records deleted explicitly,
i.e. records that where the <tt class="docutils literal"><span class="pre">current</span> <span class="pre">record</span></tt> in a mask/table. If a
record is deleted as a side effect (e.g.: becouse cascade=&#8221;delete-orphan&#8221;
is set) no signal is emitted for that obj.</p>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">records-displayed:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Records have been displayed. This may be after <tt class="xref docutils literal"><span class="pre">SqlWidget.reload()</span></tt>
or <tt class="xref docutils literal"><span class="pre">SqlWidget.set_records()</span></tt>.
The callback will just receive the widget as argument.
See also <a class="reference external" href="table.html#context-changed"><em>context changed</em></a> to see another signal
that better tracks <em>any</em> change</p>
<dl class="function">
<dt>
<tt class="descname">records_displayed_cb(sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the widget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">after-flush:</th><td class="field-body"><p class="first">flush has occurred, normally commit should not add any errors. This is
implemented with a SessionExtension: if you used the default session
obtained via get_session() you are assured that it will be correct. If you
create a session by yourself, be sure to add <tt class="docutils literal"><span class="pre">sqlkit.db.proxy.SKSessionExtension</span></tt> to the
session extensions or you won&#8217;t have this signal. Read more detailed
explanation in <a class="reference internal" href="#on-after-flush"><em>hook on_after_flush</em></a></p>
<dl class="function">
<dt id="after_flush_callback">
<tt class="descname">after_flush_callback</tt><big>(</big><em>sqlwidget</em>, <em>object</em>, <em>session</em><big>)</big><a class="headerlink" href="#after_flush_callback" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the sqlwidget that emitted the signal</li>
<li><em>object</em> &#8211; the object that was <em>current</em> when session was
flushed. Current means that it was the main object represented. Many
other widgets may be present, possibly in &#8220;dirty state&#8221;, &#8220;new&#8221; or
&#8220;deleted&#8221;, but current was the one selected in a table or displayed in
the main mask</li>
<li><em>session</em> &#8211; the session that was flushed. The moment in which the signal is
emitted you can still dig into <tt class="docutils literal"><span class="pre">session.dirty</span></tt>, <tt class="docutils literal"><span class="pre">session.new</span></tt>
and <tt class="docutils literal"><span class="pre">session.deleted</span></tt> and find which attributes have been changed
(you may want to use <a title="get_differences" class="reference internal" href="#get_differences"><tt class="xref docutils literal"><span class="pre">get_differences()</span></tt></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">after-commit:</th><td class="field-body"><p class="first">run from within <tt class="docutils literal"><span class="pre">after-commit</span></tt> SessionExtension. Callback signature is
identical to <tt class="docutils literal"><span class="pre">after_flush_callback</span></tt> above.</p>
</td>
</tr>
<tr class="field"><th class="field-name">delete-event:</th><td class="field-body"><p class="first">emitted when the sqlwidget is destroyed</p>
<dl class="last function">
<dt id="delete_event_callback">
<tt class="descname">delete_event_callback</tt><big>(</big><em>sqlwidget</em><big>)</big><a class="headerlink" href="#delete_event_callback" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the sqlwidget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hooks">
<span id="id3"></span><h2>Hooks<a class="headerlink" href="#hooks" title="Permalink to this headline">¶</a></h2>
<p>Beside signals there is another way to add controls: hooks. A hook is a
function that will be called in particular moments only if present.</p>
<p>Hooks are the main way to customize the behavior of a sqlwidget.  Some of
the hooks (<tt class="docutils literal"><span class="pre">on_validation.*</span></tt>) are related to validation other are related
to configuration (<tt class="docutils literal"><span class="pre">on</span> <span class="pre">init</span></tt>), others (<tt class="docutils literal"><span class="pre">on_activate</span></tt>) may be used to save
typing.</p>
<p>Hooks are searched for in the methods of the instance of a class declared in
the optional <tt class="docutils literal"><span class="pre">hooks</span></tt> argument or in the global registered hooks (see below).</p>
<p>Hooks can be <em>registered</em> using <a title="sqlkit.db.utils.register_hook" class="reference external" href="advanced/dbutils.html#sqlkit.db.utils.register_hook"><tt class="xref docutils literal"><span class="pre">sqlkit.db.utils.register_hook()</span></tt></a> (and
<a title="sqlkit.db.utils.get_hook" class="reference external" href="advanced/dbutils.html#sqlkit.db.utils.get_hook"><tt class="xref docutils literal"><span class="pre">get_hook</span> </tt></a> from <a class="reference external" href="advanced/dbutils.html#dbutils"><em>utils</em></a> module)
so that any sqlwidget built on that table will use those hooks (unless the
table is part of a join or another selectable!!). The advantage is that
browsing data (e.g. using right click on a table row) can lead to opening
tables that are not configured: registering hooks is a way to enforce
configuration (and possibly constraints) on any widget.</p>
<p>As layout hooks can be registered with a nick (default is <tt class="docutils literal"><span class="pre">default</span></tt>) so
that you can register different hooks for different editing flavors. E.g/:
you can have a table for <em>people</em> and you can decide to open it with <em>customer</em>
or <em>provider</em> layout/hooks just registering both layout and hooks and using
argument <tt class="docutils literal"><span class="pre">layout_nick</span></tt>.</p>
<p>Use it with care as it may lead in situation in which not all fields are
present (due e.g. to a different layout or different field_list)</p>
<p>The following hooks are defined:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">on_change_value__field_name:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">this hook is used to trace <em>changes</em> in the
widget. It&#8217;s mainly meant to be used interactively but it is also
triggered when <a title="sqlkit.widgets.common.sqlwidget.SqlWidget.set_value" class="reference internal" href="#sqlkit.widgets.common.sqlwidget.SqlWidget.set_value"><tt class="xref docutils literal"><span class="pre">set_value</span></tt></a> is invoked with
initial=False. It&#8217;s <strong>not</strong> changed if the value is set on record
change.</p>
<p>Currently it behaves differently for Table widgets or Mask widgets.</p>
<p>Mask widgets invoke it each meaningful changes i.e. each char for
varchar/int field, each time a value is choosen for enum/foreign key
fields,  when a date is selected or validated for Date widgets.</p>
<p>Table widgets invoke this hook only when the field is leaved or
activated (Return is pressed).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Implementation of this hooks is currently limited to some
fields: Varchar, Int, Float, Numeric, Enum, ForeignKey, Date,
DateTime, Bool. Text, Images, Time and Interval are not
implemented. Example 63c is a complete example that shows it.</p>
</div>
<dl class="last function">
<dt>
<tt class="descname">on_change_value__field_name(sqlwidget, field_name, value,</tt></dt>
<dt>
<tt class="descname">fkvalue, field)</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that runs the hook</li>
<li><em>field_name</em> &#8211; the field_name</li>
<li><em>value</em> &#8211; the new value</li>
<li><em>fkvalue</em> &#8211; if field is a ForeignKey or enum, the displayed value</li>
<li><em>field</em> &#8211; the field</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" id="on-completion" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">on_completion__field_name:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">called when a completion
is chosen</p>
<dl class="last function">
<dt id="on_completion__field_name">
<tt class="descname">on_completion__field_name</tt><big>(</big><em>sqlwidget</em>, <em>field_name</em>, <em>obj</em><big>)</big><a class="headerlink" href="#on_completion__field_name" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that runs the hook</li>
<li><em>field_name</em> &#8211; the field_name</li>
<li><em>obj</em> &#8211; <p>the matched object in the completion. This obj has
attributes for each <em>field_name</em> named in <a title="sqlkit.widgets.common.completion.SimpleCompletion.attrs" class="reference external" href="completion.html#sqlkit.widgets.common.completion.SimpleCompletion.attrs"><tt class="xref docutils literal"><span class="pre">attrs</span></tt></a>
attribute of the completion. You can add field_names to
that attribute if you need them in this hook function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sqlwidget</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">director_id</span><span class="o">.</span><span class="n">attrs</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;nation&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>allows you to add a completion hook:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">on_completion__director_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sqlwidget</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">obj</span><span class="o">.</span><span class="n">nation</span>
    <span class="n">sqlwidget</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">&#39;nation&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">nation</span><span class="p">)</span>
</pre></div>
</div>
<p>you can also reach field attributes as dict values: obj[&#8216;nation&#8217;].</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" id="on-save-as" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">save_as:</th><td class="field-body"><p class="first">
<span class="versionmodified">New in version 0.9.3.</span></p>
<p>this hook is invoked each time a record is saved as a duplicate of
another one. After the new record is filled and before it&#8217;s saved you
can customize at your will. Callback function:</p>
<dl class="function">
<dt>
<tt class="descname">on_save_as(sqlwidget, old, new):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the mask/table that invoked the hook</li>
<li><em>old</em> &#8211; the old object that was copied</li>
<li><em>new</em> &#8211; the new object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>When this hook is present, no warning on how the copy is handled is
raised as it&#8217;s considered that the programmer has already coped with
all the tricky issues.</p>
</td>
</tr>
<tr class="field"><th class="field-name">on_validation:</th><td class="field-body"><p class="first">called when all the values have been collected in the object,
before calling validation on all fields and related widgets. That&#8217;s a
good point to implement any procedure to add automatism&#8217;s. Within this
hook you can propagate errors to the validation machinery in two of ways:</p>
<ol class="arabic simple">
<li>raising <tt class="docutils literal"><span class="pre">sqlkit.exc.ValidationError</span></tt>. Simple when just one error is
found</li>
<li>filling self.validation_errors: a dict holding all errors. The <em>key</em> is
the field_name or &#8220;record_validation&#8221;, the value a list of error messages</li>
</ol>
<dl class="last function">
<dt id="on_validation">
<tt class="descname">on_validation</tt><big>(</big><em>sqlwidget</em><big>)</big><a class="headerlink" href="#on_validation" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that run the hook</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" id="on-field-validation" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">on_field_validation__field_name:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">called to validate a single field
as for the previous <tt class="docutils literal"><span class="pre">on_validation</span></tt>. This is called from within the
<a title="sqlkit.fields.Field.validate" class="reference external" href="advanced/fields.html#sqlkit.fields.Field.validate"><tt class="xref docutils literal"><span class="pre">field's</span> <span class="pre">validation</span> <span class="pre">method</span></tt></a></p>
<ol class="arabic simple">
<li>raising <tt class="docutils literal"><span class="pre">sqlkit.exc.ValidationError</span></tt>. Simple when just one error is
found</li>
<li>filling self.validation_errors: a dict holding all errors. The key is
the field_name or &#8220;record_validation&#8221;, the value a list of error messages</li>
</ol>
<dl class="function">
<dt>
<tt class="descname">on_validation</tt><big>(</big><em>sqlwidget</em>, <em>field_name</em>, <em>field_value</em>, <em>field</em><big>)</big></dt>
<dd></dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">on_activate__field_name:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">when <em>Return</em> is pressed in Mask or Table. Good to
complete fields via calculation on other fields (e.g.: total, vat...).
The name derive from the GTK name &#8216;activate&#8217; that is when you press
&#8216;Return&#8217; in an entry, even thought in a Table&#8217;s treeview it&#8217;s really
connected to the cell&#8217;s <tt class="docutils literal"><span class="pre">edited</span></tt> signal (limited to Varchar and
Numeric columns).</p>
<dl class="function">
<dt id="on_activate__field_name">
<tt class="descname">on_activate__field_name</tt><big>(</big><em>sqlwidget</em>, <em>field_name</em>, <em>field</em><big>)</big><a class="headerlink" href="#on_activate__field_name" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that run the hook</li>
<li><em>field_name</em> &#8211; the field_name</li>
<li><em>field</em> &#8211; the <tt class="docutils literal"><span class="pre">sqlkit.widgets.common.field</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name">on_init:</th><td class="field-body"><p class="first">run as the last command of __init__. It&#8217;s main purpose is to
allow to configure a widget in a way that will be handed over to a
possible SqlMask generated right-clicking from a table row (see <a class="reference external" href="table.html#recordinmask"><em>RecordInMask</em></a>).</p>
<dl class="last function">
<dt id="on_init">
<tt class="descname">on_init</tt><big>(</big><em>sqlwidget</em><big>)</big><a class="headerlink" href="#on_init" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that run the hook</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" id="on-pre-layout" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">on_pre_layout:</th><td class="field-body"><p class="first">run before the layout is setup. It&#8217;s main purpose is to
allow to add fields in <a title="gui_field_mapping" class="reference internal" href="#gui_field_mapping"><tt class="xref docutils literal"><span class="pre">gui_field_mapping</span></tt></a> (that is only useful for
SqlMask). Note that you can force a field for a table&#8217;s attribute if you
want setting info&#8217;s <em>field</em> key pointing to that field&#8217;s class.</p>
<dl class="last function">
<dt>
<tt class="descname">on_init</tt><big>(</big><em>sqlwidget</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the sqlwidget (SqlMask or SqlTable) that run the hook</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Hooks invoked within the session extensions</strong></p>
<p class="last">The hooks that are called from within the session extensions, can be
called <strong>several times</strong> if there are more sqlwigets sharing the same
session (that happens for example each time you open a mask to edit
the row of a table i.e.: <a class="reference external" href="table.html#recordinmask"><em>RecordInMask</em></a>)</p>
</div>
<table class="docutils field-list" frame="void" id="on-after-flush" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">on_after_flush:</th><td class="field-body"><p class="first">run as the signal with the same name from within <tt class="docutils literal"><span class="pre">after_flush</span></tt>
session extension method.</p>
<p>This hook is completely similar to <tt class="docutils literal"><span class="pre">after-flush</span></tt> signal, but is meant
to be defined in a separate class so that it&#8217;s easier to propagate
validation hooks to a spawned child (i.e.: <a class="reference external" href="table.html#recordinmask"><em>RecordInMask</em></a>, when
opening a mask by right clicking on a table record). You&#8217;ll see that
<tt class="docutils literal"><span class="pre">on_after_flush</span></tt> is called eather.</p>
<p>From the sqlalchemy documentation: &#8220;Note that the session&#8217;s state is
still in pre-flush, i.e. <em>new</em>, <em>dirty</em>, and <em>deleted</em> lists still
show pre-flush state as well as the history settings on instance
attributes&#8221;. This is true for <em>after_commit</em> hook as well, it is not true
for <em>after_flush_postexec</em>, that on the other had has already setup
relation.</p>
<p>I end up in some circumstances to split the callback in two phases: one
that detects if an action is needed from within the
after_flush/after_commit phase, the second (may be a mail, or any other
action) from within the <a class="reference internal" href="#on-record-saved"><em>hook on_record_saved</em></a>,
so that I can use the relations. Beware that you may have one call to
<tt class="docutils literal"><span class="pre">on_after_flush</span></tt> and more different calls to <tt class="docutils literal"><span class="pre">on_after_commit</span></tt></p>
<dl class="function">
<dt id="on_after_flush_callback">
<tt class="descname">on_after_flush_callback</tt><big>(</big><em>sqlwidget</em>, <em>object</em>, <em>session</em><big>)</big><a class="headerlink" href="#on_after_flush_callback" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>sqlwidget</em> &#8211; the sqlwidget that emitted the signal</li>
<li><em>object</em> &#8211; the object that was <em>current</em> when session was
flushed. Current means that it was the main object represented. Many
other widgets may be present, possibly in &#8220;dirty state&#8221;, &#8220;new&#8221; or
&#8220;deleted&#8221;, but current was the one selected in a table or displayed in
the main mask</li>
<li><em>session</em> &#8211; the session that was flushed. The moment in which the signal is
emitted you can still dig into <tt class="docutils literal"><span class="pre">session.dirty</span></tt>, <tt class="docutils literal"><span class="pre">session.new</span></tt>
and <tt class="docutils literal"><span class="pre">session.deleted</span></tt> and find which attributes have been changed
(you may want to use <cite>get_differences</cite>), but you won&#8217;t have
correctly setup relation&#8217;s object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">on_after_flush_postexec:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">run as the signal with the same name from within
<tt class="docutils literal"><span class="pre">after_flush_postexec</span></tt> session extension method.</p>
<p>As in the precedent hook this is called exactly within the session
extension method by the same name. When it&#8217;s run the session will have
no longer information on session.dirty/session.new/session.delete but
will have all relations set-up.</p>
<p>The callback has the same signature as for <a class="reference internal" href="#on-after-flush"><em>hook on_after_flush</em></a></p>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">on_after_commit:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">run after commit
after_commit session extension method</p>
<p class="last">The callback has the same signature as for <a class="reference internal" href="#on-after-flush"><em>hook on_after_flush</em></a></p>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" id="on-record-saved" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">on_record_saved:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><dl class="first docutils">
<dt>run from within the commit method of the widget, that</dt>
<dd><p class="first last">assures that will be issued just once. It&#8217;s just equivalent to the
signal with the callback has the same signature:</p>
</dd>
</dl>
<dl class="last function">
<dt>
<tt class="descname">record_saved_cb(sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>sqlwidget</em> &#8211; the widget that emitted the signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
<div class="section" id="hooks-for-related-widgets">
<h3>Hooks for related widgets<a class="headerlink" href="#hooks-for-related-widgets" title="Permalink to this headline">¶</a></h3>
<p>If you need to add hooks for related sqlwidgets (those that display related
records as explained in <a class="reference external" href="relationship.html#relationships"><em>Relationships</em></a>) you need to add the
relationship_path in the method name, i.e. the value you have used in the
table definition for the relation (and in the layout as in m2m=actors)</p>
<div class="section" id="example">
<span id="wav-example"></span><h4>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>This example shows how to use hooks to play a sound on completion:</p>
<div class="highlight-python"><pre>class Hook(obj):
    def on_completion__genre(self, field_name, obj):
         if obj.genre == 'horror':
              play('horror.wav')

MovieMask(class=models.Movie, hooks=Hook(), ...)</pre>
</div>
</div>
</div>
<div class="section" id="registered-hooks-and-sessionetensions">
<h3>Registered hooks and SessionEtensions<a class="headerlink" href="#registered-hooks-and-sessionetensions" title="Permalink to this headline">¶</a></h3>
<p>When hooks are <a class="reference external" href="advanced/dbutils.html#dbutils"><em>registered</em></a> their customizations are
enforced each time the model for which they&#8217;re registered is called. That adds
some complications you should be sure to understand if using one of these
hooks:</p>
<blockquote>
<ul class="simple">
<li>on_after_flush</li>
<li>on_after_commit</li>
<li>on_after_flush_postexec</li>
</ul>
</blockquote>
<p>These hooks are called within a SessionExtension that calls hooks on any
sqlwidget that may be using the same session. An m2m, m2o relation table
share the same session as the Mask that holds them so that it&#8217;s pretty
normal to have several different tables within the same session.</p>
<p>From the SessionExtension hooks are searched for in any of these so that you
should write the hooks keeping in mind it can be called from another
sqlwiget&#8217;s commit.</p>
<p>As an example, suppose you have a Mask with the following layout:</p>
<div class="highlight-python"><pre>first_name
last_name
m2m=genres   m2m=actors</pre>
</div>
<p>suppose <em>movies</em>, <em>genres</em> and <em>actors</em> have registered <tt class="docutils literal"><span class="pre">on_after_commit</span></tt>
hooks. They will all be called on any commit. Adding a genre object will
trigger <em>on_after_commit</em> on the Actor&#8217;s table and vice verse.</p>
</div>
<div class="section" id="get-differences">
<span id="diff"></span><h3>get_differences<a class="headerlink" href="#get-differences" title="Permalink to this headline">¶</a></h3>
<p>Module <a class="reference external" href="advanced/dbutils.html#dbutils"><em>sqlkit.db.utils</em></a> provides a simple function that yields
all modified attributes of an object, along with their old and new values</p>
<dl class="function">
<dt id="get_differences">
<tt class="descname">get_differences</tt><big>(</big><em>obj</em><big>)</big><a class="headerlink" href="#get_differences" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><em>obj</em> &#8211; the object to be inspected</li>
<li><em>session</em> &#8211; the session the object belongs to</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">field_name, old_value, new_value. Old value and new value are lists.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="get_history">
<tt class="descname">get_history</tt><big>(</big><em>obj</em>, <em>field_name</em><big>)</big><a class="headerlink" href="#get_history" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><em>obj</em> &#8211; the object to be inspected</li>
<li><em>field_name</em> &#8211; the field_name</li>
<li><em>session</em> &#8211; the session the object belongs to</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">new_value, unchanged_value, old_value, . Old value and new value
are lists. The order is different from <tt class="docutils literal"><span class="pre">get_differences</span></tt> as this is
exactly what is returned from the SA function</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="saving-varchar-and-text-fields">
<h2>Saving varchar and text fields<a class="headerlink" href="#saving-varchar-and-text-fields" title="Permalink to this headline">¶</a></h2>
<p>Text fields with empty values will be saved as NULL. To change this
behavior you need to set blank=True on fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="o">.</span><span class="n">gui_fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">blank</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</div>
<div class="section" id="uimanager-menu-and-actions">
<span id="uimanager"></span><h2>UiManager: menu and actions<a class="headerlink" href="#uimanager-menu-and-actions" title="Permalink to this headline">¶</a></h2>
<p>Menu entries are handled via standard gtk.UiManager interface. One interface
is created for each toplevel Window and for each <a class="reference external" href="table.html#views"><em>view</em></a> in a SqlTable
widget. You can see some examples in the demo (70-72).</p>
<p>Standard actions are divided into the following categories:</p>
<div class="highlight-python"><pre>General (self.actiongroup_general)
     PendingDifferences
     Quit
     Go
     Modify
     Tools
     File
     Help
     About
Table (self.actiongroup_table)
     HideColumns
     ShowColumns
     Records
     MaskViewFKey
     Export
     MaskView
     Zoom-fit
Insert (self.actiongroup_insert)
     New
     Save-as (just for SqlMask)
Delete (self.actiongroup_delete)
     Delete
     RecordDelete
Update (self.actiongroup_update)
     Save
     Undo  (just for SqlMask)
Browse (self.actiongroup_browse)
     Filters
     Reload
Select (self.actiongroup_select)
     Back
     Forward
Print (self.actiongroup_print)
     Print
Debug (self.actiongroup_debug)
     Gtk-tree</pre>
</div>
<p>While for each table&#8217;s view you have:</p>
<div class="highlight-python"><pre>Table
     HideColumns
     ShowColumns
     Records
     MaskViewFKey
     Export
     MaskView
     Zoom-fit
Insert
     New
Delete
     Delete
     RecordDelete</pre>
</div>
<div class="section" id="changing-an-entry">
<h3>Changing an entry<a class="headerlink" href="#changing-an-entry" title="Permalink to this headline">¶</a></h3>
<p>To change an entry you can:</p>
<ol class="arabic simple">
<li>add an actiongroup in which you have defined an  action with the same
name</li>
<li>insert this actiongroup <em>before</em> it&#8217;s relevant one (position 0 is
normally a good choice</li>
</ol>
<p>Example #72 in the demo shows how to do it</p>
</div>
<div class="section" id="adding-an-entry">
<h3>Adding an entry<a class="headerlink" href="#adding-an-entry" title="Permalink to this headline">¶</a></h3>
<p>the standard way is shown in demo snippet #70:</p>
<ol class="arabic simple">
<li>create an xml definition and add it to ui_manager</li>
<li>create an action and add it to an actiongroup</li>
</ol>
<p>You can also use a SqlTable method <a class="reference internal" href="#add-temporary-item"><em>add_temporary_item</em></a> that will add a
temporary entry, so that it can be contextually changed. This way is
demonstrated in demo snippet #71</p>
</div>
</div>
</div>


            </div>
        </div>
     </div>
   </div>

        
</div> <!-- wrap -->

            <div class="bottomnav footer">
                <div class="doc_copyright">
                Alessandro Dentella -- Copyright 2006-2007-2008-2009-2010
		  Sqlkit release 0.9.5.1
<!--                 % if hasdoc('copyright'): -->
<!--                     &copy; <a href="../copyright.html">Copyright</a> 2008, Sandro Dentella. -->
<!--                 % else: -->
<!--                     &copy; Copyright 2008, Sandro Dentella. -->
<!--                 % endif -->
                    creato usando  <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
                </div>
            </div>
        












<br style="clear: left" />

    </body>
</html>




