var __slice=Array.prototype.slice;(function(a){var b,c,d,e,f,g,h,i;return _.isObject||(_.isObject=function(a){return a===Object(a)}),d={autoExtendObjects:!0,debug:!1},h=this.Synapse||{},_.defaults(h,d),b=function(a){return new b.fn.init(a)},b.version="0.1.1",b.guid=1,b.cache={},b.conf=h,b.log=function(){if(b.conf.debug)try{return console.log.apply(console,arguments)}catch(a){try{return opera.postError.apply(opera,arguments)}catch(a){return alert(Array.prototype.join.call(arguments," "))}}},b.types={object:0,jquery:1,model:2,collection:3,view:4,router:5},i={0:"Object",1:"jQuery",2:"Model",3:"Collection",4:"View",5:"Router"},b.getObjectType=function(a){return a instanceof $?b.types.jquery:a instanceof Backbone.Model?b.types.model:a instanceof Backbone.Collection?b.types.collection:a instanceof Backbone.View?b.types.view:a instanceof Backbone.Router?b.types.router:b.types.object},b.fn=b.prototype={constructor:b,observers:{},subjects:{},init:function(a){if(a instanceof b)return a;if(_.isString(a)||_.isElement(a))a=$.apply($,arguments);return this.context=a,this.type=b.getObjectType(a),b.cache[this.guid=b.guid++]=this},bind:function(){return this.context.bind?this.context.bind.apply(this.context,arguments):Backbone.Events.bind.apply(this.context,arguments),this},unbind:function(){return this.context.unbind?this.context.unbind.apply(this.context,arguments):Backbone.Events.unbind.apply(this.context,arguments),this},trigger:function(){return this.context.trigger?this.context.trigger.apply(this.context,arguments):Backbone.Events.trigger.apply(this.context,arguments),this},get:function(a){return this.type===b.types.jquery?b.interfaces.get(this.context,a):_.isFunction(this.context[a])?this.context[a]():this.context.get?this.context.get.call(this.context,a):this.context[a]},set:function(a,c){var d,e,f;_.isObject(a)?d=a:(d={},d[a]=c);if(_.isFunction(this.context[a]))return this.context[a](c);if(this.type===b.types.jquery)for(e in d)f=d[e],b.interfaces.set(this.context,e,f);else this.context.set?this.context.set.call(this.context,d):_.extend(this.context,d);return this},sync:function(a){return a instanceof b||(a=b(a)),this.addNotifier(a).addObserver(a)},addNotifier:function(a,c,d){return a instanceof b||(a=b(a)),b.register(a,this,c,d),this},addObserver:function(a,c,d){return a instanceof b||(a=b(a)),b.register(this,a,c,d),this},toString:function(){return"<Synapse "+i[this.type]+" #"+this.guid+">"}},b.prototype.observe=b.prototype.addNotifier,b.prototype.notify=b.prototype.addObserver,b.fn.init.prototype=b.fn,b.defaultDomEvents=[["a,:button,:reset","click"],["select,:checkbox,:radio,textarea","change"],[":submit","submit"],[":input","keyup"]],e=function(a){var c,d,e,f,g,h;h=b.defaultDomEvents;for(f=0,g=h.length;f<g;f++){d=h[f],e=d[0],c=d[1];if(a.context.is(e))return c}throw new Error("Event for "+a+" could not be detected.")},b.getEvents=function(a,c){var d;if(!c)if(a.type===b.types.jquery)d=[e(a)];else if(a.type===b.types.model)d=["change"];else throw new Error("No event defined for subject");else d=_.isArray(c)?c:[c];return d},f=function(a){var c,d,e,f,g,h;h=b.elementInterfaces;for(f=0,g=h.length;f<g;f++){d=h[f],e=d[0],c=d[1];if(a.context.is(e))return c}if(b.defaultElementInterface)return b.defaultElementInterface;throw new Error("Interface for "+a+" could not be detected.")},b.elementInterfaces=b.defauElementInterfaces=[[":checkbox","checked"],[":radio","checked"],["button","html"],[":input","value"]],b.defaultElementInterface="text",b.getInterfaces=function(a,c,d,e){d||(a.type===b.types.jquery?d=f(a):a.type===b.types.model&&(d="")),e||c.type===b.types.jquery&&(e=f(c)),d||c.type===b.types.jquery&&(c.context.attr("role")?d=c.context.attr("role"):c.context.attr("name")&&(d=c.context.attr("name"))),e||(a.type===b.types.jquery&&a.context.attr("name")?e=a.context.attr("name"):e=d);if(!e)throw new Error("The interfaces between "+a+" and "+c+" could be detected - "+d+" => "+e);return _.isString(d)&&(d=d.split(" ")),_.isString(e)&&(e=e.split(" ")),[d,e]},b.interfaces=function(){return{registry:{},register:function(a){return this.registry[a.name]=a},unregister:function(a){return delete this.registry[a]},get:function(){var a,c,d,e,f;return c=arguments[0],e=arguments[1],a=3>arguments.length?[]:__slice.call(arguments,2),c instanceof b&&(c=c.context),f=e.split(":"),e=f[0],d=f[1],d!=null&&(a=[d].concat(a)),this.registry[e].get.apply(c,a)},set:function(){var a,c,d,e,f;return c=arguments[0],e=arguments[1],a=3>arguments.length?[]:__slice.call(arguments,2),c instanceof b&&(c=c.context),f=e.split(":"),e=f[0],d=f[1],d!=null&&(a=[d].concat(a)),this.registry[e].set.apply(c,a)}}}(),function(){var a,c,d,e,f,g;return c=function(b){return this.prop!=null?this.prop(b):a.call(this,b)},f=function(a,b){return this.prop!=null?typeof a=="object"?this.prop(a):this.prop(a,b):e.call(this,a,b)},a=function(a){return this.attr(a)},e=function(a,b){return typeof a=="object"?this.attr(a):this.attr(a,b)},d=function(a){return this.css(a)},g=function(a,b){return typeof a=="object"?this.css(a):this.css(a,b)},b.interfaces.register({name:"text",get:function(){return this.text()},set:function(a){return this.text((a||(a="")).toString())}}),b.interfaces.register({name:"html",get:function(){return this.html()},set:function(a){return this.html((a||(a="")).toString())}}),b.interfaces.register({name:"value",get:function(){return this.val()},set:function(a){return this.val(a||(a=""))}}),b.interfaces.register({name:"enabled",get:function(){return!c.call(this,"disabled")},set:function(a){return _.isArray(a)&&a.length===0&&(a=!1),f.call(this,"disabled",!Boolean(a))}}),b.interfaces.register({name:"disabled",get:function(){return c.call(this,"disabled")},set:function(a){return _.isArray(a)&&a.length===0&&(a=!1),f.call(this,"disabled",Boolean(a))}}),b.interfaces.register({name:"checked",get:function(){return c.call(this,"checked")},set:function(a){return _.isArray(a)&&a.length===0&&(a=!1),f.call(this,"checked",Boolean(a))}}),b.interfaces.register({name:"visible",get:function(){return d.call(this,"display")===!1},set:function(a){return _.isArray(a)&&a.length===0&&(a=!1),Boolean(a)?this.show():this.hide()}}),b.interfaces.register({name:"hidden",get:function(){return d.call(this,"display")==="none"},set:function(a){return _.isArray(a)&&a.length===0&&(a=!1),Boolean(a)?this.hide():this.show()}}),b.interfaces.register({name:"prop",get:function(a){return c.call(this,a)},set:function(a,b){return f.call(this,a,b)}}),b.interfaces.register({name:"attr",get:function(b){return a.call(this,b)},set:function(a,b){return e.call(this,a,b)}}),b.interfaces.register({name:"style",get:function(a){return d.call(this,a)},set:function(a,b){return g.call(this,a,b)}}),b.interfaces.register({name:"css",get:function(a){return this.hasClass(a)},set:function(a,b){return _.isArray(b)&&b.length===0&&(b=!1),Boolean(b)?this.addClass(a):this.removeClass(a)}}),b.interfaces.register({name:"data",get:function(a){return this.data(a)},set:function(a,b){return this.data(a,b)}})}(),b.handlers={2:{getHandler:function(a,b,c,d,e,f){var g,h,i,j,k;h=b,k=[];for(i=0,j=d.length;i<j;i++)g=d[i],g&&!a.context[g]&&(h=""+b+":"+g),a.bind(h,function(b,f,g){return f=_.map(d,a.get,a),c&&(f=c.apply(c,f),_.isArray(f)||(f=[f])),e.apply(a.context,f)}),k.push(f?a.trigger(h,a.context,a.get(g)):void 0);return k}}},c={event:null,getInterface:null,setInterface:null,converter:null,triggerOnBind:!0},g=function(a,d,e){var f,g,h,i,j,k,l,m,n,o,p,q;_.defaults(e,c),h=b.getEvents(a,e.event),p=b.getInterfaces(a,d,e.getInterface,e.setInterface),j=p[0],l=p[1],f=e.converter,f&&!_.isFunction(f)&&(f=d[f]),m=e.triggerOnBind,b.handlers[a.type]&&(i=b.handlers[a.type].getHandler),i==null&&(i=function(a,b,c,d,e,f){a.bind(b,function(){var b;return b=_.map(d,a.get,a),c&&(b=c.apply(c,b),_.isArray(b)||(b=[b])),e.apply(a.context,b)});if(f)return a.trigger(b)}),b.handlers[d.type]&&(k=b.handlers[d.type].setHandler),k==null&&(k=function(a,b){return function(c){var d,e,f,g;g=[];for(e=0,f=b.length;e<f;e++)d=b[e],g.push(a.set(d,c));return g}}),k=k(d,l),q=[];for(n=0,o=h.length;n<o;n++)g=h[n],a.observers[d.guid][g]=!0,d.subjects[a.guid][g]=!0,q.push(i(a,g,f,j,k,m));return q},b.registerSync=function(a,c){return b.registerObserver(a,c),b.registerObserver(c,a)},b.register=function(a,b,c,d){var e,f,h,i,j;a.observers[b.guid]||(a.observers[b.guid]={}),b.subjects[a.guid]||(b.subjects[a.guid]={}),_.isFunction(c)?f={converter:c}:_.isObject(c)?f=c:f={getInterface:c,setInterface:d},_.isArray(f)||(f=[f]),j=[];for(h=0,i=f.length;h<i;h++)e=f[h],j.push(g(a,b,e));return j},a.Synapse=a.SYN=b})(window)