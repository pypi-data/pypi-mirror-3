env:
  PATH: "${PROJECT_PATH}/bin:${PROJECT_PATH}/vendor/bundle/ruby/${RUBY_ABI}/bin:${PATH}"
  BUILD_PATH: "${PROJECT_PATH}/vendor/bundle"

build: |

  if [[ -f ./Gemfile || -f ./Gemfile.lock ]]; then
    bundle install --path=${BUILD_PATH}
  else
    warn 'no "Gemfile" or "Gemfile.lock" file found'
  fi

build_deployment: |

  if [[ ! -f ./Gemfile.lock ]]; then
    die 'no "Gemfile.lock" file found'
  fi

  bundle install --deployment

test: |

  rake

clean: |

  if [[ -d "${BUILD_PATH}" ]]; then
    rm -fr "${BUILD_PATH}"
  fi

  if [[ -d "${PROJECT_PATH}/.bundle" ]]; then
    rm -fr "${PROJECT_PATH}/.bundle"
  fi
