<script type="text/javascript" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/" py:strip="">
/* <![CDATA[ */
// function to use jQuery UI .position() for zoom panel
var position = function(elem, parent, left, top) {
    if (elem && parent)
    {
        return elem.position({
            of: parent,
            my: "left top",
            at: "left top",
            offset: left + ' ' + top,
            collision: "none",
        });
    }
}

// map display unit(hour/day) => HTML Element classname
var mapping = { 'hours':'btn-zoom-out', 'days':'btn-zoom-in' }

jQuery(document).ready(function($) {
    // grab all zoom panels
    $('div.${data.zoompanel}').each(function() {
        var zoompanel = $(this)
        ,   context   = zoompanel.parent();

        // lay them out nicely
        position(zoompanel, context, 10, 20);
        // disable all irrelevant zoom buttons
        var resolution = $(':hidden#resolution', context).val();
        $("span.zoombutton:not('."+mapping[resolution]+"')", context)
            .addClass('ui-state-disabled');
    });

    // zoom button click event handler
    $('span.zoombutton').unbind('click').click(function() {
        // only respond to enabled buttons
        if (!$(this).hasClass('ui-state-disabled'))
        {
            var context = $(this).parents('div.${data.container}')
            , chart = $('img.${data.chart}', context)
            , zoompanel = $('div.${data.zoompanel}', context);
            
            // switch between 'hours' and 'day' charts
            chart.toggle();

            // onclick, toggle enable/disableness of all zoom buttons
            // in this panel
            $('span.zoombutton', context).toggleClass('ui-state-disabled');
        }
        return false;
    });
});
/* ]]> */
</script>

