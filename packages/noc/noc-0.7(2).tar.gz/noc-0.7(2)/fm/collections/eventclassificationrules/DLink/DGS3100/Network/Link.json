[
    {
        "name": "DLink | DGS3100 | Network | Link | Link Down (SYSLOG)",
        "description": "%LINK-W-Down:  1:24",
        "event_class__name": "Network | Link | Link Down",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DGS3100$"
            },
            {
                "key_re": "^message$",
                "value_re": "%LINK-W-Down:\\s+(?P<interface>(?:\\d:|ch)\\d+)$"
            }
        ]
    },

    {
        "name": "DLink | DGS3100 | Network | Link | Link Up (SYSLOG)",
        "description": "%LINK-I-Up:  1:22",
        "event_class__name": "Network | Link | Link Up",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DGS3100$"
            },
            {
                "key_re": "^message$",
                "value_re": "%LINK-I-Up:\\s+(?P<interface>(?:\\d:|ch)\\d+)$"
            }
        ]
    },

    {
        "name": "DLink | DGS3100 | Network | Link | Link Up (SNMP)",
        "description": "SNMPv2-MIB::snmpTraps",
        "event_class__name": "Network | Link | Link Up",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DGS3100$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "SNMPv2-MIB::snmpTraps$"
            },
            {
                "key_re": "^IF-MIB::ifAdminStatus\\.\\d+$",
                "value_re": "up$"
            },
            {
                "key_re": "^IF-MIB::ifOperStatus\\.\\d+$",
                "value_re": "up$"
            },
            {
                "key_re": "^IF-MIB::ifIndex\\.\\d+$",
                "value_re": "(?P<iface>\\d+)$"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "='%s:%s' % ((int(int(iface)/50)+1), ((int(iface)+50)%50))"
            }
        ]
    },

    {
        "name": "DLink | DGS3100 | Network | Link | Link Down (SNMP)",
        "description": "SNMPv2-MIB::snmpTraps",
        "event_class__name": "Network | Link | Link Down",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DGS3100$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "SNMPv2-MIB::snmpTraps$"
            },
            {
                "key_re": "^IF-MIB::ifAdminStatus\\.\\d+$",
                "value_re": "(?:up|down)$"
            },
            {
                "key_re": "^IF-MIB::ifOperStatus\\.\\d+$",
                "value_re": "down$"
            },
            {
                "key_re": "^IF-MIB::ifIndex\\.\\d+$",
                "value_re": "(?P<iface>\\d+)$"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "='%s:%s' % ((int(int(iface)/50)+1), ((int(iface)+50)%50))"
            }
        ]
    }
]
