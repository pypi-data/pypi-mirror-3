<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title>ts2avi</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="ts2avi">
<h1 class="title">ts2avi</h1>

<div class="section" id="introduction">
<h1>Introduction</h1>
<p>Les <em>box</em> comme la <cite>freebox</cite> de Free permettent l'enregistrement
de chaînes de télévision. Ces enregistrements sont effectués via
un serveur vlc au format TS (<em>transport stream</em>). Habituellement,
pour une émission ou un film de 2h, la taille du fichier peut
atteindre facilement 3 à 4 Go, ce qui fait que leur stockage
régulier sur votre disque dur peut lui faire atteindre ses limites
de capacité beaucoup plus vite que prévu.</p>
<p><cite>ts2avi</cite> est un script python qui va vous permettre de convertir
toutes vos vidéos au format <cite>ts</cite> dans un format <cite>divx</cite> plus commun,
avec les codecs audio MP3 et vidéo MPEG4. Les tailles des fichiers
convertis sont ainsi 4 à 6 fois inférieures à celles des originaux,
tout en limitant cependant la dégradation de la qualité d'image.</p>
</div>
<div class="section" id="prerequis">
<h1>Prérequis</h1>
<p><cite>ts2avi</cite> est un script python, vous aurez donc besoin d'une version
récente de ce langage. Si la version 2.7 est recommandée, le script
devrait cependant fonctionner à partir de la 2.6, car il utilise
le module <cite>subprocess</cite>.</p>
<p>Pour la conversion vidéo, le script repose complètement sur
<cite>mencoder</cite> : vérifiez donc que ce dernier est installé ou
téléchargez-le sur <a class="reference external" href="http://www.mplayerhq.hu/design7/dload.html">http://www.mplayerhq.hu/design7/dload.html</a>.
La plupart des distributions GNU/Linux le proposent avec <cite>mplayer</cite>.</p>
<p><cite>ts2avi</cite> ne fonctinne pour l'instant que sous Linux. Il est cependant
très certainement paramétrable pour les plates-formes MS Windows
à condition de modifier le script pour renseigner le chemin exact
vers <cite>mencoder</cite>.</p>
</div>
<div class="section" id="installation">
<h1>Installation</h1>
<p><cite>ts2avi</cite> est livré comme un paquetage distutils. Pour l'installer,
téléchargez le paquet et décompressez-le dans un répertoire
quelconque, puis tapez la ligne de commande suivante:</p>
<pre class="literal-block">
$ python setup.py install
</pre>
<p>Ceci suppose en général que vous possédez les droits <em>root</em> pour
installer les <em>site-packages</em>. Cependant, si ce n'est pas le cas,
vous pouvez avantageusement utiliser les dernières options
d'installation <em>locale</em> de <cite>distutils</cite>:</p>
<pre class="literal-block">
$ python setup.py install --user
</pre>
<p>Ceci installera tout dans votre répertoire <tt class="docutils literal"><span class="pre">$HOME/.local</span></tt> (pour
les utilisateurs de plates-formes POSIX). N'oubliez pas alors
d'ajouter le répertoire <tt class="docutils literal"><span class="pre">$HOME/.local/bin</span></tt> à votre <tt class="docutils literal">$PATH</tt> par
exemple en enrichissant ce dernier dans votre fichier source
<tt class="docutils literal">.bashrc</tt>.</p>
<p>Vous avez enfin la possibilité d'installer <cite>ts2avi</cite> directement
comme un <cite>egg</cite> python:</p>
<pre class="literal-block">
$ easy_install ts2avi
</pre>
<p>Ceci téléchargera et installera automatiquement <cite>ts2avi</cite> pour vous.</p>
</div>
<div class="section" id="utilisation">
<h1>Utilisation</h1>
<p>L'utilisation standard du script est la suivante:</p>
<pre class="literal-block">
$ ts2avi.py &lt;myrecord&gt;.ts
</pre>
<p>Ceci convertira le fichier TS en argument en un fichier
<tt class="docutils literal"><span class="pre">&lt;myrecord&gt;.avi</span></tt> au format MPEG4. Notez également que le script
reconnaît toutes les expansions Unix classiques, ainsi par exemple
si vous voulez convertir tous les enregistrements de la chaîne TMC
placés dans le répertoire courant:</p>
<pre class="literal-block">
$ ts2avi.py TMC*.ts
</pre>
<p>Si vous désirez stocker les fichiers convertis dans un autre
répertoire, par exemple sur un disque dur externe, utiliser
l'option <cite>--output_dir</cite>:</p>
<pre class="literal-block">
$ ts2avi.py --output_dir=/media/hdd/Videos *.ts
</pre>
<p>La conversion vidéo peut être faite selon différents 'profils'
(cf. le chapitre <a class="reference internal" href="#comment-ca-marche">Comment ça marche</a> ci-dessous). Pour sélectionner
un profil de conversion spécifique, tapez dans un terminal:</p>
<pre class="literal-block">
$ ts2avi.py --profile='fast' &lt;myrecord&gt;.ts
</pre>
<p>Enfin, pour obtenir l'ensemble des explications relatives aux
différentes options de <cite>ts2avi</cite>, essayez</p>
<pre class="literal-block">
$ ts2avi.py --help
</pre>
</div>
<div class="section" id="comment-ca-marche">
<h1>Comment ça marche</h1>
<p>Pour chaque fichier passé en argument du script, la conversion est
effectuée dans un répertoire temporaire. Les différentes étapes sont
les suivantes :</p>
<ol class="arabic simple">
<li>Le conteneur est transformé en MPEG ; cependant, les formats
audio et vidéo sont eux totalement préservés, il s'agit d'une
simple opération de copie</li>
<li>La piste audio est extraite et convertie séparément en MP3</li>
<li>Enfin, un encodage en 2 passes de la vidéo au format MPEG4
est effectué.</li>
</ol>
<p>Différents profils de conversion sont disponibles. Pour en
choisir un, utilisez l'option <cite>--profile</cite>. Les étapes décrites
précédemment font référence au profil par défaut, qui est
censé fournir la meilleure qualité vidéo posible.</p>
</div>
<div class="section" id="limitations-v-0-1-1">
<h1>Limitations (v. 0.1.1)</h1>
<ul class="simple">
<li>Le script fonctionne avec les systèmes type Unix. Le configurer
pour Windows ne devrait pas poser cependant de gros problèmes : il
suffit d'utiliser l'option <cite>--mencoder_path</cite> pour surcharger le
chemin vers votre binaire local de <cite>mencoder</cite>. Cela n'a pas encore
été testé... Cela pourra dans le futur se traduire par la
création d'un profil spécifique pour les utilisateurs windows.</li>
<li>Le multiprocessing ne fonctionne pas actuellement. Il serait
pourtant utile, parce que convertir plusieurs vidéos peut prendre
des heures voir plus sans utiliser à fond votre dualcore par
exemple. Il est planifié dans une future version, en utilisant
le module python <cite>multiprocessing</cite>.</li>
<li>Les fichiers originaux ne sont pas détruits après la conversion,
et ne le seront jamais même dans les prochaines versions. Ceci
juste au cas où la qualité de la conversion ne vous conviendrait
pas et que vous souhaiteriez tester un autre profil, par exemple !</li>
<li>Bien sûr, <cite>ts2avi</cite> ne retire pas les séquences de pub de vos films.
Pour cela, pas d'autre solution qu'utiliser un éditeur vidéo comme
<a class="reference external" href="http://avidemux.sourceforge.net">Avidemux</a>. Le faire avant la
conversion est évidemment mieux, puisque vous gagnerez au moins le
temps de conversion de la publicité !</li>
</ul>
</div>
<div class="section" id="todo-v-0-1-1">
<h1>TODO (v. 0.1.1)</h1>
<ul class="simple">
<li>permettre aux utilisateurs de définir leurs propres profils, par
exemple dans un fichier <tt class="docutils literal">ts2avi.ini</tt></li>
<li>améliorer le traitement des erreurs</li>
<li>remplacer les commandes python <cite>print</cite> pour l'affichage par le
module python <cite>logging</cite></li>
<li>autoriser les conversions en parallèle en utilisant le module
python <cite>multiprocessing</cite></li>
</ul>
</div>
</div>
</body>
</html>
