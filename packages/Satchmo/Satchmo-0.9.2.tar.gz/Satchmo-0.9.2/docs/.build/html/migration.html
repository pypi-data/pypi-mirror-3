

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Satchmo Migrations and Upgrades &mdash; Satchmo v0.9.2-development documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.2-development',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Satchmo v0.9.2-development documentation" href="index.html" />
    <link rel="prev" title="Satchmo 0.7 Release" href="release-notes-0-7.html" /> 
  </head>
  <body>

<div style="background-image: url(_static/satchmo-sliver.jpg); background-repeat: repeat-x; background-color: white; text-align: left;">
<img src="_static/satchmo-front.jpg">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="release-notes-0-7.html" title="Satchmo 0.7 Release"
             accesskey="P">previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Satchmo Migrations and Upgrades</a><ul>
<li><a class="reference internal" href="#using-south">Using South</a><ul>
<li><a class="reference internal" href="#upgrading-from-an-existing-0-9-installation">Upgrading from an existing 0.9 installation</a></li>
<li><a class="reference internal" href="#installing-satchmo-0-9-1-with-south">Installing Satchmo 0.9.1 with South</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="release-notes-0-7.html"
                        title="previous chapter">Satchmo 0.7 Release</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<p>Documentation Version:</p>
<ul>
    <li><a href="/docs/dev">Current development version</a></li>
    <li><a href="/docs/rel/latest">Latest Release version</a></li>
    <li><a href="http://bitbucket.org/chris1610/satchmo/downloads/Satchmo-0-9-1.pdf">PDF Documentation</a></li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="satchmo-migrations-and-upgrades">
<h1>Satchmo Migrations and Upgrades<a class="headerlink" href="#satchmo-migrations-and-upgrades" title="Permalink to this headline">¶</a></h1>
<p>The latest list of backwards incompatible changes can always be found here-
<a class="reference external" href="http://bitbucket.org/chris1610/satchmo/wiki/BackwardsIncompatibleChanges">http://bitbucket.org/chris1610/satchmo/wiki/BackwardsIncompatibleChanges</a></p>
<p>The ideal way to migrate would be to dump all of your existing store data, remove all of your old tables, synch the new models and reload the data.
If this process is not practical, then follow the individual steps outlined below.</p>
<p>Always remember to do a complete backup of your store before attempting to migrate.  Additionally, we recommend that you test the migration
on a test server before attempting on a production server.</p>
<div class="section" id="using-south">
<h2>Using South<a class="headerlink" href="#using-south" title="Permalink to this headline">¶</a></h2>
<p>The very latest version of Satchmo includes migration files for
<a class="reference external" href="http://south.aeracode.org/">South</a>. So far, we only have migrations for the
<tt class="docutils literal"><span class="pre">product</span></tt> app.</p>
<p>The instructions below assume that you have installed South 0.7; you can
download it from here:</p>
<blockquote>
<a class="reference external" href="http://south.aeracode.org/docs/installation.html">http://south.aeracode.org/docs/installation.html</a></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The initial product migration is based on the 0.9 code base. If you already
have an existing installation, please read <a class="reference internal" href="#upgrading-from-an-existing-0-9-installation">Upgrading from an existing 0.9 installation</a>;
if you are planning to do a fresh installations of 0.9.1, please see
<a class="reference internal" href="#installing-satchmo-0-9-1-with-south">Installing Satchmo 0.9.1 with South</a>.</p>
</div>
<div class="section" id="upgrading-from-an-existing-0-9-installation">
<h3>Upgrading from an existing 0.9 installation<a class="headerlink" href="#upgrading-from-an-existing-0-9-installation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Download/check out a copy of the new version of Satchmo.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>Do not</em> install the new version of Satchmo yet.</p>
</div>
</li>
<li><p class="first">If you aren&#8217;t already using South for your project, add it to your
<tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> and create the history table:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py syncdb

<span class="go">Syncing...</span>
<span class="go">Installing yaml fixture &#39;initial_data&#39; from &#39;/home/user/lib/python2.5/Satchmo-0.9_0-py2.5.egg/satchmo_store/shop/fixtures&#39;.</span>
<span class="go">Installing yaml fixture &#39;initial_data&#39; from &#39;/home/user/lib/python2.5/Satchmo-0.9_0-py2.5.egg/satchmo_store/contact/fixtures&#39;.</span>
<span class="go">Installing yaml fixture &#39;initial_data&#39; from &#39;/home/user/lib/python2.5/Satchmo-0.9_0-py2.5.egg/product/fixtures&#39;.</span>
<span class="go">Installed 16 object(s) from 3 fixture(s)</span>

<span class="go">Synced:</span>
<span class="go"> &gt; django.contrib.admin</span>
<span class="go"> &gt; django.contrib.auth</span>
<span class="go"> &gt; django.contrib.contenttypes</span>
<span class="go"> &gt; django.contrib.sessions</span>
<span class="go"> &gt; django.contrib.sites</span>
<span class="go"> &gt; django.contrib.comments</span>
<span class="go"> &gt; satchmo_store.shop</span>
<span class="go"> &gt; keyedcache</span>
<span class="go"> &gt; livesettings</span>
<span class="go"> &gt; l10n</span>
<span class="go"> &gt; south</span>
<span class="go"> &gt; sorl.thumbnail</span>
<span class="go"> &gt; satchmo_store.contact</span>
<span class="go"> &gt; tax</span>
<span class="go"> &gt; tax.modules.area</span>
<span class="go"> &gt; tax.modules.percent</span>
<span class="go"> &gt; shipping</span>
<span class="go"> &gt; product</span>
<span class="go"> &gt; payment</span>
<span class="go"> &gt; payment.modules.giftcertificate</span>
<span class="go"> &gt; satchmo_utils</span>
<span class="go"> &gt; app_plugins</span>
<span class="go"> &gt; singpost</span>
<span class="go"> &gt; shop_ext</span>
<span class="go"> &gt; satchmo_state</span>

<span class="go">Not synced (use migrations):</span>
<span class="go"> -</span>
<span class="go">(use ./manage.py migrate to migrate these)</span>
</pre></div>
</div>
</li>
<li><p class="first">Replace your Satchmo installation with the new version of it.</p>
</li>
<li><p class="first">Since the database tables have already been created for your old (0.9)
Satchmo installation, you need to &#8220;fake&#8221; the initial migration, or else
South will try re-creating the database tables. Do it like so:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py migrate product --fake 0001

<span class="go">- Soft matched migration 0001 to 0001_initial.</span>

<span class="go">Running migrations for product:</span>
<span class="go"> - Migrating forwards to 0001_initial.</span>
<span class="go"> &gt; product: 0001_initial</span>
<span class="go">   (faked)</span>
</pre></div>
</div>
</li>
<li><p class="first">See list of migrations:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py migrate product --list

<span class="go"> product</span>
<span class="go">  (*) 0001_initial</span>
<span class="go">  ( ) 0002_add_attributeoption</span>
<span class="go">  ( ) 0003_add_productattribute_option</span>
<span class="go">  ( ) 0004_remove_productattribute_name</span>
<span class="go">  ( ) 0005_fix_attributeoption_error_default_spelling</span>
<span class="go">  ( ) 0006_custom_textfield_add_constraint</span>
<span class="go">  ( ) 0007_add_discount_valid_products_field</span>
<span class="go">  ( ) 0008_remove_discount_validproducts_field</span>
<span class="go">  ( ) 0009_add_categoryattributes</span>
</pre></div>
</div>
</li>
<li><p class="first">Run the migrations:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py migrate product --db-dry-run <span class="c"># db untouched</span>
<span class="gp">$</span> python manage.py migrate product
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="installing-satchmo-0-9-1-with-south">
<h3>Installing Satchmo 0.9.1 with South<a class="headerlink" href="#installing-satchmo-0-9-1-with-south" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We asume that you&#8217;ve already installed South, but have yet to take the leap
with Satchmo; see <a class="reference external" href="http://south.aeracode.org/docs/installation.html">http://south.aeracode.org/docs/installation.html</a> for
details.</p>
</div>
<ul>
<li><p class="first">Before installing Satchmo, ensure that your tables and migrations are
up-to-date, by running <tt class="docutils literal"><span class="pre">syncdb</span></tt> and <tt class="docutils literal"><span class="pre">migrate</span></tt>.</p>
</li>
<li><p class="first">Install Satchmo by adding it to your path and <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt>.</p>
</li>
<li><p class="first">You have two options:</p>
<ul>
<li><p class="first">Create the database tables for Satchmo&#8217;s non-migration models, then create
the <tt class="docutils literal"><span class="pre">product</span></tt> app tables and run the migrations:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py syncdb
<span class="gp">$</span> python manage.py migrate product
</pre></div>
</div>
</li>
<li><p class="first">Alternatively, you can create the tables directly and skip running the
migrations:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py syncdb --all
<span class="gp">$</span> python manage.py migrate product --fake
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Users familiar with the codebase may wonder why we didn&#8217;t tell South to
apply migrations for the product modules, like <tt class="docutils literal"><span class="pre">configurable</span></tt> and
<tt class="docutils literal"><span class="pre">custom</span></tt>, even though they are there; that&#8217;s because they have already
been implicitly applied. You can verify this with an installation-wide
migration listing:</p>
<div class="last highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py migrate --list

<span class="go"> product</span>
<span class="go">  (*) 0001_initial</span>
<span class="go">  (*) 0002_add_attributeoption</span>
<span class="go">  (*) 0003_add_productattribute_option</span>
<span class="go">  (*) 0004_remove_productattribute_name</span>
<span class="go">  (*) 0005_fix_attributeoption_error_default_spelling</span>
<span class="go">  (*) 0006_custom_textfield_add_constraint</span>
<span class="go">  (*) 0007_add_discount_valid_products_field</span>
<span class="go">  (*) 0008_remove_discount_validproducts_field</span>
<span class="go">  (*) 0009_add_categoryattributes</span>
<span class="go">  (*) 0010_add_discountable_categories</span>
<span class="go">  (*) 0011_split_products</span>
<span class="go">  (*) 0012_update_contenttypes</span>

<span class="go"> configurable</span>
<span class="go">  (*) 0001_split</span>
<span class="go">  (*) 0002_update_contenttypes</span>

<span class="go"> custom</span>
<span class="go">  (*) 0001_split</span>
<span class="go">  (*) 0002_update_contenttypes</span>

<span class="go"> downloadable</span>
<span class="go">  (*) 0001_split</span>
<span class="go">  (*) 0002_update_contenttypes</span>

<span class="go"> subscription</span>
<span class="go">  (*) 0001_split</span>
<span class="go">  (*) 0002_update_contenttypes</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="release-notes-0-7.html" title="Satchmo 0.7 Release"
             >previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010, Chris Moffitt.
      Last updated on Mar 10, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
<script src='http://www.google-analytics.com/ga.js' type='text/javascript'></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1711397-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>