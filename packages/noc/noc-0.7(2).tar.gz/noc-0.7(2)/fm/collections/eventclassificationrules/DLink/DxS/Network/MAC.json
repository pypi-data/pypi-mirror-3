[
    {
        "name": "DLink | DxS | Network | MAC | MAC Flood (SYSLOG)",
        "description": "WARN: The flooding MAC is detected (VID: 23, MAC: 00-1E-8C-A4-A6-96)",
        "event_class__name": "Network | MAC | MAC Flood",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:WARN:|WARN\\(4\\)) The flooding MAC is detected \\(VID: (?P<vlan>\\d+), MAC: (?P<mac>\\S+)\\)"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | MAC | MAC Flood (SNMP)",
        "description": "DES3028-L2MGMT-MIB::swL2FloodMacDetectedTrap",
        "event_class__name": "Network | MAC | MAC Flood",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^D[EG]S-?\\d{4}.+-MIB::swL2FloodMacDetectedTrap$"
            },
            {
                "key_re": "^D[EG]S-?\\d{4}.+-MIB::swL2FloodMacDetectedMacAddress(\\.\\d+)?$",
                "value_re": "^(?P<mac__bin_to_mac>.+)$"
            },
            {
                "key_re": "^D[EG]S-?\\d{4}.+-MIB::swL2FloodMacDetectedMacVid(\\.\\d+)?$",
                "value_re": "^(?P<vlan>\\d+)$"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | MAC | MAC Learned (SNMP)",
        "description": "DES3028-L2MGMT-MIB::swL2FloodMacDetectedTrap",
        "event_class__name": "Network | MAC | MAC Learned",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^D[EG]S-?\\d{4}.+-MIB::swL2macNotification$"
            },
            {
                "key_re": "^D[EG]S-?\\d{4}.+-MIB::swl2NotificationBidings$",
                "value_re": "^\\x01(?P<mac__bin_to_mac>.{6}).{2}(?P<iface>.{2})"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "=str(ord(iface[1]))"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | MAC | MAC Aged (SNMP)",
        "description": "DES3028-L2MGMT-MIB::swL2FloodMacDetectedTrap",
        "event_class__name": "Network | MAC | MAC Aged",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^D[EG]S-?\\d{4}.+-MIB::swL2macNotification$"
            },
            {
                "key_re": "^D[EG]S-?\\d{4}.+-MIB::swl2NotificationBidings$",
                "value_re": "^\\x02(?P<mac__bin_to_mac>.{6}).{2}(?P<iface>.{2})"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "=str(ord(iface[1]))"
            }
        ]
    }
]
