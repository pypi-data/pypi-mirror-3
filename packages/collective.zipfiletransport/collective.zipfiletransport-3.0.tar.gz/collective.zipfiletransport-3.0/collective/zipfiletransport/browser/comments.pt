<tal:block define="userHasReplyPermission view/can_reply;
                   isDiscussionAllowed view/is_discussion_allowed;
                   replies view/get_replies;
                   isAnon view/is_anonymous"
           i18n:domain="plone">
  <tal:block tal:condition="python:replies">
    <!-- collective.zipfiletransport: COMMENTS -->
    <div class="discussion">
        <tal:getreplies repeat="reply_dict replies">
            <div class="comment" style=""
                tal:define="indent python:reply_dict['depth']*2;
                            reply python:reply_dict['object']"
                tal:attributes="style string:margin-left:${indent}em;">
                <div class="documentByLine"
                     tal:define="creator reply/Creator;
                                 anonymous_creator python:creator in ('Anonymous User', '');
                                 mi python:not anonymous_creator and view.member_info(creator);
                                 fullname python: mi and mi['fullname'] or creator;" >
                        <tal:posted i18n:translate="label_comment_by">Posted by</tal:posted>
                        <tal:name content="fullname"
                                  condition="not:anonymous_creator">Poster Name</tal:name>
                        <tal:name i18n:translate="label_anonymous_user"
                                  condition="anonymous_creator">Anonymous User</tal:name>
                        <tal:at i18n:translate="label_commented_at">at</tal:at>
                    <span tal:replace="python:view.format_time(reply.ModificationDate())">8/23/2001 12:40:44 PM</span>
                </div>
                <div class="commentBody"
                     tal:content="structure reply/CookedBody">
                     This is the body text of the comment.
                </div>
            </div>
        </tal:getreplies>
    </div>
  </tal:block>
</tal:block>
