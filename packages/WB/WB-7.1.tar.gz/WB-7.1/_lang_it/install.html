<table width="100%" cellpadding=5><tr>
<td bgcolor=#5555ff width=45><a href=about.html><img src=../_img/wb.png></a></td>
<td bgcolor=#ccccff><h3> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Installing WB </h3></td></tr></table>

<p>
<center>
Luca Fini (<i>lfini@arcetri.astro.it</i>). September 2006
</center>
<p>

<table width="100%" border=1><tr>
<th width="16%"><a href=about.html>Introduzione</a></th>
<th width="16%">Istallazione</th>
<th width="16%"><a href=config.html>Configurazione</a></th>
<th width="16%"><a href=help.html>Uso</a></th>
<th width="16%"><a href=copyright.html>Copyright</a></th>
<th width="16%"><a href=wbfaq.html>F.A.Q.</a></th></tr>
</table>

<a name=install>
<h3> Copiare i files sul server Web</h3>
</a>
Per istallare <b>WB</b> occorre innanzitutto identificare due particolari
directory relativi al server Web:
la <i>directory CGI</i> e la radice dei documenti (<i>document root</i>)
To proceed with WB installation you must first locate two directories on

La <i>directory CGI</i> contiene le procedure eseguibili (CGI). Pu&ograve; trovarsi
in posizioni differenti a seconda della configurazione del server Web, spesso
si trova in una delle seguenti posizioni:

<blockquote>
<tt>/usr/local/apache/cgi-bin</tt><br>
<tt>/var/www/cgi-bin</tt>
</blockquote>

Anche la radice dei documenti pu&ograve; variare a seconda della configurazione.
Normalmente si trova in:

<blockquote>
<tt>/var/www/html</tt><br>
<tt>/opt/htdocs</tt><br>
<tt>/var/htdocs</tt><br>
</blockquote>

e simili.

<p>
<center> <table width=80% border=1 cellpadding=4> <tr><td bgcolor=#dddddd> <font size=-1>
<b>Note:</b> Se utilizzate il server Apache potete cercare la variabile relativa
nel file di configurazione (<tt>httpd.conf</tt>).
Occorre cercare le variabli:

<tt>ScriptAlias</tt> per la directory CGI e <tt>DocumentRoot</tt> per la radice dei documenti.
</font> </td></tr></table> </center>

<p> L'istallazione di <b>WB</b> rechiede poche operazioni:

<p>
<ol>
<p><li> Creare una sottodirectory specifica sotto la <i>radice dei documenti</i>
dove saranno create le bacheche.

<blockquote>
<tt>&gt; mkdir /var/www/html/Bacheche</tt>
</blockquote>


<p><li> Trasferire i files della distribuzione <b>WB</b> nella directory creata:
<blockquote>
<tt>&gt; tar xvfz wb.tgz</tt>
</blockquote>
o anche
<blockquote>
<tt>&gt; gunzip -c wb.tgz | tar xvf </tt>
</blockquote>

<p><li> Move the program <tt>wb.py</tt> into CGI directory. E.g.:
<p><li> spostare i programmi<tt>wb.py</tt>  e <tt>wbmgmt.py</tt> nella directory CGI:

<blockquote>
<tt>&gt; mv wb.py wbmgmt.py /var/www/cgi-bin</tt>
</blockquote>

<p><li>
Il server <tt>http</tt> deve avere permessi di scrittura su questa directory.
Il modo pi&ugrave; semplice consiste nel assegnare come proprietario della
directory lo <i>userid</i> utilizzato per lanciare il server. Dovete verificare
la vostra installazione; gli <i>userid</i> comunemente usati sono: 
"apache", o "cochise" o anche "nobody".

Potete usare il comando <tt>ps</tt> come segue:

<pre>
: ps -ef | grep httpd
    root   624     1  0   Jul 05 ?        0:09 /usr/local/apache2/bin/httpd 
 cochise 27509   624  0 16:34:03 ?        0:00 /usr/local/apache2/bin/httpd
 cochise 27421   624  0 16:33:05 ?        0:00 /usr/local/apache2/bin/httpd
 ..... more lines ...</pre>

Ignorate la linea con "root", nelle altre viene mostrato lo <i>userid</i> che dovete usare.

<p>
<center> <table width=80% border=1 cellpadding=4> <tr><td bgcolor=#dddddd> <font size=-1>
<b>Nota:</b> 
varie versioni di Unix(Linux) possono evere sintassi un po' diverse per il cpomando <tt>ps</tt>,
ad esempio: <tt>ps aux</tt>
</font> </td></tr></table> </center>
<p>

<p><li> Per finire dovete personalizzare il file <tt>wb.py</tt> per adattarlo 
alle vostre esigenze, le linee interessate sono:
<blockquote>
<pre># Start customization section  
root_http   = 'http://www.my.domain/Bacheche'  
root_dir    = '/var/www/html/Bacheche'  
domain      = 'my.domain'         # e-mail domain  
smtphost    = 'smtp.my.domain'    # smtp host  
def_lang    = 'it'                # Default language
auth_mode   = 'unix'              # Specify user authorization method
debug       = 0                   # Set to 1 for debug output  
def_ttl     = 600                 # Session expiring time  
dolog       = 1                   # Set to 0 for no logging </pre> 
</tt></blockquote>

Le prime cinque righe sono le pi&ugrave; importanti:
<p>
<dl>
<dt> <b>root_http</b>
<dd> La URL della directory per le Bacheche come richiesta dal vostro server Web.
     Nell'esempio sopra si tratta di una sottodirectory della radice del server.
<p>
<dt> <b>root_dir</b>
<dd> Il path della stessa directory
<p>
<dt> <b>domain</b>
<dd> Il dominio di posta elettronica che sar&agrave; utilizzato per inviare messaggi.
<p>
<dt> <b>smtphost</b>
<dd> L'indirizzo del server di posta elettronica che invia i messaggi.
<p>
<dt> <b>def_lang</b>
<dd> Il linguaggio utilizzato per default.
     (Nota: &egrave; possibile definire un linguaggio specifico per ogni
     bacheca. Si veda le note di 
     <a href=config.html>configurazione</a>).
<p>
<dt> <b>auth_method</b>
<dd> Questa variabile pu&ograve; essere: 'unix', o 'local'.
     Le operazioni sulla bacheca sono protette dal controllo di accesso
     basatoi su username/password. Se il valore &egrave; 'unix' le
     credenziali sono verificate prima mediante il controllo degli utenti standard di Unix,
     e poi in un database di credenziali specifico del programma <b>WB</b>.
     Se il valore &egrave; 'local' viene utilizzato solo il database
     specifico. Tale database viene gestito utilizzando il programma
     con le relative opzioni: <tt>wb.py -u</tt>, <tt>wb.py -l</tt>, <tt>wb.py -r</tt>.

</dl>

<p><li>Per finire dovete verificare che il programma <tt>wb.py</tt> possa essere
       laniato dal server Web e che i files relativi siano accessibili in lettura.
       Potrebbe essere necessario cambiare i diritti di propriet&agrave; o di accesso ai files.

</ol>
<h3>Prova dell'istallazione</h3>

<ol>
<p><li> Provate a lanciare il programma <tt>wb.py</tt> da linea di comando:

<blockquote>
<tt>&gt; python wb.py

wb.py - L.Fini (lfini@arcetri.astro.it). Version 4.11, October 2005 

Usage: wb.py -i directory     show billboard info
       wb.py -m [directory]   perform billboard maintenance [only on specified dir]
       wb.py -s bboard doc    show document file structure
       wb.py -u user passwd   add user/password to local password file
       wb.py -v directory     show available languages
</blockquote>

<center> <table width=80% border=1 cellpadding=5> <tr><td bgcolor=#dddddd> <font size=-1>
<b>Nota:</b>  si noti che il programma <tt>wb.py</tt> pu&ograve; essere utilizzato
anche da linea di comando. Ci&ograve; &egrave; utile in varie occasioni, ad esempio per
effettuare manutenzioni periodiche programmate delle bacheche (vedere sotto).
</font> </td></tr></table> </center>

<p><li> Verificate che il programma possa essere lanciato come comando:

<blockquote>
<tt>&gt; /var/www/cgi-bin/wb.py</tt><pre>
</blockquote>

E dovete ottenere lo stesso risultato del comando precedente.
Se ci&ograve; non accade, vertificate il path dell'interprete <tt>python</tt>:

<blockquote>
<tt>&gt; which python </tt><pre>
/usr/bin/python</pre>
</blockquote>

Lo stesso path deve comparire nella prima linea del programma <tt>wb.py</tt>:

<blockquote>
#!/usr/bin/python
</blockquote>


<p><li> Verificate adesso che <tt>wb.py</tt> possa essere lanciato come applicazione CGI.
Aprite con un qualunque browser la URL relativa, ad es:

<blockquote>
http://www.my.domain/cgi-bin/wb.py
</blockquote>

Il risultato dovrebbe essere una pagina con l'elenco delle bacheche disponibili.
<b>Nota:</b> Non vedrete nessuna bacheca perch&eacute; non ne avete ancora definite!
</ol>
<p>
A questo puntio potete passare alla <a href=config.html>configurazione</a> per definire la prima bacheca.

<h3>Manutenzione della directory delle bacheche</h3>

I documenti scaduti possono essere rimossi dalla dirfectory delle bacheche. Non &egrave;
individuare i files: i nomi non sono ovvi e ciascun documento pu&ograve; avere files
allegati. <b>WB</b> fornisce una funzione per effettuare la manutenzione dalla sua
interefaccia web, ma un amministratore potrebbe desiderare di automatizzare il processo.
<p>
&Egrfave; abbastanza semplice attivare una procedura "crontab" che viene lanciata periodicamente (ad esempio
una volta al giorno) per utilizzare il programma <tt>wb.py</tt> con l'opportuna opzione, ad esempio:

<blockquote>
<tt>&gt; python /var/www/cgi-bin/wb.py -m myboard</tt>
</blockquote>

Dove "myboard" &egrave; il nome della bacheca. Il comando verifica tutti i documenti
e cancella quelli scaduti (inclusi gli eventuali allegati).

<h3>Ricerca di errori in WB</h3>

Quando qualche cosa non funziona, &egrave; possibile attivare le funzioni di
debug in due modi:

<ol>
<li> Potete fare una copia del file <tt>wb.py</tt> chiamandolo
    <tt>wt.py</tt> (noater la lettera "t" nel nome), e lanciarlo con
il nuovo nome (un "link" simbolico funziona altrettanto bene).

<li> Potete modificare il file <tt>wb.py</tt> e mettere ad 1 il valore
della variabile <tt>debug</tt> (non dimenticate di rimettere a 0
il valore dopo i test).
</ol>
<p>
Il programma <b>WB</b> in modo debug fornisce molte informazioni aggiuntive ed
inoltre abilita la funzione di "traceback" standard dei programmi CGI scritti
in Python.

