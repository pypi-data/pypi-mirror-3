

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started with Aglyph &mdash; Aglyph v1.1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Aglyph v1.1.0 documentation" href="index.html" />
    <link rel="next" title="Aglyph API reference" href="api-ref.html" />
    <link rel="prev" title="Aglyph — Dependency Injection for Python" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api-ref.html" title="Aglyph API reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Aglyph — Dependency Injection for Python"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Aglyph v1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started-with-aglyph">
<h1>Getting started with Aglyph<a class="headerlink" href="#getting-started-with-aglyph" title="Permalink to this headline">¶</a></h1>
<p>During this brief tutorial, you will download and install Aglyph, build a
simple Python application based on the <em>MovieLister</em> component discussed in
<a class="reference external" href="http://martinfowler.com/articles/injection.html">Inversion of Control Containers and the Dependency Injection pattern</a>, then modify the
application to take advantage of Aglyph dependency injection. This process will
allow you understand the Dependency Injection pattern in general, as well as
the Aglyph approach to Dependency Injection.</p>
<p>This tutorial is a &#8220;whirlwind tour&#8221; of Aglyph that covers only the basics. Once
you have completed the steps, please review the <a class="reference internal" href="api-ref.html"><em>Aglyph API reference</em></a> and the
<a class="reference download internal" href="_downloads/aglyph-context-1.0.0.dtd"><tt class="xref download docutils literal"><span class="pre">aglyph-context-1.0.0</span> <span class="pre">DTD</span></tt></a>
to understand the details.</p>
<p>The tutorial assumes that you are familiar with Python development in general,
and that Python 2.5+ is already installed. For an introduction to Python,
please see <a class="reference external" href="http://docs.python.org/py3k/tutorial/index.html">The Python Tutorial</a> (also, the free <a class="reference external" href="http://diveintopython.org/">Dive Into
Python</a> and <a class="reference external" href="http://diveintopython3.org/">Dive Into Python 3</a> books). Python can be downloaded from <a class="reference external" href="http://www.python.org/">Python
Programming Language – Official Website</a> (or just use
your preferred package installer, e.g. RPM).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is recommended, but not required, that you read the <a class="reference external" href="http://martinfowler.com/articles/injection.html">Inversion of
Control Containers and the Dependency Injection pattern</a> and <a class="reference external" href="http://www.aleax.it/yt_pydi.pdf">Python Dependency
Injection [PDF]</a> articles before
beginning this tutorial.</p>
</div>
<div class="section" id="download-and-install-aglyph">
<h2>1. Download and install Aglyph<a class="headerlink" href="#download-and-install-aglyph" title="Permalink to this headline">¶</a></h2>
<p>Download the latest <a class="reference external" href="http://docs.python.org/library/distutils.html#module-distutils" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">distutils</span></tt></a> source or built distribution of <a class="reference external" href="http://sourceforge.net/projects/aglyph/files/aglyph/">Aglyph on
SourceForge</a>.</p>
<p><strong>&#8212; OR &#8212;</strong></p>
<p>Clone the
<a class="reference external" href="https://bitbucket.org/mzipay/aglyph">Aglyph Mercurial repository from BitBucket</a>.</p>
<p>If you downloaded the source distribution, unpack it into a temporary directory
and then navigate into that directory. Issue the following command from a
terminal:</p>
<div class="highlight-python"><pre>python setup.py install</pre>
</div>
<p>If you downloaded a built distribution, install it using the appropriate
platform-specific tool.</p>
<p>If you cloned the repository from BitBucket, navigate into the root directory
of the repository and issue the following command from a terminal:</p>
<div class="highlight-python"><pre>python setup.py install</pre>
</div>
<p>Verify that the installation was successful by importing the <tt class="docutils literal"><span class="pre">aglyph</span></tt> module
from a Python interpreter. For example:</p>
<div class="highlight-python"><pre>$ python
Python 2.7.2 (default, Jul  8 2011, 14:08:55)
[GCC 4.2.1 (Apple Inc. build 5646) (dot 1)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import aglyph</pre>
</div>
</div>
<div class="section" id="download-extract-and-run-the-movielisterapp-application">
<h2>2. Download, extract, and run the <em>movielisterapp</em> application<a class="headerlink" href="#download-extract-and-run-the-movielisterapp-application" title="Permalink to this headline">¶</a></h2>
<p>The sample code for this tutorial can be downloaded
<a class="reference download internal" href="_downloads/movielisterapp-basic.zip"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>. Extract the ZIP
archive to a temporary location and navigate into the application directory:</p>
<div class="highlight-python"><pre>$ unzip movielisterapp-basic.zip
...
$ cd movielisterapp-basic</pre>
</div>
<p>The <em>movies.txt</em> file is a simple colon-delimited text file that contains a
number of <em>title:director</em> records, one per line:</p>
<div class="highlight-python"><pre>The Colossus of Rhodes:Sergio Leone
Once Upon a Time in the West:Sergio Leone
THX 1138:George Lucas
American Graffiti:George Lucas
Once Upon a Time in America:Sergio Leone
Sixteen Candles:John Hughes
The Breakfast Club:John Hughes
Weird Science:John Hughes
Ferris Bueller's Day Off:John Hughes</pre>
</div>
<p>This data file is read by a particular implementation of the <tt class="docutils literal"><span class="pre">MovieFinder</span></tt>
class (<tt class="docutils literal"><span class="pre">ColonDelimitedMovieFinder</span></tt>), both of which can be found in the
<tt class="docutils literal"><span class="pre">movies/finder.py</span></tt> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">movies.movie</span> <span class="kn">import</span> <span class="n">Movie</span>


<span class="k">class</span> <span class="nc">MovieFinder</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ColonDelimitedMovieFinder</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">)</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">movies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Movie</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span> <span class="o">=</span> <span class="n">movies</span>

    <span class="k">def</span> <span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span>
</pre></div>
</div>
<p>As you can see, each record is processed as a simple <tt class="docutils literal"><span class="pre">Movie</span></tt> data holder
object. The <tt class="docutils literal"><span class="pre">movies/movie.py</span></tt> module holds the <tt class="docutils literal"><span class="pre">Movie</span></tt> class definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Movie</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">director</span> <span class="o">=</span> <span class="n">director</span>
</pre></div>
</div>
<p>Finally, we have a <tt class="docutils literal"><span class="pre">MovieLister</span></tt> class (defined in the <tt class="docutils literal"><span class="pre">movies/lister.py</span></tt>
module), which uses a <tt class="docutils literal"><span class="pre">ColonDelimitedMovieFinder</span></tt> to find the movies directed
by a particular director:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">movies.finder</span> <span class="kn">import</span> <span class="n">ColonDelimitedMovieFinder</span>


<span class="k">class</span> <span class="nc">MovieLister</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finder</span> <span class="o">=</span> <span class="n">ColonDelimitedMovieFinder</span><span class="p">(</span><span class="s">&quot;movies.txt&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">movies_directed_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finder</span><span class="o">.</span><span class="n">find_all</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">director</span> <span class="o">==</span> <span class="n">director</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">movie</span>
</pre></div>
</div>
<p>The application can be executed using the <tt class="docutils literal"><span class="pre">app.py</span></tt> script, which simply asks
a <tt class="docutils literal"><span class="pre">MovieLister</span></tt> for all movies directed by &#8220;Sergio Leone&#8221;:</p>
<div class="highlight-python"><pre>$ python app.py
The Colossus of Rhodes
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
<div class="section" id="a-very-brief-introduction-to-dependency-injection">
<h3>A <em>(very)</em> brief introduction to Dependency Injection<a class="headerlink" href="#a-very-brief-introduction-to-dependency-injection" title="Permalink to this headline">¶</a></h3>
<p>Examine the <tt class="docutils literal"><span class="pre">MovieLister</span></tt> class (in the <tt class="docutils literal"><span class="pre">movies/lister.py</span></tt> module) again.
There are three things to note:</p>
<ol class="arabic simple">
<li>The <tt class="docutils literal"><span class="pre">MovieLister</span></tt> class depends on a concrete implementation of
<tt class="docutils literal"><span class="pre">MovieFinder</span></tt>.</li>
<li>The <tt class="docutils literal"><span class="pre">ColonDelimitedMovieFinder</span></tt> class depends on a filename.</li>
<li>The <tt class="docutils literal"><span class="pre">MovieLister</span></tt> is responsible for resolving <em>both</em> dependencies.</li>
</ol>
<p>As a consequence of (3), neither the concrete <tt class="docutils literal"><span class="pre">MovieFinder</span></tt> implementation
nor the name/location of the data file can be changed without modifying
<tt class="docutils literal"><span class="pre">MovieLister</span></tt>.</p>
<p>In other words, it is <tt class="docutils literal"><span class="pre">MovieLister</span></tt> that controls dependency
resolution. It is this aspect of control that is being inverted (&#8220;Inversion of
Control&#8221;) when we talk about <strong>Dependency Injection</strong>. Rather than having
<tt class="docutils literal"><span class="pre">MovieLister</span></tt> be responsible for <em>resolving</em> its dependencies, we instead
give control to some other object (an &#8220;assembler&#8221;), which has the
responsibility of <em>injecting</em> dependencies into <tt class="docutils literal"><span class="pre">MovieLister</span></tt>.</p>
<p>The dependency injection approach provides several benefits:</p>
<ul class="simple">
<li>easier testing (&#8220;mock&#8221; or &#8220;stub&#8221; objects for testing are easier to manage)</li>
<li>lower general maintenance cost (e.g. the manner in which application/domain
objects get initialized and connected to one another is &#8220;homogenized&#8221; in the
assembler&#8217;s configuration, which makes application-wide changes easier to
apply and test)</li>
<li>the separation of object <em>configuration</em> from object <em>use</em> means generally
smaller and simpler application code that is focused on object behavior</li>
</ul>
<p>Aglyph can inject dependencies using initializers &#8211; <tt class="docutils literal"><span class="pre">__init__</span></tt> methods &#8211; or
&#8220;factory&#8221; functions (type 2 &#8220;constructor&#8221; injection); or member variables,
setter methods, and properties (type 3 &#8220;setter&#8221; injection).</p>
<p>In order to take advantage of type 2 &#8220;constructor&#8221; injection, the <tt class="docutils literal"><span class="pre">__init__</span></tt>
method or &#8220;factory&#8221; function must <em>accept</em> dependencies, which means we need
to make some simple changes to <em>movielisterapp</em>...</p>
</div>
</div>
<div class="section" id="make-some-general-improvements-to-the-movielisterapp-application">
<h2>3. Make some general improvements to the <em>movielisterapp</em> application<a class="headerlink" href="#make-some-general-improvements-to-the-movielisterapp-application" title="Permalink to this headline">¶</a></h2>
<p>As written, the basic application is somewhat change-resistant. For example, if
we wish to support another implementation of <tt class="docutils literal"><span class="pre">MovieFinder</span></tt> (e.g. a
<tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt>), then we would also need to change the <tt class="docutils literal"><span class="pre">MovieLister</span></tt>
implementation.</p>
<p>A simple solution to this problem is to change <tt class="docutils literal"><span class="pre">MovieLister</span></tt> so that it can
<em>accept</em> a <tt class="docutils literal"><span class="pre">MovieFinder</span></tt> at initialization time:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MovieLister</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finder</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finder</span> <span class="o">=</span> <span class="n">finder</span>

    <span class="k">def</span> <span class="nf">movies_directed_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finder</span><span class="o">.</span><span class="n">find_all</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">director</span> <span class="o">==</span> <span class="n">director</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">movie</span>
</pre></div>
</div>
<p>Next, we&#8217;ll add the <tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> class definition to the
<tt class="docutils literal"><span class="pre">movies/finder.py</span></tt> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">movies.movie</span> <span class="kn">import</span> <span class="n">Movie</span>


<span class="k">class</span> <span class="nc">MovieFinder</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ColonDelimitedMovieFinder</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">)</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">movies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Movie</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span> <span class="o">=</span> <span class="n">movies</span>

    <span class="k">def</span> <span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span>


<span class="k">class</span> <span class="nc">CSVMovieFinder</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">)</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="n">movies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Movie</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">director</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span> <span class="o">=</span> <span class="n">movies</span>

    <span class="k">def</span> <span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_movies</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> expects a CSV filename. We&#8217;ll create <em>movies.csv</em> so
that it contains the same records as the original <em>movies.txt</em> file:</p>
<div class="highlight-python"><pre>The Colossus of Rhodes,Sergio Leone
Once Upon a Time in the West,Sergio Leone
THX 1138,George Lucas
American Graffiti,George Lucas
Once Upon a Time in America,Sergio Leone
Sixteen Candles,John Hughes
The Breakfast Club,John Hughes
Weird Science,John Hughes
Ferris Bueller's Day Off,John Hughes</pre>
</div>
<p>Finally, we&#8217;ll change <tt class="docutils literal"><span class="pre">app.py</span></tt> so that the new <tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> is used to
initialize a <tt class="docutils literal"><span class="pre">MovieLister</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">movies.finder</span> <span class="kn">import</span> <span class="n">CSVMovieFinder</span>
<span class="kn">from</span> <span class="nn">movies.lister</span> <span class="kn">import</span> <span class="n">MovieLister</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">MovieLister</span><span class="p">(</span><span class="n">CSVMovieFinder</span><span class="p">(</span><span class="s">&quot;movies.csv&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">movies_directed_by</span><span class="p">(</span><span class="s">&quot;Sergio Leone&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the application again should give us the same results:</p>
<div class="highlight-python"><pre>$ python app.py
The Colossus of Rhodes
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
<p>The basic application is now more flexible: we can change the <tt class="docutils literal"><span class="pre">MovieFinder</span></tt>
implementation without having to modify the <tt class="docutils literal"><span class="pre">MovieLister</span></tt> class definition.
However, we are still required to modify <tt class="docutils literal"><span class="pre">app.py</span></tt> if we decide to change the
<tt class="docutils literal"><span class="pre">MovieFinder</span></tt> implementation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>An important aspect of Aglyph is that it is <strong>non-intrusive</strong>, meaning that
it requires only minimal changes to your existing application code in order
to provide dependency injection capabilities.</p>
<p class="last">Notice that the changes made in this section, while adding flexibility to
the application, did not require the use of Aglyph. In fact, as we add
Aglyph dependency injection support in the next two sections, <em>no further
changes to the ``movies/lister.py``, ``movies/finder.py``, or
``movies/movie.py`` module need to be made.</em></p>
</div>
</div>
<div class="section" id="add-dependency-injection-support-to-the-movielisterapp-application">
<h2>4. Add Dependency Injection support to the <em>movielisterapp</em> application<a class="headerlink" href="#add-dependency-injection-support-to-the-movielisterapp-application" title="Permalink to this headline">¶</a></h2>
<p>Recall that Dependency Injection gives reponsibility for injecting dependencies
to an an external object (called an &#8220;assembler&#8221;). In Aglyph, this &#8220;assembler&#8221;
is defined by the <tt class="docutils literal"><span class="pre">aglyph.assembler.Assembler</span></tt> class.</p>
<p>An <tt class="docutils literal"><span class="pre">aglyph.assembler.Assembler</span></tt> requires a &#8220;context,&#8221; which is a collection
of component definitions. A <em>component definition</em> is simply a
description of some callable (an importable class or function), including its
dependencies. Any component can itself be a dependency of any other
component(s).</p>
<p>In Aglyph, a context is defined by the <tt class="docutils literal"><span class="pre">aglyph.context.Context</span></tt> class. A
specialized subclass, <tt class="docutils literal"><span class="pre">aglyph.context.XMLContext</span></tt>, is provided to allow a
context to be defined declaratively in an XML document. Such XML documents
must conform to the <a class="reference download internal" href="_downloads/aglyph-context-1.0.0.dtd"><tt class="xref download docutils literal"><span class="pre">aglyph-context-1.0.0</span> <span class="pre">DTD</span></tt></a>.</p>
<p>The <tt class="docutils literal"><span class="pre">aglyph.context.Context</span></tt> class may also be used directly to define a
context in pure Python. This approach requires the use of the
<tt class="docutils literal"><span class="pre">aglyph.component.Component</span></tt> class, and (optionally) one of more of:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">aglyph.component.Reference</span></tt> (used to indicate that a dependency refers to
another component in the same context)</li>
<li><tt class="docutils literal"><span class="pre">aglyph.component.Evaluator</span></tt> (similar to <a class="reference external" href="http://docs.python.org/library/functools.html#functools.partial" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">functools.partial()</span></tt></a>)</li>
<li><tt class="docutils literal"><span class="pre">aglyph.component.Strategy</span></tt> (used to control how an object of a component
is created)</li>
</ul>
<p class="versionchanged">
<span class="versionmodified">Changed in version 1.1.0: </span>The preferred approach to programmatic configuration is now
<a class="reference internal" href="aglyph.binder.html#aglyph.binder.Binder" title="aglyph.binder.Binder"><tt class="xref py py-class docutils literal"><span class="pre">aglyph.binder.Binder</span></tt></a>, which is more succinct than using
<tt class="docutils literal"><span class="pre">Context</span></tt> and <tt class="docutils literal"><span class="pre">Component</span></tt> directly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Using <tt class="docutils literal"><span class="pre">Context</span></tt> and <tt class="docutils literal"><span class="pre">Component</span></tt> directly is still supported (and, in
fact, <tt class="docutils literal"><span class="pre">Binder</span></tt> uses them internally). You can view <tt class="docutils literal"><span class="pre">Binder</span></tt> as a
&#8220;layer of abstraction&#8221; on top of <tt class="docutils literal"><span class="pre">Context</span></tt> and <tt class="docutils literal"><span class="pre">Component</span></tt>.</p>
</div>
<p>We will start by creating an Aglyph context for the <em>movielisterapp</em>
application. <strong>For illustrative purposes, both an XML context and a
pure-Python configuration will be created; in practice, one OR the other is
recommended.</strong></p>
<p>First, we&#8217;ll create the XML context document as <em>movies-context.xml</em>:</p>
<div class="highlight-python"><pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;context id="movies-context"&gt;
    &lt;component id="movies.finder.ColonDelimitedMovieFinder"&gt;
        &lt;init&gt;
            &lt;arg&gt;&lt;str&gt;movies.txt&lt;/str&gt;&lt;/arg&gt;
        &lt;/init&gt;
    &lt;/component&gt;
    &lt;component id="csv-finder" dotted-name="movies.finder.CSVMovieFinder"&gt;
        &lt;init&gt;
            &lt;arg&gt;&lt;str&gt;movies.csv&lt;/str&gt;&lt;/arg&gt;
        &lt;/init&gt;
    &lt;/component&gt;
    &lt;component id="movies.lister.MovieLister"&gt;
        &lt;init&gt;
            &lt;arg reference="csv-finder"/&gt;
        &lt;/init&gt;
    &lt;/component&gt;
&lt;/context&gt;</pre>
</div>
<p>Some interesting things to note here:</p>
<ul class="simple">
<li>A <tt class="docutils literal"><span class="pre">&lt;context&gt;</span></tt> requires an <tt class="docutils literal"><span class="pre">id</span></tt> attribute, which should uniquely identify
the context.</li>
<li>A <tt class="docutils literal"><span class="pre">&lt;component&gt;</span></tt> requires an <tt class="docutils literal"><span class="pre">id</span></tt> attribute, and has an optional
<tt class="docutils literal"><span class="pre">dotted-name</span></tt> attribute (as well as an optional <tt class="docutils literal"><span class="pre">strategy</span></tt> attribute,
which will be covered later). If <tt class="docutils literal"><span class="pre">dotted-name</span></tt> is not provided, then the
<tt class="docutils literal"><span class="pre">id</span></tt> attribute is assumed to be a dotted-name; otherwise, the <tt class="docutils literal"><span class="pre">id</span></tt> can
be a user-defined identifier and the <tt class="docutils literal"><span class="pre">dotted-name</span></tt> <strong>must</strong> be provided
(this is useful when describing multiple components of the same class, for
example). A <em>dotted-name</em> is a string that represents an <strong>importable</strong> class
or function.</li>
<li>Initialization arguments are provided as <tt class="docutils literal"><span class="pre">&lt;arg&gt;</span></tt> elements in an <tt class="docutils literal"><span class="pre">&lt;init&gt;</span></tt>
section. An <tt class="docutils literal"><span class="pre">&lt;arg&gt;</span></tt> is a postional argument (the order in which they&#8217;re
defined in the XML is significant!), while an <tt class="docutils literal"><span class="pre">&lt;arg</span> <span class="pre">keyword=&quot;...&quot;&gt;</span></tt> is a
keyword argument.</li>
</ul>
<p>Notice that the <em>movies.lister.MovieLister</em> component is being injected with a
reference to the <em>csv-finder</em> component, which describes an instance of
<tt class="docutils literal"><span class="pre">movies.finder.CSVMovieFinder</span></tt>. We could easily change back to using
<tt class="docutils literal"><span class="pre">movies.finder.ColonDelimitedMovieFinder</span></tt> by changing the reference.</p>
<p>Next, we&#8217;ll create the pure-Python configuration as the <tt class="docutils literal"><span class="pre">MoviesBinder</span></tt> class
(a subclass of <tt class="docutils literal"><span class="pre">aglyph.binder.Binder</span></tt>) in the <tt class="docutils literal"><span class="pre">movies/__init__.py</span></tt> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">aglyph.binder</span> <span class="kn">import</span> <span class="n">Binder</span>

<span class="kn">from</span> <span class="nn">movies.lister</span> <span class="kn">import</span> <span class="n">MovieLister</span>
<span class="kn">from</span> <span class="nn">movies.finder</span> <span class="kn">import</span> <span class="n">MovieFinder</span><span class="p">,</span> <span class="n">CSVMovieFinder</span>


<span class="k">class</span> <span class="nc">MoviesBinder</span><span class="p">(</span><span class="n">Binder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MoviesBinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&quot;movies-binder&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">MovieLister</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">CSVMovieFinder</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;movies.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some interesting things to note here:</p>
<ul class="simple">
<li>When we bind <tt class="docutils literal"><span class="pre">MovieLister</span></tt>, we don&#8217;t bind it <strong>to</strong> anything. Why? Python
does not support interfaces as a language construct (mixins and <a class="reference external" href="http://docs.python.org/library/abc.html#module-abc" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">abc</span></tt></a>
are the alternatives). So in this case, <tt class="docutils literal"><span class="pre">MovieLister</span></tt> actually serves as
<em>both</em> the &#8220;interface&#8221; and the implementation. Duck-typing means that
&#8220;anything that looks like a MovieLister and acts like a MovieLister&#8221; should
be treated <em>as</em> a <tt class="docutils literal"><span class="pre">MovieLister</span></tt>. We could just as easily create a
specialized subclass (say, <tt class="docutils literal"><span class="pre">FancyMovieLister</span></tt>) and then bind <em>it</em> to
<tt class="docutils literal"><span class="pre">MovieLister</span></tt> using <tt class="docutils literal"><span class="pre">bind(MovieLister,</span> <span class="pre">FancyMovieLister)</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">MovieFinder</span></tt> can&#8217;t be used on its own (it&#8217;s a pre-<a class="reference external" href="http://docs.python.org/library/abc.html#module-abc" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">abc</span></tt></a> abstract base
class), and so we bind it to our preferred implementation,
<tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt>.</li>
<li>The <a class="reference internal" href="aglyph.binder.html#aglyph.binder.Binder.bind" title="aglyph.binder.Binder.bind"><tt class="xref py py-meth docutils literal"><span class="pre">aglyph.binder.Binder.bind()</span></tt></a> method returns a proxy object that
allows us to specify the initialization (constructor) dependencies. The
dependencies are provided according to the signature of the initializer;
<tt class="docutils literal"><span class="pre">Binder</span></tt> knows that a class or function passed as a dependency refers to
another bound component.</li>
</ul>
<p>Take a minute to examine the XML context and the pure-Python configuration;
they will produce <em>identical</em> results. Each will inject the string
<em>&#8220;movies.csv&#8221;</em> into a <tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt>, and then inject the
<tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> instance into a <tt class="docutils literal"><span class="pre">MovieLister</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Aglyph assembles components according to a <em>strategy</em> (sometimes called a
&#8220;scope&#8221;). Aglyph supports three strategies:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">Strategy.PROTOTYPE</span></tt> = <em>&#8220;prototype&#8221;</em></dt>
<dd>a new object is always be created</dd>
<dt><tt class="docutils literal"><span class="pre">Strategy.SINGLETON</span></tt> = <em>&#8220;singleton&#8221;</em></dt>
<dd>only one obejct is created; this object is cached by the assembler</dd>
<dt><tt class="docutils literal"><span class="pre">Strategy.BORG</span></tt> = <em>&#8220;borg&#8221;</em></dt>
<dd>a new object is always created; however, the internal state is cached
by the assembler and then assigned directly to the <tt class="docutils literal"><span class="pre">__dict__</span></tt> of all
new objects</dd>
</dl>
<p>The assembly strategy for a component may be specified in the XML
context or in pure Python. The following examples define a singleton
component.</p>
<p>In XML:</p>
<div class="highlight-python"><pre>&lt;component id="the-object" dotted-name="builtins.object" strategy="singleton"/&gt;</pre>
</div>
<p>In Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Binder</span><span class="p">()</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;the-object&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="nb">object</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s">&quot;singleton&quot;</span><span class="p">)</span>
<span class="c"># -or-</span>
<span class="n">Component</span><span class="p">(</span><span class="s">&quot;the-object&quot;</span><span class="p">,</span> <span class="s">&quot;__builtin__.object&quot;</span><span class="p">,</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">SINGLETON</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">If a strategy is not explicitly specified as part of the component
definition, the default strategy is <strong>prototype</strong>.</p>
</div>
<p>Now that we have created a context for <em>movielisterapp</em>, it&#8217;s time to modify
the <tt class="docutils literal"><span class="pre">app.py</span></tt> script to use dependency injection. To demonstrate the use of
both an XML context and a pure-Python configuration, we&#8217;ll create two different
&#8220;run&#8221; scripts.</p>
<p>The <tt class="docutils literal"><span class="pre">app_xmlcontext.py</span></tt> script will use the XML context:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">aglyph.assembler</span> <span class="kn">import</span> <span class="n">Assembler</span>
<span class="kn">from</span> <span class="nn">aglyph.context</span> <span class="kn">import</span> <span class="n">XMLContext</span>

<span class="n">assembler</span> <span class="o">=</span> <span class="n">Assembler</span><span class="p">(</span><span class="n">XMLContext</span><span class="p">(</span><span class="s">&quot;movies-context.xml&quot;</span><span class="p">))</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">assembler</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="s">&quot;movies.lister.MovieLister&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">movies_directed_by</span><span class="p">(</span><span class="s">&quot;Sergio Leone&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><em>IronPython</em> developers will need to create a slightly different
<tt class="docutils literal"><span class="pre">app_xmlcontext.py</span></tt> script:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">aglyph.assembler</span> <span class="kn">import</span> <span class="n">Assembler</span>
<span class="kn">from</span> <span class="nn">aglyph.compat.ipyetree</span> <span class="kn">import</span> <span class="n">XmlReaderTreeBuilder</span>
<span class="kn">from</span> <span class="nn">aglyph.context</span> <span class="kn">import</span> <span class="n">XMLContext</span>

<span class="n">assembler</span> <span class="o">=</span> <span class="n">Assembler</span><span class="p">(</span><span class="n">XMLContext</span><span class="p">(</span><span class="s">&quot;movies-context.xml&quot;</span><span class="p">,</span>
                                 <span class="n">parser</span><span class="o">=</span><span class="n">XmlReaderTreeBuilder</span><span class="p">()))</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">assembler</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="s">&quot;movies.lister.MovieLister&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">movies_directed_by</span><span class="p">(</span><span class="s">&quot;Sergio Leone&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">This is necessary because of the way that <em>IronPython</em> treats Unicode
strings. See <a class="reference internal" href="aglyph.compat.ipyetree.html#module-aglyph.compat.ipyetree" title="aglyph.compat.ipyetree"><tt class="xref py py-mod docutils literal"><span class="pre">aglyph.compat.ipyetree</span></tt></a> for details.</p>
</div>
<p>This script creates an assembler with a context that is read from the
<em>movies-conext.xml</em> XML document. Notice that we no longer need to create the
<tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> class directly; we have effectively separated the
configuration of <tt class="docutils literal"><span class="pre">MovieLister</span></tt> from its use in the application.</p>
<p>Running the application produces the same results as usual:</p>
<div class="highlight-python"><pre>$ python app_xmlcontext.py
The Colossus of Rhodes
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">app_binder.py</span></tt> script will use the pure-Python configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">movies</span> <span class="kn">import</span> <span class="n">MoviesBinder</span>
<span class="kn">from</span> <span class="nn">movies.lister</span> <span class="kn">import</span> <span class="n">MovieLister</span>

<span class="n">binder</span> <span class="o">=</span> <span class="n">MoviesBinder</span><span class="p">()</span>
<span class="n">lister</span> <span class="o">=</span> <span class="n">binder</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">MovieLister</span><span class="p">)</span>
<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">lister</span><span class="o">.</span><span class="n">movies_directed_by</span><span class="p">(</span><span class="s">&quot;Sergio Leone&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">movie</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we create the binder and then use it to look up the concrete
implementation of <tt class="docutils literal"><span class="pre">MovieLister</span></tt> that we have configured.</p>
<p>Again, running the application produces the expected results:</p>
<div class="highlight-python"><pre>$ python app_binder.py
The Colossus of Rhodes
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
</div>
<div class="section" id="make-changes-to-the-movielisterapp-application">
<h2>5. Make changes to the <em>movielisterapp</em> application<a class="headerlink" href="#make-changes-to-the-movielisterapp-application" title="Permalink to this headline">¶</a></h2>
<p>Now that the application is configured to use Aglyph for dependency injection,
let&#8217;s make some changes to demonstrate application maintenance under Aglyph.</p>
<p>First, we note that both the <tt class="docutils literal"><span class="pre">ColonDelimitedMovieFinder</span></tt> and
<tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt> classes read and parse their respective data files on every
initialization. We don&#8217;t expect the data files to change very often, at least
not during application runtime, so we&#8217;d prefer to only create either of these
objects <em>once</em>. (For the moment, preted that <em>movielisterapp</em> is a useful
application in which <tt class="docutils literal"><span class="pre">MovieFinder</span></tt> objects are used by more than just a
<tt class="docutils literal"><span class="pre">MovieLister</span></tt> ;))</p>
<p>To accomplish this goal, we&#8217;ll modify the XML context so that the
<em>movies.finder.ColonDelimitedMovieFinder</em> and <em>csv-finder</em> components use the
<strong>singleton</strong> assembly strategy.</p>
<p>Recall that singleton assembly means only
<em>one</em> object is created by Aglyph, and then cached. Subsequent assembly
requests for the same component will return the cached object.</p>
<p>Also, we&#8217;ll change the <em>movies.lister.MovieLister</em> component so that it uses
the original <tt class="docutils literal"><span class="pre">ColonDelimitedMovieFinder</span></tt> class instead of <tt class="docutils literal"><span class="pre">CSVMovieFinder</span></tt>.</p>
<p>The modified XML context looks like this:</p>
<div class="highlight-python"><pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;context id="movies-context"&gt;
    &lt;component id="movies.finder.ColonDelimitedMovieFinder"
            strategy="singleton"&gt;
        &lt;init&gt;
            &lt;arg&gt;&lt;str&gt;movies.txt&lt;/str&gt;&lt;/arg&gt;
        &lt;/init&gt;
    &lt;/component&gt;
    &lt;component id="csv-finder" dotted-name="movies.finder.CSVMovieFinder"
            strategy="singleton"&gt;
        &lt;init&gt;
            &lt;arg&gt;&lt;str&gt;movies.csv&lt;/str&gt;&lt;/arg&gt;
        &lt;/init&gt;
    &lt;/component&gt;
    &lt;component id="movies.lister.MovieLister"&gt;
        &lt;init&gt;
            &lt;arg reference="movies.finder.ColonDelimitedMovieFinder"/&gt;
        &lt;/init&gt;
    &lt;/component&gt;
&lt;/context&gt;</pre>
</div>
<p>Running the application still produces the expected results:</p>
<div class="highlight-python"><pre>$ python app_xmlcontext.py
The Colossus of Rhodes
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
<p>To make the same change using the pure-Python configuration, the
<tt class="docutils literal"><span class="pre">MoviesBinder</span></tt> configuration class would be changed like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">aglyph.binder</span> <span class="kn">import</span> <span class="n">Binder</span>

<span class="kn">from</span> <span class="nn">movies.lister</span> <span class="kn">import</span> <span class="n">MovieLister</span>
<span class="kn">from</span> <span class="nn">movies.finder</span> <span class="kn">import</span> <span class="n">MovieFinder</span><span class="p">,</span> <span class="n">ColonDelimitedMovieFinder</span>


<span class="k">class</span> <span class="nc">MoviesBinder</span><span class="p">(</span><span class="n">Binder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MoviesBinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&quot;movies-binder&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">MovieLister</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">MovieFinder</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">ColonDelimitedMovieFinder</span><span class="p">,</span>
                  <span class="n">strategy</span><span class="o">=</span><span class="s">&quot;singleton&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;movies.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, running the application one last time produces the expected results:</p>
<div class="highlight-python"><pre>$ python app_binder.py
Once Upon a Time in the West
Once Upon a Time in America</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The key point of this final exercise is that we were able to make
&#8220;significant&#8221; changes without having to modify the application code itself.
This is possible because we have <em>separated the configuration of objects
from their use</em>; this is the goal of Depdendency Injection.</p>
</div>
</div>
<div class="section" id="suggested-next-steps">
<h2>6. Suggested next steps<a class="headerlink" href="#suggested-next-steps" title="Permalink to this headline">¶</a></h2>
<p>The final modified version of the <em>movielisterapp</em> application can be
downloaded <a class="reference download internal" href="_downloads/movielisterapp-aglyph.zip"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a> as a
reference.</p>
<p>There are many more context/configuration options available in Aglyph beyond
those that have been presented in this tutorial, including support for type 2
&#8220;setter&#8221; injection using member variables, setter methods, and properties
(which can also be combined with the type 3 &#8220;constructor&#8221; injection used in
the <em>movielisterapp</em> sample application).</p>
<p>Suggested next steps:</p>
<ol class="arabic simple">
<li>Read the <a class="reference internal" href="api-ref.html"><em>Aglyph API reference</em></a>.</li>
<li>Read the <a class="reference download internal" href="_downloads/aglyph-context-1.0.0.dtd"><tt class="xref download docutils literal"><span class="pre">aglyph-context-1.0.0</span> <span class="pre">DTD</span></tt></a>. The DTD is fully commented, and
explains some of the finer points of using XML configuration.</li>
<li>Read the <a class="reference internal" href="cookbook.html"><em>Aglyph cookbook</em></a>.</li>
<li>Examine the Aglyph test cases (part of the distribution; located in the
<em>tests/</em> directory).</li>
<li>Start with either the <a class="reference download internal" href="_downloads/movielisterapp-basic.zip"><tt class="xref download docutils literal"><span class="pre">movielisterapp-basic</span></tt></a> or
<a class="reference download internal" href="_downloads/movielisterapp-aglyph.zip"><tt class="xref download docutils literal"><span class="pre">movielisterapp-aglyph</span></tt></a> applications and make your own
modifications to explore the features of Aglyph.</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting started with Aglyph</a><ul>
<li><a class="reference internal" href="#download-and-install-aglyph">1. Download and install Aglyph</a></li>
<li><a class="reference internal" href="#download-extract-and-run-the-movielisterapp-application">2. Download, extract, and run the <em>movielisterapp</em> application</a><ul>
<li><a class="reference internal" href="#a-very-brief-introduction-to-dependency-injection">A <em>(very)</em> brief introduction to Dependency Injection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#make-some-general-improvements-to-the-movielisterapp-application">3. Make some general improvements to the <em>movielisterapp</em> application</a></li>
<li><a class="reference internal" href="#add-dependency-injection-support-to-the-movielisterapp-application">4. Add Dependency Injection support to the <em>movielisterapp</em> application</a></li>
<li><a class="reference internal" href="#make-changes-to-the-movielisterapp-application">5. Make changes to the <em>movielisterapp</em> application</a></li>
<li><a class="reference internal" href="#suggested-next-steps">6. Suggested next steps</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Aglyph &#8212; Dependency Injection for Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="api-ref.html"
                        title="next chapter">Aglyph API reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/get-started.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api-ref.html" title="Aglyph API reference"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Aglyph — Dependency Injection for Python"
             >previous</a> |</li>
        <li><a href="index.html">Aglyph v1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2011, Matthew Zipay.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>