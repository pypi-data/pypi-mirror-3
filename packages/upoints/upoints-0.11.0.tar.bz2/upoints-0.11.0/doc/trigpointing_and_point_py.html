<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>Trigpointing and point.py</title>
<link rel="stylesheet" href="docutils.css" type="text/css" />
</head>
<body>
<div class="document" id="trigpointing-and-point-py">
<h1 class="title">Trigpointing and point.py</h1>
<p>One interesting email I received after posting <a class="reference" href="geolocation_and_pathcross.html">geolocation and path
cross</a> asked if the module could be used for quick visualisation when
trigpointing.  Now that I've found out what trigpointing is I believe it
can, and I've added a couple of extra features to make it easier for
trigpointers to use the old <tt class="docutils literal"><span class="pre">edist.py</span></tt> script.</p>
<p>Firstly, for those who don't know, trigpointing is the activity of
tracking down trigpoints and recording them.  I guess you could make
a parallel to trainspotting, but with a navigational slant.  Some people
apparently use GPS units to track down the trigpoints, that I'd
suggest makes it just hiking with trigpoints as waypoints.  And some
people, like Robert Johnson who mailed me, prefer to do the navigation
with just an ordnance survey map and a compass which in my eyes makes it
a little more interesting.  Also, a few sites I've found with <a class="reference" href="http://www.google.com/">Google</a>
seem to suggest that many trigpointers like to use triangulation,
although I suspect some mean trilateration, to travel between trigpoints
as a navigational challenge.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">Robert tells me that <a class="reference" href="http://www.trigpointinguk.com/">TrigpointingUK</a> is a popular website among
trigpointers in the UK.  It contains information about many of the
trigpoints you can find, such as the one closest to me at <a class="reference" href="http://www.trigpointinguk.com/trigs/trig-details.php?t=1830">Bygrave</a></p>
</div>
<p>Anybody who knows me well will attest that that I'm quite the navigation
geek, mostly just as a curiosity being that what we're really talking
about is just applications of specific branches of math.  As such,
I actually find the concept of trigpointing by hand quite intriguing.
That being said technology is here to assist us, and with that let me
introduce <tt class="docutils literal"><span class="pre">trigpoints.py</span></tt> a simple extension over the original
<tt class="docutils literal"><span class="pre">edist.py</span></tt> script.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">from</span> <span class="nn">upoints</span> <span class="k">import</span> <span class="n">trigpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">database_location</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.haroldstreet.org.uk/waypoints/alltrigs-wgs84.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Trigpoints</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">Trigpoints</span><span class="p">(</span><span class="n">database_location</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Trigpoints</span><span class="p">))</span>
<span class="go">6557</span>
</pre></div>
<p>Thanks to <a class="reference" href="http://www.haroldstreet.org.uk/trigpoints.php">the online database</a> we now have the locations of all the
Ordnance Survey trigpoints in an easy to use format -- a <a class="reference" href="http://www.python.org/">Python</a>
dictionary.</p>
<p>If I'd like to see trigpoints close to me, say within 20kM, and less
than 60m above sea level I could tap the following in to my <a class="reference" href="http://ipython.scipy.org/">IPython</a>
session:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Home</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mf">52.015</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.221</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span> <span class="ow">in</span> <span class="n">sorted</span><span class="p">(</span><span class="n">Trigpoints</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">Home</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">trigpoint</span><span class="p">,</span> <span class="mf">20</span><span class="p">)</span> <span class="ow">and</span> <span class="n">trigpoint</span><span class="o">.</span><span class="n">altitude</span> <span class="o">&lt;</span> <span class="mf">60</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> - </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span><span class="p">))</span>
<span class="go">500936 - Broom Farm (52°03&#39;57&quot;N, 000°16&#39;53&quot;W alt 37m)</span>
<span class="go">501822 - Crane Hill (52°11&#39;10&quot;N, 000°14&#39;51&quot;W alt 58m)</span>
<span class="go">503750 - Limlow Hill (52°03&#39;31&quot;N, 000°04&#39;20&quot;W alt 59m)</span>
<span class="go">505681 - Sutton (52°06&#39;24&quot;N, 000°11&#39;57&quot;W alt 55m)</span>
</pre></div>
<p>Or we can display all the trigpoints within a given region. For example,
to show trigpoints within the region from 51°52'15&quot;N, 000°28'29&quot;W to
52°09'07&quot;N, 000°01'52&quot;W.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">latitude_min</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_dd</span><span class="p">(</span><span class="mf">51</span><span class="p">,</span> <span class="mf">52</span><span class="p">,</span> <span class="mf">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_min</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_dd</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">28</span><span class="p">,</span> <span class="o">-</span><span class="mf">29</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latitude_max</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_dd</span><span class="p">(</span><span class="mf">52</span><span class="p">,</span> <span class="mf">9</span><span class="p">,</span> <span class="mf">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_max</span> <span class="o">=</span> <span class="n">trigpoints</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_dd</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">52</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span> <span class="ow">in</span> <span class="n">sorted</span><span class="p">(</span><span class="n">Trigpoints</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">latitude_min</span> <span class="o">&lt;</span> <span class="n">trigpoint</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="n">latitude_max</span> \
<span class="gp">... </span>      <span class="ow">and</span> <span class="n">longitude_min</span> <span class="o">&lt;</span> <span class="n">trigpoint</span><span class="o">.</span><span class="n">longitude</span> <span class="o">&lt;</span> <span class="n">longitude_max</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> - </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span><span class="p">))</span>
<span class="go">500928 - Bromley Common (51°52&#39;17&quot;N, 000°06&#39;14&quot;W alt 118m)</span>
<span class="go">500936 - Broom Farm (52°03&#39;57&quot;N, 000°16&#39;53&quot;W alt 37m)</span>
<span class="go">501097 - Bygrave (52°00&#39;38&quot;N, 000°10&#39;24&quot;W alt 97m)</span>
<span class="go">501417 - Cherrys Green (51°55&#39;13&quot;N, 000°01&#39;52&quot;W alt 126m)</span>
<span class="go">501428 - Chicksands North Radio Mast (52°02&#39;46&quot;N, 000°22&#39;17&quot;W alt 62m)</span>
<span class="go">501928 - Croydon Hill (52°07&#39;37&quot;N, 000°05&#39;26&quot;W alt 78m)</span>
<span class="go">502034 - Deacon Hill (51°57&#39;19&quot;N, 000°21&#39;46&quot;W alt 173m)</span>
<span class="go">502908 - Hammer Hill Farm (52°04&#39;32&quot;N, 000°24&#39;05&quot;W alt 89m)</span>
<span class="go">503138 - Higham Gobion (51°58&#39;48&quot;N, 000°23&#39;55&quot;W alt 75m)</span>
<span class="go">503750 - Limlow Hill (52°03&#39;31&quot;N, 000°04&#39;20&quot;W alt 59m)</span>
<span class="go">503774 - Little Easthall Farm (51°53&#39;23&quot;N, 000°15&#39;23&quot;W alt 140m)</span>
<span class="go">504024 - Marsh Farm Mh (51°55&#39;24&quot;N, 000°27&#39;39&quot;W alt 152m)</span>
<span class="go">505392 - Sish Lane (51°54&#39;39&quot;N, 000°11&#39;11&quot;W alt 136m)</span>
<span class="go">505681 - Sutton (52°06&#39;24&quot;N, 000°11&#39;57&quot;W alt 55m)</span>
<span class="go">505852 - Therfield (52°01&#39;03&quot;N, 000°03&#39;38&quot;W alt 168m)</span>
<span class="go">506163 - Warden Hill (51°55&#39;20&quot;N, 000°24&#39;53&quot;W alt 195m)</span>
<span class="go">506165 - Warden Tunnel (52°05&#39;15&quot;N, 000°22&#39;30&quot;W alt 84m)</span>
</pre></div>
<p>Or we could generate a file to use with xearth that contains all the
trigpoints above 1000m above sea level:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">from</span> <span class="nn">upoints.utils</span> <span class="k">import</span> <span class="n">dump_xearth_markers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high_markers</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span> <span class="ow">in</span> <span class="n">Trigpoints</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">trigpoint</span><span class="o">.</span><span class="n">altitude</span> <span class="o">&gt;</span> <span class="mf">1000</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">high_markers</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">trigpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;high_markers.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dump_xearth_markers</span><span class="p">(</span><span class="n">high_markers</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<div class="figure">
<a class="reference image-reference" href="http://www.jnrowe.ukfsn.org/graphics/Scotland_trigpoints.png"><img alt="xearth showing trigpoints higher than 1000m in Scotland" src="http://www.jnrowe.ukfsn.org/graphics/Scotland_trigpoints_mini.png" style="width: 192px; height: 192px;" /></a>
</div>
<p>Now we can use <a class="reference" href="http://www.cs.colorado.edu/~tuna/xearth/">xearth</a>, or <a class="reference" href="http://xplanet.sourceforge.net/">xplanet</a>, to visualise the trigpoints that
are higher than 1000m.  If you start xearth with the command <tt class="docutils literal"><span class="pre">xearth</span>
<span class="pre">-pos</span> <span class="pre">&quot;fixed</span> <span class="pre">57</span> <span class="pre">-4&quot;</span> <span class="pre">-mag</span> <span class="pre">25</span> <span class="pre">-noroot</span> <span class="pre">-markerfile</span> <span class="pre">high_markers.txt</span></tt> you
will see an image similar to the one on the right.</p>
<p>You could of course use <tt class="docutils literal"><span class="pre">dump_xearth_markers()</span></tt> to dump the entire
trigpoint database, but with over 6000 locations the result is just
going to be a sea of blurred text when rendered.</p>
<p>And it is possible to fold the generation of the <tt class="docutils literal"><span class="pre">high_markers</span></tt>
dictionary in to a single operation using lambda expressions and
<tt class="docutils literal"><span class="pre">filter()</span></tt> such as:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">high_markers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">altitude</span> <span class="o">&gt;</span> <span class="mf">1000</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">Trigpoints</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</pre></div>
<p>However, you opinion on whether this is cleaner or not depends a lot on
your background.  If only you could run <tt class="docutils literal"><span class="pre">filter()</span></tt> on a dictionary
directly, this would definitely be the better solution.  I'm going to
continue using the unrolled version on this page because it seems more
people are comfortable with them in spite of me favouring the
<tt class="docutils literal"><span class="pre">filter()</span></tt> and <tt class="docutils literal"><span class="pre">lambda</span></tt> version, but it is just a matter of taste
and yours may vary.</p>
<p>Using <tt class="docutils literal"><span class="pre">trigpoints.py</span></tt> you could generate marker file for locations
with an altitude of between 900m and 910m using their location names as
labels.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">display_markers</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">trigpoint</span> <span class="ow">in</span> <span class="n">Trigpoints</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="mf">900</span> <span class="o">&lt;</span> <span class="n">trigpoint</span><span class="o">.</span><span class="n">altitude</span> <span class="o">&lt;</span> <span class="mf">910</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">display_markers</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">trigpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;display_markers.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dump_xearth_markers</span><span class="p">(</span><span class="n">display_markers</span><span class="p">,</span>
<span class="gp">... </span>                                           <span class="s">&quot;name&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>The result of how that query could be shown with xplanet can be found to the
right.</p>
<div class="figure">
<a class="reference image-reference" href="http://www.jnrowe.ukfsn.org/graphics/ranged_trigpoints.png"><img alt="xplanet showing trigpoints with altitudes in the range 900-910m" src="http://www.jnrowe.ukfsn.org/graphics/ranged_trigpoints_mini.png" style="width: 192px; height: 192px;" /></a>
</div>
<p>The <tt class="docutils literal"><span class="pre">Trigpoint</span></tt> class inherits from the <tt class="docutils literal"><span class="pre">Point</span></tt> class in
<tt class="docutils literal"><span class="pre">point.py</span></tt>, and therefore has all the same methods it does.  You can
calculate distances and bearings between trigpoints.  I suggest reading
the HTML files generated by <a class="reference" href="http://epydoc.sourceforge.net/">epydoc</a> that are included in the
tarball to see how it all works, including some more examples.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">And on a slight tangent, in my mind one of the best reasons for using
Python is now evident, <a class="reference" href="http://www.nokia.com/">Nokia</a> provide Python builds for some of their
&quot;smartphone&quot; handsets.  This means it is possible to use
<tt class="docutils literal"><span class="pre">trigpoints.py</span></tt> on the move using only the mobile phone in your
pocket, and it makes for a fun diversion from Snake 3D.  Even as
a simple database it can be surprisingly useful, especially given the
difficulty of finding the minuscule trigpoint symbol on Ordnance
Survey's Explorer series maps.</p>
</div>
<p>We're on a journey now, so if you can think of any cool uses for any of
the classes and functions in the <tt class="docutils literal"><span class="pre">upoints</span></tt> tarball drop me a mail.</p>
<!-- :vim: set ft=rst ts=2 sw=2 et: -->
</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="trigpointing_and_point_py.txt">View document source</a>.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>
