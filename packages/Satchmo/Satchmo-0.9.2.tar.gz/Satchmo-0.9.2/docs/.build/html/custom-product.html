

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Custom Product Modules &mdash; Satchmo v0.9.2-development documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.2-development',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Satchmo v0.9.2-development documentation" href="index.html" />
    <link rel="next" title="Translating Content" href="translation.html" />
    <link rel="prev" title="Custom Product Attributes" href="product-attributes.html" /> 
  </head>
  <body>

<div style="background-image: url(_static/satchmo-sliver.jpg); background-repeat: repeat-x; background-color: white; text-align: left;">
<img src="_static/satchmo-front.jpg">
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="translation.html" title="Translating Content"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="product-attributes.html" title="Custom Product Attributes"
             accesskey="P">previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Custom Product Modules</a><ul>
<li><a class="reference internal" href="#building-your-module">Building your module</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#extending-the-model-and-templates">Extending the model and templates</a></li>
<li><a class="reference internal" href="#using-model-inheritance">Using model inheritance</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="product-attributes.html"
                        title="previous chapter">Custom Product Attributes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="translation.html"
                        title="next chapter">Translating Content</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<p>Documentation Version:</p>
<ul>
    <li><a href="/docs/dev">Current development version</a></li>
    <li><a href="/docs/rel/latest">Latest Release version</a></li>
    <li><a href="http://bitbucket.org/chris1610/satchmo/downloads/Satchmo-0-9-1.pdf">PDF Documentation</a></li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="custom-product-modules">
<span id="id1"></span><h1>Custom Product Modules<a class="headerlink" href="#custom-product-modules" title="Permalink to this headline">¶</a></h1>
<p>Though Satchmo includes a number of versatile product types, many projects have
needs that are best met by creating a custom product module. A custom product
module is a module with a product model which deviates from the normal behavior
of Satchmo.</p>
<p>To work with custom product modules, you will need a basic understanding of
Django apps, projects, and templates. You should understand the default
behavior of Satchmo before trying to customize it.</p>
<div class="section" id="building-your-module">
<h2>Building your module<a class="headerlink" href="#building-your-module" title="Permalink to this headline">¶</a></h2>
<p>In a custom product module, most of the work is done in the
<tt class="docutils literal"><span class="pre">models.py</span></tt> and template files. You will also need an <tt class="docutils literal"><span class="pre">admin.py</span></tt>
file like for any other model which shall be available in the
admin. This section contains several example files that you can add to
a new or existing app and extend.</p>
<p>A basic <tt class="docutils literal"><span class="pre">models.py</span></tt> file with a custom product model looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">product.models</span> <span class="kn">import</span> <span class="n">Product</span>

<span class="n">SATCHMO_PRODUCT</span><span class="o">=</span><span class="bp">True</span>

<span class="k">def</span> <span class="nf">get_product_types</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a tuple of all product subtypes this app adds</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="s">&#39;MyNewProduct&#39;</span><span class="p">,</span> <span class="p">)</span>

<span class="k">class</span> <span class="nc">MyNewProduct</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">product</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Product</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Product&#39;</span><span class="p">),</span>
        <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_subtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Has to return the name of the product subtype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&#39;MyNewProduct&#39;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&quot;MyNewProduct: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;My New Product&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;My New Products&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The important parts are the attribute <tt class="xref py py-attr docutils literal"><span class="pre">MyNewProduct.product</span></tt>
which links to the related <tt class="xref py py-class docutils literal"><span class="pre">product.models.Product</span></tt> and the
method <tt class="xref py py-meth docutils literal"><span class="pre">MyNewProduct._get_subtype()</span></tt> which returns a string
representation of this model.</p>
<p>The function <tt class="xref py py-func docutils literal"><span class="pre">get_product_types()</span></tt> returns a list of all custom
product models this app adds. This method is used to discover the
custom product models from all installed apps.</p>
<p>This is the corresponding <tt class="docutils literal"><span class="pre">admin.py</span></tt> file. This file is needed to make your
models visible in Django&#8217;s admin app:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">MyNewProduct</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyNewProduct</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Once you&#8217;ve created the above files in your app, you have all the code
necessary to use your new product model in Satchmo. All that&#8217;s left is the
configuration.</p>
<ol class="arabic simple">
<li>Make sure that the app with your product model is in your project&#8217;s
<tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> setting.</li>
<li>Run <tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">syncdb</span></tt> in your project directory.</li>
</ol>
<p>You can now use the new product model in the same way that you would use one
of Satchmo&#8217;s default product types. You will find an &#8220;Add MyNewProduct&#8221; link in
the &#8220;Product Subtypes&#8221; section of each product&#8217;s admin page.</p>
</div>
<div class="section" id="extending-the-model-and-templates">
<h2>Extending the model and templates<a class="headerlink" href="#extending-the-model-and-templates" title="Permalink to this headline">¶</a></h2>
<p>A product model is a Django model with a <tt class="docutils literal"><span class="pre">OneToOneField</span></tt> to
<tt class="docutils literal"><span class="pre">satchmo.product.models.Product</span></tt> and a <tt class="docutils literal"><span class="pre">_get_subtype</span></tt> method. You may add
new fields and behavior as you would with any other Django model.</p>
<p>When Satchmo renders a product page, it looks for a template named
<tt class="docutils literal"><span class="pre">product/detail_productname.html</span></tt> (in all lowercase). If the template is not
found, Satchmo uses the <tt class="docutils literal"><span class="pre">base_product.html</span></tt> template.</p>
<p>As an example, say you are using <tt class="docutils literal"><span class="pre">MyNewProduct</span></tt> from the previous example
and you want to extend it to display a special title on the product&#8217;s page.
First, you would add a <tt class="docutils literal"><span class="pre">CharField</span></tt> named <tt class="docutils literal"><span class="pre">title</span></tt> to the existing model and
to the table in your database (or just drop the table and run <tt class="docutils literal"><span class="pre">syncdb</span></tt>). Then,
create a template named <tt class="docutils literal"><span class="pre">product/detail_mynewproduct.html</span></tt> with the following
content:</p>
<div class="highlight-python"><pre>{% extends "product/product.html" %}

{% block title %}{{ product.mynewproduct.title }}{% endblock title %}</pre>
</div>
<p>If you create a <tt class="docutils literal"><span class="pre">MyNewProduct</span></tt> and view its page in the store, the page will
have the title you assigned it in the admin app. Notice that the
<tt class="docutils literal"><span class="pre">MyNewProduct</span></tt> is accessed as an attribute of <tt class="docutils literal"><span class="pre">product</span></tt>.</p>
<p>For more examples, look at <tt class="docutils literal"><span class="pre">product/models.py</span></tt>,
<tt class="docutils literal"><span class="pre">templates/base_product.html</span></tt>, and <tt class="docutils literal"><span class="pre">templates/product/</span></tt> in the Satchmo
source code.</p>
</div>
<div class="section" id="using-model-inheritance">
<h2>Using model inheritance<a class="headerlink" href="#using-model-inheritance" title="Permalink to this headline">¶</a></h2>
<p>There is another possibility for extending the product model using
model inheritance. You can find more information in the <a class="reference external" href="http://thisismedium.com/tech/satchmo-diaries-part-one/">first installment</a>
of the Satchmo Diaries.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Using inheritance is currently not recommended, because it has some
issues when it is used without care. Some methods of
<tt class="xref py py-class docutils literal"><span class="pre">product.models.Product</span></tt> currently do not expect to find
subtypes which inherit attributes and methods from
<tt class="xref py py-class docutils literal"><span class="pre">product.models.Product</span></tt>.</p>
</div>
<p>If you want to use inheritance, make sure <em>not</em> to add
your model to the list returned by <tt class="xref py py-func docutils literal"><span class="pre">get_product_types()</span></tt>, else
you might get some trouble with infinite recursions. An alternative
would be to extend the current implementation to be able to handle
models which inherit from <tt class="xref py py-class docutils literal"><span class="pre">product.models.Product</span></tt>.</p>
<p>So, your <tt class="docutils literal"><span class="pre">models.py</span></tt> file should look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">product.models</span> <span class="kn">import</span> <span class="n">Product</span>

<span class="k">class</span> <span class="nc">MyNewProduct</span><span class="p">(</span><span class="n">Product</span><span class="p">):</span>

    <span class="c"># TODO: your attributes here</span>

    <span class="n">objects</span> <span class="o">=</span> <span class="n">ProductManager</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&quot;MyNewProduct: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;My New Product&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;My New Products&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To make this model available in the admin interface you should create
a corresponding <tt class="docutils literal"><span class="pre">admin.py</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">MyNewProduct</span>
<span class="kn">from</span> <span class="nn">product.admin</span> <span class="kn">import</span> <span class="n">ProductOptions</span>

<span class="c"># TODO: do your customizations here</span>
<span class="k">class</span> <span class="nc">MyNewProductAdmin</span><span class="p">(</span><span class="n">ProductOptions</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyNewProduct</span><span class="p">,</span> <span class="n">MyNewProductAdmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This document should get you started in customizing Satchmo through the product
model. If you need help with something discussed here or with more advanced
topics, feel free to ask the <a class="reference external" href="http://groups.google.com/group/satchmo-users">mailing list</a>.</p>
<p>Finally, if you create a product model that others may find useful, please
consider contributing it to the Satchmo community.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="translation.html" title="Translating Content"
             >next</a> |</li>
        <li class="right" >
          <a href="product-attributes.html" title="Custom Product Attributes"
             >previous</a> |</li>
        <li><a href="http://www.satchmoproject.com">Satchmo home </a> |&nbsp;</li>
        
        <li><a href="index.html">Satchmo v0.9.2-development documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010, Chris Moffitt.
      Last updated on Mar 10, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
<script src='http://www.google-analytics.com/ga.js' type='text/javascript'></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1711397-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>