<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
    <head>
        <title>{% block title %}{% endblock %}</title>

        <meta charset="utf-8"> 
        <!-- Use the .htaccess and remove these lines to avoid edge case issues.
             More info: h5bp.com/b/378 -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1">

        <link rel="stylesheet" href="{{ CILANTRO_STATIC_URL }}css/main.css">

        {% block styles %}{% endblock %}
    
        {% block head_scripts %}
            <script src="{{ CILANTRO_JS_URL }}vendor/modernizr.js"></script>
        {% endblock %}
    </head>
    
    <body>
        {# standard global header #}
        {% include "snippets/header.html" %}

        {# navigation proxy, use "base_nav.html" to implement #}
        {% block _navigation %}{% endblock %}

        <noscript>
            <span class="message error">JavaScript must be enabled. Turn it on and refresh the page.</span>
        </noscript>

        {# general area for display messages #}
        {% block messages %}
            <div id="messages"></div>
        {% endblock %}

        {# primary area for displaying page content. override CSS for a page specific style #}
        <div id="content">
            {% block content %}{% endblock %}
        </div>

        {# standard global footer #}        
        {% include "snippets/footer.html" %}

        {# any extra markup that needs to be included in the page for #}
        {# additional functionality, templates, hidden elements, etc. #}
        {% block extra_markup %}{% endblock %}

        {# the configuration for RequireJS which ensures the paths are #}
        {# correctly setup and able to be extended. #}
        <script>
            var require = {
                // everything should be relative to the project's javascript
                // url for convenience. Cilantro is namespaced within the
                // project anyway
                baseUrl: '{{ JS_URL }}',

                // define the absolute path for cilantro since everything is
                // namespaced under 'cilantro'
                paths: {
                    'cilantro': '{{ CILANTRO_JS_URL }}',
                    'common': '{{ CILANTRO_JS_URL }}/common',
                    'vendor': '{{ CILANTRO_JS_URL }}/vendor'
                },
                
                // bootstrap script containing the shared libraries for each
                // page
                priority: ['cilantro/main']
            };

            // namespace for the application. defined here are all the
            // necessary endpoints. this liste will hopefully decrease over
            // time...
            var App = {
                csrftoken: '{{ csrf_token }}',
                endpoints: {
                    session: {
                        scope: '{% url api:scope:session %}',
                        perspective: '{% url api:perspectives:session %}',
                        report: '{% url api:reports:session %}'
                    },
                    reports: '{% url api:reports:read %}',
                    domains: '{% url api:categories:read %}',
                    criteria: '{% url api:criteria:read %}',
                    define: '{% url define %}',
                    report: '{% url report %}'
                }
            };

            {% block require_config %}
            {% endblock %}
        </script>

        <script src="{{ CILANTRO_JS_URL }}vendor/require-jquery.js"></script>

        {% block scripts %}{% endblock %}
    </body>
</html>
