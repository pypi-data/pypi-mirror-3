<%inherit file="base.html"/>
<%namespace name="search_box" file="search_box.html"/>
<%block name="title">Bank Account List</%block>
<% import time %>
<style type="text/css">
    .bank {
        margin-bottom: 0.5em;
    }
    .bank .ui-widget-header {
        padding: 0.3em;
        margin: 0;
        font-size: 1.2em;
    }
    .bank .ui-widget-content {
        margin-left: 1em;
        padding: 0;
    }
    .account:first-child {
        border: 0;
    }
    .account .actions{
        font-size: 0.9em;
    }
    .account {
        border: collapse;
        padding: 0.5em;
        overflow: auto;
        border-top: 1px solid #aaa;
    }
    .account .text {
        float: left;
    }
    .account .type {
        opacity: 0.5;
        font-weight: bold;
    }
    .account .actions {
        float: right;
    }
    .account .actions label {
        font-size: 0.9em;
    }
</style>
<script>
    $(function() {
        $('.account a').button({ icons: {primary:'ui-icon-disk'} })
    });
</script>
% for b in banks:
<div class="bank ui-widget">
    <div class="ui-widget-header ui-corner-top ui-corner-bl">
        ${b.description}
    </div>
    <div class="ui-widget-content ui-corner-bottom">
    % for a in b.accounts():
        <% name = a.description or a.institution.description %>
        <% today = time.strftime('%Y-%m-%d_%H_%M_%S') %>
        <% url = "/download/%s/%s_%s.ofx" % (a.guid,name,today) %>
        <div class="account">
            <div class="text">
            <span class="name">
                ${name}
            </span><br/>
            <span class="type">
                % if a.is_bank_account():
                    Bank Account
                % elif a.is_brokerage_account():
                    Brokerage Account
                % elif a.is_credit_card_account():
                    Credit Card Account
                % endif
            </span>
            </div>
            <div class="actions">
                <label>Statements:</label>
                <a href="${url}?days=10">10 days</a>
                <a href="${url}?days=30">30 days</a>
                <a href="${url}?days=60">60 days</a>
                <a href="${url}?days=90">90 days</a>
            </div>
        </div>
    % endfor
    </div>
</div>
% endfor
% if not banks:
${search_box.form(error='No financial institution have been configured yet')}
% endif
