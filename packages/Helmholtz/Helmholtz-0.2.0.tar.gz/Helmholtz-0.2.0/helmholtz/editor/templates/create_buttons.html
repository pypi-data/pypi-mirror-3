{% comment %}
<!-- Add Action -->
{% endcomment %}
  
  {% comment %}
  {% if node.node_type == "objectnode" or node.node_type == "objectlink" %}
  <input class="button" type="checkbox" name="selected_objects" value="{{child.content_type.pk}}.{{child.record.pk}}"></input>
  {% endif %}
  {% endcomment %}
  
  {% if "add" in node.actions %}
   {% with "add" as action %}
    
    {% comment %}
    <!-- Class Level Add -->
    {% endcomment %}
    
    {% if node.node_type == "classnode" and not node.display_subclasses and not node.constraint.max_objects or node.constraint.max_objects < node.entity.objects.count %}
     {% include "action_button.html" %}
    {% endif %}
    
    {% comment %}
    <!-- Object Link Add -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and not node.parent.node_type == "listoflinks" and not node.parent.node_type == "subclassnode" and not node.value %}
     {% if node.link.reverse %}
      {% include "action_button.html" %}
     {% else %}
      {% if "modify" in node.parent.actions %}
       {% with node.parent.is_editable as action_possible %}
        {% include "action_button.html" %}
       {% endwith %}
      {% endif %} 
     {% endif %}
    {% endif %}
    
    {% comment %}
    <!-- List of Links Add -->
    {% endcomment %}
    
    {% if node.node_type == "listoflinks" and not node.display_subclasses %}
     {% if node.link.reverse %}
      {% include "action_button.html" %}
     {% else %}
      {% if "modify" in node.parent.actions %}
       {% with node.parent.is_editable as action_possible %}
        {% include "action_button.html" %}
       {% endwith %}
      {% endif %} 
     {% endif %}
    {% endif %}
    
    {% comment %}
    <!-- Subclass Node Add -->
    {% endcomment %}
    
    {% if node.node_type == "subclassnode" %}
     {% if node.link.reverse %}
      {% include "action_button.html" %}
     {% else %}
      {% if "modify" in node.parent.parent.actions %}
       {% with node.parent.parent.is_editable as action_possible %}
        {% include "action_button.html" %}
       {% endwith %}
      {% endif %} 
     {% endif %}
    {% endif %}
    
   {% endwith %}
   
  {% endif %}
  
  {% comment %}
  <!-- Delete Action -->
  {% endcomment %}
  
  {% if "delete" in node.actions %}
   {% with "delete" as action %}
   
    {% comment %}
    <!-- Object Delete -->
    {% endcomment %}
    
    {% if node.node_type == "objectnode"%}
     {% with node.is_deletable as action_possible %}
      {% include "action_button.html" %}
     {% endwith %}
    {% endif %}
    
    {% comment %}
    <!--  Object Link Delete -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and not node.parent.node_type == "listoflinks" and node.value and not node.link.required %}
     {% if node.link.reverse %}
      {% with node.is_deletable as action_possible %}
       {% include "action_button.html" %}
      {% endwith %}
     {% else %}
      {% if "modify" in node.parent.actions %}
       {% if node.is_deletable and node.parent.is_editable %}
        {% with True as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% else %}
        {% with False as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %}
      {% endif %}
     {% endif %}
    {% endif %} 
    
    {% comment %}
    <!-- List of Links Delete -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and node.parent.node_type == "listoflinks" and not node.link.required %}
     {% if node.link.reverse %}
      {% with node.is_deletable as action_possible %}
       {% include "action_button.html" %}
      {% endwith %}
     {% else %}
      {% if "modify" in node.parent.parent.actions %}
       {% if node.is_deletable and node.parent.parent.is_editable %}
        {% with 1 as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% else %}
        {% with 0 as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %} 
      {% endif %} 
     {% endif %}
    {% endif %}
    
    {% comment %}
    <!-- Subclass Node Delete -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and node.parent.node_type == "subclassnode" and not node.link.required %}
     {% if node.link.reverse %}
      {% with node.is_deletable as action_possible %}
       {% include "action_button.html" %}
      {% endwith %}
     {% else %}
      {% if "modify" in node.parent.parent.parent.actions %}
       {% if node.is_deletable and node.parent.parent.parent.is_editable %}
        {% with 1 as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% else %}
        {% with 0 as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %} 
      {% endif %} 
     {% endif %}
    {% endif %}
    
   {% endwith %}
  {% endif %}
  
  {% comment %}
  <!-- Modify Action -->
  {% endcomment %}
  
  {% if "modify" in node.actions %}
   {% with "modify" as action %}
    
    {% comment %}
    <!-- Object Modify -->
    {% endcomment %}
    
    {% if node.node_type == "objectnode" %}
     {% with node.is_editable as action_possible %}
      {% include "action_button.html" %}
     {% endwith %}
    {% endif %}
    
    {% comment %}
    <!-- Object Link Modify, Link, Unlink -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and not node.parent.node_type == "listoflinks"  and not node.parent.node_type == "subclassnode" and node.value %}
     {% with node.is_editable as action_possible %}
      {% include "action_button.html" %}
     {% endwith %}
    {% endif %}
    
    {% if node.node_type == "objectlink" and not node.parent.node_type == "listoflinks"  and not node.parent.node_type == "subclassnode" and not node.link.required and not node.value %}
     {% with "link" as action %}
      {% if node.link.reverse %}
       {% with node.is_editable as action_possible %}
        {% include "action_button.html" %}
       {% endwith %}
      {% else %}
       {% if "modify" in node.parent.actions %}
        {% with node.parent.is_editable as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %}
      {% endif %} 
     {% endwith %}
    {% endif %}
    
    {% if node.node_type == "objectlink" and not node.parent.node_type == "listoflinks"  and not node.parent.node_type == "subclassnode" and not node.link.required and node.value %}
     {% with "unlink" as action %}
      {% if node.link.reverse %}
       {% with node.is_editable as action_possible %}
        {% include "action_button.html" %}
       {% endwith %}
      {% else %}
       {% if "modify" in node.parent.actions %}
        {% with node.parent.is_editable as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %} 
      {% endif %}
     {% endwith %}
    {% endif %}
    
    {% comment %}
    <!-- List of Links Modify and Link -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and node.parent.node_type == "listoflinks" %}
     {% with node.is_editable as action_possible %}
      {% include "action_button.html" %}
     {% endwith %}
     {% if not node.link.required %}
      {% with "unlink" as action %}
       {% if node.link.reverse %}
        {% with node.is_editable as action_possible %}
        {% include "action_button.html" %}
        {% endwith %}
       {% else %}
        {% if "modify" in node.parent.parent.actions %}
         {% with node.parent.parent.is_editable as action_possible %}
          {% include "action_button.html" %}
         {% endwith %}
        {% endif %} 
       {% endif %}
      {% endwith %}
     {% endif %}
    {% endif %}

    {% if node.node_type == "listoflinks"  and not node.display_subclasses %}
     {% with "link" as action %}
      {% if node.link.reverse %}
       {% include "action_button.html" %}
      {% else %}
       {% if "modify" in node.parent.actions %}
        {% with node.parent.is_editable as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %} 
      {% endif %}
     {% endwith %}
    {% endif %}    
    
    {% if node.node_type == "subclassnode" %}
     {% with "link" as action %}
      {% if node.link.reverse %}
       {% include "action_button.html" %}
      {% else %}
       {% if "modify" in node.parent.parent.actions %}
        {% with node.parent.parent.is_editable as action_possible %}
         {% include "action_button.html" %}
        {% endwith %}
       {% endif %} 
      {% endif %}
     {% endwith %}
    {% endif %}
    
    {% comment %}
    <!-- Subclass Node Modify -->
    {% endcomment %}
    
    {% if node.node_type == "objectlink" and node.parent.node_type == "subclassnode"  %}
     {% with node.is_editable as action_possible %}
      {% include "action_button.html" %}
     {% endwith %}
     {% if not node.link.required %}
      {% with "unlink" as action %}
       {% if node.link.reverse %}
        {% with node.is_editable as action_possible %}
        {% include "action_button.html" %}
        {% endwith %}
       {% else %}
        {% if "modify" in node.parent.parent.parent.actions %}
         {% with node.parent.parent.parent.is_editable as action_possible %}
          {% include "action_button.html" %}
         {% endwith %}
        {% endif %} 
       {% endif %}
      {% endwith %}
     {% endif %}
    {% endif %}
    
   {% endwith %} 
  {% endif %}
  
  {% if "tag" in node.actions %}
   {% if node.node_type == "objectnode" or node.node_type == "objeclink" %}
    {% with "tag" as action %}
     <td class="action_cell">{% include "action_button.html" %}</td>
    {% endwith %}
   {% endif %}
  {% endif %}