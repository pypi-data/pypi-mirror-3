function getCSRF(){var f=null;var b="csrftoken";if(document.cookie&&document.cookie!=""){var e=document.cookie.split(";");for(var d=0;d<e.length;d++){var c=jQuery.trim(e[d]);if(c.substring(0,b.length+1)==(b+"=")){f=decodeURIComponent(c.substring(b.length+1));break}}}var a=this;return f}function seteditor(){if($("#id_signature_type").val()==1){var a=$("#id_signature_content").cleditor()[0];a.$area.insertBefore(a.$main);a.$area.removeData("cleditor");a.$main.remove();$("#id_signature_content").show()}else{$("#id_signature_content").cleditor()}}$(document).ready(function(){var a='<form enctype="multipart/form-data" method="post" action="'+fm_url+'"><input type="hidden" name="csrfmiddlewaretoken" value="'+getCSRF()+'" /><p><input type="file" name="handle" /><br><input type="text" name="newName" style="width:250px; border:solid 1px !important;" /><br><input type="text" name="action" style="display:none;" value="upload" /><br></p><input type="submit" name="submit" value="Upload" /></form>';$("#id_signature_type").change(seteditor);if($("#id_signature_type").val()==2){$("#id_signature_content").cleditor()}$("#currimgs .wysiwyg-dialog-close-button").click(function(b){b.preventDefault();$("#currimgs").hide()});$("#imgupload .wysiwyg-dialog-close-button").click(function(b){b.preventDefault();$("#currimgs").hide();$("#imgupload").hide()});$(".wysiwyg-files-action-upload").bind("click",function(b){$("#imgupload .wysiwyg-dialog-content").empty();$("<iframe/>",{"class":"wysiwyg-files-upload"}).load(function(){var c=$(this).contents();c.find("body").append(a);c.find("input[type=file]").change(function(){var d=$(this).val();d=d.replace(/.*[\\\/]/,"");c.find("input[name=newName]").val(d)})}).appendTo($("#imgupload .wysiwyg-dialog-content"));$("#imgupload").show()})});