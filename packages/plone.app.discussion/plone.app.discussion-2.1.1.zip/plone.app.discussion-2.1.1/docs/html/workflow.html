

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Permissions and Workflows &mdash; plone.app.discussion v2.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="plone.app.discussion v2.0 documentation" href="index.html" />
    <link rel="next" title="Captcha Plugin Architecture" href="captcha.html" />
    <link rel="prev" title="Design Notes" href="design.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="captcha.html" title="Captcha Plugin Architecture"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design Notes"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">plone.app.discussion v2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="permissions-and-workflows">
<h1>Permissions and Workflows<a class="headerlink" href="#permissions-and-workflows" title="Permalink to this headline">¶</a></h1>
<p>This document describes how plone.app.discussion handles permissions and
workflows.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>plone.app.discussion uses permissions and workflows to control what a user is
allowed to do. It tries to use the default Plone permissions and workflow
engine as much as possible.</p>
</div>
<div class="section" id="permissions">
<h2>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h2>
<p>plone.app.discussion knows two permissions to control what a user is allowed to
do. The &#8216;Reply to item&#8217; permission to control who is allowed to post a comment
on a content object and the &#8216;Review comments&#8217; permission to control who is
allowed to review comments.</p>
<ol class="arabic">
<li><p class="first"><strong>Permission to post a comment</strong>:</p>
<p>The permission to post a comment is controlled by the &#8216;Reply to item&#8217;
permission. By default, this permission is granted to the &#8216;Member&#8217;,
&#8216;Reviewer&#8217;, and &#8216;Manager&#8217; role.</p>
</li>
<li><p class="first"><strong>Permission to review comments</strong>:</p>
<p>The permission to review comments is controlled by the &#8216;Review comments&#8217;
permission. By default, this permission is granted to the &#8216;Reviewer&#8217; and
&#8216;Manager&#8217; role.</p>
</li>
</ol>
<div class="section" id="changing-permissions">
<h3>Changing permissions<a class="headerlink" href="#changing-permissions" title="Permalink to this headline">¶</a></h3>
<p>If you want to change the way plone.app.discussion allows users to post or
review comments you can do that by changing which permissions are granted to
which rules. In Plone permissions are always granted to roles, not to users
directly.</p>
<p>For instance, if you want to allow users without the &#8216;Member&#8217; role to post
comments, you have to grant the &#8216;Reply to item&#8217; permission to the
&#8216;Authenticated&#8217; role.</p>
<p>Or, if you don&#8217;t want to allow &#8216;Reviewers&#8217; to review comments anymore, you
can just remove the &#8216;Review comments&#8217; permission from the &#8216;Reviewer&#8217; role.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>For a general introduction to permissions and roles in Plone see:</p>
<p><a class="reference external" href="http://plone.org/documentation/kb/understanding-permissions/permissions-and-roles">http://plone.org/documentation/kb/understanding-permissions/permissions-and-roles</a></p>
<p class="last"><a class="reference external" href="http://plone.org/products/dexterity/documentation/manual/developer-manual/advanced/permissions">http://plone.org/products/dexterity/documentation/manual/developer-manual/advanced/permissions</a></p>
</div>
</div>
</div>
<div class="section" id="workflows">
<h2>Workflows<a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h2>
<p>plone.app.discussion ships with a simple one-state
workflow and a review workflow for comments:</p>
<ol class="arabic">
<li><p class="first"><strong>Comment Single State Workflow</strong>:</p>
<p>Essentially a workflow with no transitions, but it has a published state,
so portlets and applications that expect that state will continue to work.</p>
</li>
<li><p class="first"><strong>Comment Review Workflow</strong>: A simple review workflow for comments</p>
<p>A simple review workflow that comes with two states (pending and published)
and a single transition (publish).</p>
<p>The &#8216;pending&#8217; state is the initial state. &#8216;published&#8217; is the state where the
comment is visible to everyone and non-editable.</p>
<p>The &#8216;publish&#8217; transition is protected by the &#8216;Review comments&#8217; permission.</p>
<div class="highlight-python"><pre>* --&gt; [pending] -- {publish} --&gt; [published]--&gt; *</pre>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For a general introduction to workflows in Plone see:
<a class="reference external" href="http://plone.org/documentation/kb/creating-workflows-in-plone/">http://plone.org/documentation/kb/creating-workflows-in-plone/</a></p>
</div>
<div class="section" id="custom-comment-workflow">
<h3>Custom comment workflow<a class="headerlink" href="#custom-comment-workflow" title="Permalink to this headline">¶</a></h3>
<p>You can create and enable any custom workflow on the &#8220;comment&#8221; content type.
Though, there are some special hooks in plone.app.discussion that check if the
workflow that is enabled for the &#8220;comment&#8221; content type has a &#8216;pending&#8217; state in
order to do the following things:</p>
<blockquote>
<div><ol class="arabic simple">
<li>A portal message will be shown to the user after posting a comment, if
the comment just entered the &#8216;pending&#8217; state.</li>
<li>A message is shown to the user if he/she accesses the bulk moderation view
and workflow is enabled for comments that does not implement a &#8216;pending&#8217;
state.</li>
<li>A moderator will only be emailed when comment moderation is enabled in the
discussion control panel and the comment workflow contains a &#8216;pending&#8217;
state.</li>
</ol>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Permissions and Workflows</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#permissions">Permissions</a><ul>
<li><a class="reference internal" href="#changing-permissions">Changing permissions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#workflows">Workflows</a><ul>
<li><a class="reference internal" href="#custom-comment-workflow">Custom comment workflow</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="design.html"
                        title="previous chapter">Design Notes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="captcha.html"
                        title="next chapter">Captcha Plugin Architecture</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/workflow.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="captcha.html" title="Captcha Plugin Architecture"
             >next</a> |</li>
        <li class="right" >
          <a href="design.html" title="Design Notes"
             >previous</a> |</li>
        <li><a href="index.html">plone.app.discussion v2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Timo Stollenwerk - Plone Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>