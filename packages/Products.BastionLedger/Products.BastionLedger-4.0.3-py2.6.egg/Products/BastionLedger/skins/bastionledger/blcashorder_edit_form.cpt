<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="bastionledger">
 
<body>
  <div metal:fill-slot="main" 
       tal:define="entries here/orderItemValues;
                   account context/accno;
                     utool context/@@plone_portal_state/portal_url;
                   buysell request/buysell | context/buysell">

      <h1><img src="" alt="" tal:define="icon python:context.getIcon(1)" 
               tal:attributes="src string:${utool}/${icon}">&nbsp;<span tal:replace="context/Title | context/getId"/></h1>

        <a href=""
           class="link-parent"
           tal:define="ledger_url python:context.navigationParent(context, template.getId())"
           tal:condition="ledger_url"
           tal:attributes="href ledger_url"
           i18n:translate="go_to_ledger_url">
        Up one Level
        </a>
      
      <form name="edit_form" action="" tal:attributes="action template/getId" method="post">

          <div metal:use-macro="context/blorder_edit_form/macros/order"/>
          <div metal:use-macro="context/blorder_edit_form/macros/orderdates"/>

          <div class="field">
            <div class="formHelp" i18n:translate="help_buysell">
                 Is this order a purchase or a sales order?
            </div>

              <select name="buysell">
                   <option value="sell"
                           tal:attributes="selected python: test(buysell=='sell', 1, 0)">Sell Order</option>
                   <option value="buy" 
                           tal:attributes="selected python: test(buysell=='buy', 1, 0)">Buy Order</option>
              </select>
              
          </div>
 
        <div metal:use-macro="context/blorder_edit_form/macros/orderlines"/>

        <div class="formControls">
             <input class="context"  type="submit" tal:condition="entries"
                      name="form.button.Edit"
                    value=" Edit " i18n:attributes="value" />

             <tal:account tal:define="orderbooks python: context.bastionLedger().objectValues('BLOrderBook')"
                          tal:condition="orderbooks">
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <select name="orderbook_id">
                   <option tal:repeat="ob orderbooks"
                           tal:content="ob/Title"
                           tal:attributes="value ob/getId"/>
                </select>
                <input class="standalone"  type="submit"
                         name="form.button.CreateAccount"
                       value="Create Account " i18n:attributes="value" />
                <span class="formHelp">  Upgrade these order details to an orderbook account</span>
             </tal:account>

        </div>


        <input type="hidden" name="form.submitted" value="1" />

      </form>

      <div tal:replace="structure provider:plone.documentactions">
           Document actions (print, sendto etc)
      </div>
  </div>
 
</body>
</html>
