<!-- -*-mode: scheme; coding: utf-8; -*- -->
<% (eml-include "header.eml" :title "redirect/forward sample" ) %>
<% (define runmode (string->symbol (query :mode "index"))) %>
<% (define (mkhref mode) 
     (htesc (format "redirect-and-forward.eml?mode=~A" mode))) %>
<%
(case runmode
  ((redirect) (redirect "http://www.python.org/"))
  ((forward) (forward "/calendar.eml"))
  ((redirect301) ;; for debug (response) function
   (response 'setstatus "301 Moved Permanently")
   (response 'clear_headerlist)
   (response 'setheader "Location" "http://pypi.python.org/pypi")
   (response 'setbody (<str> ""))
   ((attr (request) 'quit)))
  (else (eml %>
<ul>
  <li><a href="<%(mkhref "forward")%>">Forward to '/calendar.eml'</a></li><br  />
  <li><a href="<%(mkhref "redirect")%>">Redirect to Python.Org</li><br />
</ul>  
<%)))%>
<%(eml-include "footer.eml")%>
