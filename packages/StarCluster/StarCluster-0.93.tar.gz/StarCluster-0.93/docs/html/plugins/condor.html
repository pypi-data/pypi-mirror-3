
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Condor Plugin &mdash; StarCluster v0.93 documentation</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.93',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="StarCluster v0.93 documentation" href="../index.html" />
    <link rel="up" title="Plugin Documentation" href="index.html" />
    <link rel="next" title="Hadoop Plugin" href="hadoop.html" />
    <link rel="prev" title="TMUX Plugin" href="tmux.html" />
<link rel="stylesheet" href="../_static/nobile.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../_static/neuton.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/starcluster.ico"/>

  </head>
  <body>
<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/logo-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="hadoop.html" title="Hadoop Plugin"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tmux.html" title="TMUX Plugin"
             accesskey="P">previous</a> |</li>
    	<li><a href="../index.html">Home</a> &raquo;</li>
          <li><a href="../contents.html" >Master Table of Contents</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Plugin Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="condor-plugin">
<span id="id1"></span><h1>Condor Plugin<a class="headerlink" href="#condor-plugin" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Condor is only available on the latest StarCluster 11.10 Ubuntu-based AMIs
and above. See <cite>starcluster listpublic</cite> for a list of available AMIs.</p>
</div>
<p>To configure a condor pool on your cluster you must first define the
<tt class="docutils literal"><span class="pre">condor</span></tt> plugin in your config file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[plugin condor]</span>
<span class="na">setup_class</span> <span class="o">=</span> <span class="s">starcluster.plugins.condor.CondorPlugin</span>
</pre></div>
</div>
<p>After defining the plugin in your config, add the <tt class="docutils literal"><span class="pre">condor</span></tt> plugin to the list
of plugins in one of your cluster templates:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[cluster smallcluster]</span>
<span class="na">plugins</span> <span class="o">=</span> <span class="s">condor</span>
</pre></div>
</div>
<div class="section" id="using-the-condor-cluster">
<h2>Using the Condor Cluster<a class="headerlink" href="#using-the-condor-cluster" title="Permalink to this headline">¶</a></h2>
<p>Condor jobs cannot be submitted by the <tt class="docutils literal"><span class="pre">root</span></tt> user. Instead you must login to
the cluster as the normal <tt class="docutils literal"><span class="pre">CLUSTER_USER</span></tt>:</p>
<div class="highlight-python"><pre>$ starcluster sshmaster mycluster -u myuser</pre>
</div>
</div>
<div class="section" id="submitting-jobs">
<h2>Submitting Jobs<a class="headerlink" href="#submitting-jobs" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The &#8220;parallel&#8221; universe currently does not work. This should be
resolved in a future release.</p>
</div>
<p>To submit a job you must first create a job script. Below is a simple example
that submits a job which sleeps for 5 minutes:</p>
<div class="highlight-python"><pre>Universe   = vanilla
Executable = /bin/sleep
Arguments  = 300
Log        = sleep.log
Output     = sleep.out
Error      = sleep.error
Queue</pre>
</div>
<p>The above job will run <tt class="docutils literal"><span class="pre">/bin/sleep</span></tt> passing <tt class="docutils literal"><span class="pre">300</span></tt> as the first argument.
Condor messages will be logged to <tt class="docutils literal"><span class="pre">$PWD/sleep.log</span></tt> and the job&#8217;s standard
output and standard error will be saved to <tt class="docutils literal"><span class="pre">$PWD/sleep.out</span></tt> and
<tt class="docutils literal"><span class="pre">$PWD/sleep.error</span></tt> respectively where <tt class="docutils literal"><span class="pre">$PWD</span></tt> is the directory from which
the job was originally submitted. Save the job script to a file, say
<tt class="docutils literal"><span class="pre">job.txt</span></tt>, and use the <tt class="docutils literal"><span class="pre">condor_submit</span></tt> command to submit the job:</p>
<div class="highlight-python"><pre>$ condor_submit job.txt
Submitting job(s).
1 job(s) submitted to cluster 8.</pre>
</div>
<p>From the output above we see the job has been submitted to the cluster as job
8. Let&#8217;s submit this job once more in order to test that multiple jobs can be
successfully distributed across the cluster by Condor:</p>
<div class="highlight-python"><pre>$ condor_submit job.txt
Submitting job(s).
1 job(s) submitted to cluster 9.</pre>
</div>
<p>The last job was submitted as job 9. The next step is to monitor these jobs
until they&#8217;re finished.</p>
</div>
<div class="section" id="monitoring-job-status">
<h2>Monitoring Job Status<a class="headerlink" href="#monitoring-job-status" title="Permalink to this headline">¶</a></h2>
<p>To monitor the status of your Condor jobs use the <tt class="docutils literal"><span class="pre">condor_q</span></tt> command:</p>
<div class="highlight-python"><pre>$ condor_q
-- Submitter: master : &lt;10.220.226.138:52585&gt; : master
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
   8.0   myuser         12/12 21:31   0+00:06:40 R  0   0.0  sleep 300
   9.0   myuser         12/12 21:31   0+00:05:56 R  0   0.0  sleep 300

2 jobs; 0 idle, 2 running, 0 held</pre>
</div>
<p>From the output above we see that both jobs are currently running. To find out
which cluster nodes the jobs are running on pass the <tt class="docutils literal"><span class="pre">-run</span></tt> option:</p>
<div class="highlight-python"><pre>$ condor_q -run
-- Submitter: master : &lt;10.220.226.138:52585&gt; : master
 ID      OWNER            SUBMITTED     RUN_TIME HOST(S)
   8.0   myuser         12/12 21:31   0+00:05:57 master
   9.0   myuser         12/12 21:31   0+00:05:13 node001</pre>
</div>
<p>Here we see that job 8 is running on the <tt class="docutils literal"><span class="pre">master</span></tt> and job 9 is running on
<tt class="docutils literal"><span class="pre">node001</span></tt>. If your job is taking too long to run you can diagnose the issue
by passing the <tt class="docutils literal"><span class="pre">-analyze</span></tt> option to <tt class="docutils literal"><span class="pre">condor_q</span></tt>:</p>
<div class="highlight-python"><pre>$ condor_q -analyze</pre>
</div>
<p>This will give you verbose output showing which scheduling conditions failed
and why.</p>
</div>
<div class="section" id="cancelling-jobs">
<h2>Cancelling Jobs<a class="headerlink" href="#cancelling-jobs" title="Permalink to this headline">¶</a></h2>
<p>In some cases you may need to cancel queued or running jobs either because of
an error in your job script or simply because you wish to change job
parameters. Whatever the case may be you can cancel jobs by passing the job ids
to <tt class="docutils literal"><span class="pre">condor_rm</span></tt>:</p>
<div class="highlight-python"><pre>$ condor_rm 9
Cluster 9 has been marked for removal.</pre>
</div>
<p>The above example removes job 9 from the condor queue.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Condor Plugin</a><ul>
<li><a class="reference internal" href="#using-the-condor-cluster">Using the Condor Cluster</a></li>
<li><a class="reference internal" href="#submitting-jobs">Submitting Jobs</a></li>
<li><a class="reference internal" href="#monitoring-job-status">Monitoring Job Status</a></li>
<li><a class="reference internal" href="#cancelling-jobs">Cancelling Jobs</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tmux.html"
                        title="previous chapter">TMUX Plugin</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hadoop.html"
                        title="next chapter">Hadoop Plugin</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="hadoop.html" title="Hadoop Plugin"
             >next</a> |</li>
        <li class="right" >
          <a href="tmux.html" title="TMUX Plugin"
             >previous</a> |</li>
    	<li><a href="../index.html">Home</a> &raquo;</li>
          <li><a href="../contents.html" >Master Table of Contents</a> &raquo;</li>
          <li><a href="index.html" >Plugin Documentation</a> &raquo;</li> 
      </ul>
    </div>


    <div class="footer">
        &copy; Copyright 2011, Software Tools for Academics and Researchers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>


<script type="text/javascript">
//<![CDATA[
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    //]]>
    </script><script type="text/javascript">
//<![CDATA[
    try{
        var pageTracker = _gat._getTracker("UA-1048253-12");
        pageTracker._trackPageview();
    } catch(err) {}
    //]]>
    </script>

  </body>
</html>