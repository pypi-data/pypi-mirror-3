

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Deployment &mdash; Camelot  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Camelot  documentation" href="../index.html" />
    <link rel="up" title="Advanced Topics" href="index.html" />
    <link rel="next" title="Authentication and permissions" href="permissions.html" />
    <link rel="prev" title="Unittests" href="unittests.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2652891-3']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="permissions.html" title="Authentication and permissions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="unittests.html" title="Unittests"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Advanced Topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="deployment">
<span id="doc-deployment"></span><h1>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Release:</th><td class="field-body">trunk</td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body">November 03, 2011</td>
</tr>
</tbody>
</table>
<p>After developing a Camelot application comes the need to deploy the
application, eather at a central location or in a distributed setup.</p>
<div class="section" id="building-egg-files">
<h2>Building .egg files<a class="headerlink" href="#building-egg-files" title="Permalink to this headline">¶</a></h2>
<p>Whatever the deployment setup is, it is almost always a good idea to
distribute your application as a single .egg file, containing as much
as possible the dependencies that are likely to change often during
the lifetime of the application.  Resource files (like icons or templates
can be included in this .egg file as well).</p>
<p>Building .egg files is a relatively straightforward process using
<a href="#id1"><span class="problematic" id="id2">setuptools_</span></a></p>
<p>A setup.py file for building an .egg of your application could look
like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">setup</span><span class="p">(</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;movie store&#39;</span><span class="p">,</span>
  <span class="n">version</span> <span class="o">=</span> <span class="s">&#39;01.01&#39;</span><span class="p">,</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s">&#39;Movie Store&#39;</span><span class="p">,</span>
  <span class="n">author</span> <span class="o">=</span> <span class="s">&#39;Conceptive Engineering&#39;</span><span class="p">,</span>
  <span class="n">author_email</span> <span class="o">=</span> <span class="s">&#39;project-camelot@conceptive.be&#39;</span><span class="p">,</span>
  <span class="n">url</span> <span class="o">=</span> <span class="s">&#39;www.conceptive.be&#39;</span><span class="p">,</span>
  <span class="n">include_package_data</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
  <span class="n">packages</span> <span class="o">=</span> <span class="n">find_packages</span><span class="p">(),</span>
  <span class="n">py_modules</span> <span class="o">=</span>  <span class="p">[</span><span class="s">&#39;settings&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Which is then build using this command:</p>
<div class="highlight-python"><pre>python -O setup.py bdist_egg --exclude-source-files</pre>
</div>
<p>The setup.py script above includes settings.py in the .egg file.  This
is prefered if the settings.py file is going to be the same for all
deployments.  (Eg.: the database is on a central server accessible
for all)  In some occasions it might be better not to include the settings.py
file into the .egg file, and only put it in your PYTHONPATH at deployment
time.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The advantage of using .egg files comes when updating the application, simply
replacing a single .egg file at a central location is enough to migrate all
your users to the new version.</p>
</div>
</div>
<div class="section" id="windows-deployment">
<h2>Windows deployment<a class="headerlink" href="#windows-deployment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="through-cloudlaunch">
<h3>Through CloudLaunch<a class="headerlink" href="#through-cloudlaunch" title="Permalink to this headline">¶</a></h3>
<p>CloudLaunch is a service to ease the deployment and update process of Python
applications.  It&#8217;s main features are :</p>
<blockquote>
<div><ul class="simple">
<li>Building Windows Installers</li>
<li>Updating deployed applications</li>
<li>Monitoring of deployed applications</li>
</ul>
</div></blockquote>
<p>As CloudLaunch is build on top of setuptools, it works with .egg files,
CloudLaunch works cross platform, so it&#8217;s perfectly possible to build a
Windows installer, or update a Windows application from Linux.</p>
<p>To build a .egg file that can be deployed through ClaudLaunch, use the
command:</p>
<div class="highlight-python"><pre>python.exe setup.py bdist_cloud</pre>
</div>
<p>This will create 2 files in the dist/cloud folder, a traditional .egg file and
a .cld file.  The .egg file is a normal .egg file with some additional metadata
included, and without sources.  The .cld file contains metadata of the .egg
file, such as its checksum, and information on how get updated versions of the
.egg once deployed.</p>
<p>To make sure the application will run smoothly once deployed, one should test
if the generated .egg and .cld combination works:</p>
<div class="highlight-python"><pre>cd dist\cloud
cloudlaunch.exe --cld-file movie_store.cld
cd ..\..</pre>
</div>
<p>If this is working, a Windows installer can be build:</p>
<div class="highlight-python"><pre>python.exe setup.py bdist_cloud wininst_cloud</pre>
</div>
<p>This will generate a movie_store.exe file in distcloud, which is an installer
for your application.  The end user can now install and run your application on
his machine.</p>
<p>Now is the time to monitor the application as it runs on the end user machine:</p>
<div class="highlight-python"><pre>python.exe setup.py monitor_cloud</pre>
</div>
<p>Will display all the logs issued on the end user machine if that machine is
connected to the internet.</p>
<p>When development of the application continues, it will be needed to present the
user with an updated version of the application.  This is done with the
command:</p>
<div class="highlight-python"><pre>python.exe setup.py bdist_cloud upload_cloud</pre>
</div>
<p>This will send an updated .egg and .cld file to the central repository, where
the end-user application will check for updates.  If such an update is detected,
the application will download the new egg and run from that one.</p>
</div>
<div class="section" id="using-egg-files">
<h3>Using .egg files<a class="headerlink" href="#using-egg-files" title="Permalink to this headline">¶</a></h3>
<p>First of all python needs to be available on the machines that are going
to run the application.  The easies way to achieve this is by installing the
<a class="reference external" href="http://www.python-camelot.com/cpd.html">Conceptive Python Distribution (CPD)</a>
on the target machine.  This Python distribution can be installed in
<strong>End user mode</strong>, which means the user will not notice it is installed.</p>
<img alt="../_images/cpd_installer.png" src="../_images/cpd_installer.png" />
<p>Notice that for python to be available, it not
necessarily needs to be installed on every machine that runs the application.
Installing python on a shared disk of a central server might just be enough.</p>
<p>Also put the .egg file on a shared drive.</p>
<p>Then, the easiest way to proceed is to put a little .vbs bootstrap script on
the shared drive and put shortcuts to it on the desktops of the users.  The
.vbs script can look like this:</p>
<div class="highlight-python"><pre>Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Environment("Process").item("PYTHONPATH") = "R:\movie_store-01.01-py2.7.egg;"
WshShell.Run """C:\Program Files\CPD\pythonw.exe"" -m movie_store.main"</pre>
</div>
</div>
</div>
<div class="section" id="linux-deployment">
<h2>Linux deployment<a class="headerlink" href="#linux-deployment" title="Permalink to this headline">¶</a></h2>
<p>The application can be launched by putting the .egg in the PYTHONPATH
and starting python with the -m option:</p>
<div class="highlight-python"><pre>export PYTHONPATH = /mnt/r/movie_store-01.01-py2.7.egg
python.exe -m movie_store.main</pre>
</div>
<p>Don&#8217;t forget that all dependencies for your application should be installed
on the system or put in the PYTHONPATH</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Deployment</a><ul>
<li><a class="reference internal" href="#building-egg-files">Building .egg files</a></li>
<li><a class="reference internal" href="#windows-deployment">Windows deployment</a><ul>
<li><a class="reference internal" href="#through-cloudlaunch">Through CloudLaunch</a></li>
<li><a class="reference internal" href="#using-egg-files">Using .egg files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linux-deployment">Linux deployment</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="unittests.html"
                        title="previous chapter">Unittests</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="permissions.html"
                        title="next chapter">Authentication and permissions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/advanced/deployment.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="permissions.html" title="Authentication and permissions"
             >next</a> |</li>
        <li class="right" >
          <a href="unittests.html" title="Unittests"
             >previous</a> |</li>
        <li><a href="../index.html">Camelot  documentation</a> &raquo;</li>
          <li><a href="../contents.html" >Camelot Documentation contents</a> &raquo;</li>
          <li><a href="index.html" >Advanced Topics</a> &raquo;</li> 
      </ul>
    </div>

<br/>
<a href="http://example.com/my_article.html#disqus_thread">Comments</a>
<br/>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /**
    * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
    */

  /** var disqus_developer = 1 **/

  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://camelot.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=camelot">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 2009 - 2011, Conceptive Engineering.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
<div class="footer">
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

<script type="text/javascript">
var disqus_shortname = 'camelot';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://disqus.com/forums/camelot/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



  </body>
</html>