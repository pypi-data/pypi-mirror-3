<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="path:view/macro"
      i18n:domain="horae.auth">
  <div metal:fill-slot="content">
    <h1 class="firstHeading"
        i18n:translate="">
      Sharing
    </h1>
    <form action="" method="post">
      <table class="listing sharing">
        <thead>
          <tr>
            <th rowspan="2"
                i18n:translate="">
              Principal
            </th>
            <th colspan="1"
                tal:attributes="colspan len(view.roles)"
                i18n:translate="">
              Roles
            </th>
          </tr>
          <tr>
            <th tal:repeat="role view.roles"
                tal:content="role.title">
              Role
            </th>
          </tr>
        </thead>
        <tbody>
          <tr tal:repeat="principal view.principals">
            <th>
              <input type="hidden" name="principals:list" value="principal"
                     tal:attributes="value principal['id']" />
              <tal:principal tal:replace="principal['name']">Principal</tal:principal>
              <span class="discreet"
                    tal:condition="principal['group']">(<tal:label i18n:translate="">Group</tal:label>)</span>
            </th>
            <td tal:repeat="role view.roles">
              <input type="checkbox" name="role:list" value="principal" checked=""
                     tal:condition="not role.id in principal['inherited']"
                     tal:attributes="name string:${role.id}:list;
                                     value principal['id'];
                                     checked role.id in principal['roles'] and 'checked' or ''" />
              <abbr title="Inherited"
                    tal:condition="role.id in principal['inherited']"
                    i18n:attributes="title">âœ–</abbr>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="1"
                tal:attributes="colspan len(view.roles)+1">
              <input type="text" name="search_term" value=""
                     tal:attributes="value request.get('search_term', '')" />
              <input class="button" type="submit" name="search_principal" value="Search principal"
                     i18n:attributes="value" />
            </td>
          </tr>
        </tfoot>
      </table>
      <p>
        <label>
          <input type="checkbox" name="inherit" value="1"
                 tal:attributes="checked python:view.manager.inherit and 'checked' or ''" />
          <tal:label i18n:translate="">Inherit permissions from parent</tal:label>
        </label>
      </p>
      <div id="actionsView">
        <span class="actionButtons">
          <input class="button" type="submit" name="update_sharing" value="Save"
                 i18n:attributes="value" />
        </span>
      </div>
    </form>
  </div>
</html>