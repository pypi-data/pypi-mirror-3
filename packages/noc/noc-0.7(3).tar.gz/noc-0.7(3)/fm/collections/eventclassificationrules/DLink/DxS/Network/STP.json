[
    {
        "name": "DLink | DxS | Network | STP | BPDU Guard Violation (SYSLOG)",
        "description": "INFO(6) Port <2>  enter BPDU under attacking state (mode: drop)",
        "event_class__name": "Network | STP | BPDU Guard Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\)) Port <(?P<interface>\\S+)>\\s+enter BPDU under attacking state \\(mode: \\S+\\)"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | STP | BPDU Guard Recovery (SYSLOG)",
        "description": "INFO(6) Port <2>  recover from BPDU under attacking state automatically",
        "event_class__name": "Network | STP | BPDU Guard Recovery",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\)) Port <(?P<interface>\\S+)>\\s+recover from BPDU under attacking state automatically"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | STP | Topology Changed (SYSLOG)",
        "description": "INFO(6) Topology changed  (Instance:0, Port:24,MAC:00-22-B0-13-84-00)",
        "event_class__name": "Network | STP | Topology Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\))?\\s*Topology changed\\s+\\(Instance:(?P<instance>\\d+),? [Pp]ort:(?P<interface>\\S+?)(,.+)?\\)"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | STP | STP Loop Detected #1 (SYSLOG)",
        "description": "WARN(4) BPDU Loop Back on Port 24",
        "event_class__name": "Network | STP | STP Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:WARN:|WARN\\(4\\)) BPDU Loop Back on Port (?P<interface>\\S+)"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | STP | STP Vlan Loop Detected #1 (SYSLOG)",
        "description": "CRIT(2) Port 24 VID 10 LBD loop occurred. Packet discard begun",
        "event_class__name": "Network | STP | STP Vlan Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:CRIT:|CRIT\\(2\\)) Port (?P<interface>\\S+) VID (?P<vlan>\\d+) LBD loop occurred. Packet discard begun"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | STP | STP Vlan Loop Cleared #1 (SYSLOG)",
        "description": "INFO(6) Port 24 VID 10 LBD recovered. Loop detection restarted",
        "event_class__name": "Network | STP | STP Vlan Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\)) Port (?P<interface>\\S+) VID (?P<vlan>\\d+) LBD recovered. Loop detection restarted"
            }
        ]
    }
]
