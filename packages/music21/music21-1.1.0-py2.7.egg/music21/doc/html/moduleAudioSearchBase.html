
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>music21.audioSearch.base &mdash; music21 Documentation</title>
    
    <link rel="stylesheet" href="_static/music21doc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="music21 Documentation" href="index.html" />
    <link rel="next" title="music21.audioSearch.recording" href="moduleAudioSearchRecording.html" />
    <link rel="prev" title="music21.articulations" href="moduleArticulations.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="moduleAudioSearchRecording.html" title="music21.audioSearch.recording"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="moduleArticulations.html" title="music21.articulations"
             accesskey="P">previous</a> |</li>
        <li><a href="contents.html">music21</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="moduleArticulations.html"
                        title="previous chapter">music21.articulations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="moduleAudioSearchRecording.html"
                        title="next chapter">music21.audioSearch.recording</a></p>
<h3><a href="contents.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="what.html">What Is Music21?</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickStart.html">Quick Start: Getting Started with music21</a></li>
<li class="toctree-l1"><a class="reference internal" href="overviewNotes.html">Overview: Pitches, Durations, Notes, and Chords</a></li>
<li class="toctree-l1"><a class="reference internal" href="overviewStreams.html">Overview: Streams, Scores, Parts, and Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="overviewFormats.html">Overview: Importing File and Data Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="overviewPostTonal.html">Overview: Post-Tonal Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="overviewMeters.html">Overview: Meters, Time Signatures, and Processing Beams, Accents, and Beats</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples and Demonstrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing Music21</a></li>
<li class="toctree-l1"><a class="reference internal" href="installMac.html">Installing Music21 on Mac</a></li>
<li class="toctree-l1"><a class="reference internal" href="installWindows.html">Installing Music21 in Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="installLinux.html">Installing Music21 on GNU/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="installAdvanced.html">Installing Music21 with SVN, setuptools, and PIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="installAdditional.html">Extending Music21 with Additional Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorialFinaleMac.html">Tutorial: Setting up Finale on Mac</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">Authors, Acknowledgments, Contributing, and Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications and Extensions of music21</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Configuring Environment Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphing.html">Graphing Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="advancedGraphing.html">Advanced Graphing Topics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="referenceCorpus.html">List of Works Found in the music21 Corpus</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="moduleAbcBase.html">music21.abc.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAbcTranslate.html">music21.abc.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAbjTranslate.html">music21.abj.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisCorrelate.html">music21.analysis.correlate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisDiscrete.html">music21.analysis.discrete</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisMetrical.html">music21.analysis.metrical</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisPatel.html">music21.analysis.patel</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisReduction.html">music21.analysis.reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisSearch.html">music21.analysis.search</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAnalysisWindowed.html">music21.analysis.windowed</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleArticulations.html">music21.articulations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">music21.audioSearch.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAudioSearchRecording.html">music21.audioSearch.recording</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleAudioSearchTranscriber.html">music21.audioSearch.transcriber</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBar.html">music21.bar</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBase.html">music21.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBeam.html">music21.beam</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBrailleBasic.html">music21.braille.basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBrailleExamples.html">music21.braille.examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBrailleSegment.html">music21.braille.segment</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBrailleText.html">music21.braille.text</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleBrailleTranslate.html">music21.braille.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleChord.html">music21.chord</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleClef.html">music21.clef</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleCommon.html">music21.common</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleCompositionPhasing.html">music21.composition.phasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleConverter.html">music21.converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleCorpusBase.html">music21.corpus.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleCorpusChorales.html">music21.corpus.chorales</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleCounterpointSpecies.html">music21.counterpoint.species</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleDemosTheoryAnalysisTheoryAnalyzer.html">music21.demos.theoryAnalysis.theoryAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleDuration.html">music21.duration</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleDynamics.html">music21.dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleEditorial.html">music21.editorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleEnvironment.html">music21.environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleExpressions.html">music21.expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFeaturesBase.html">music21.features.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFeaturesJSymbolic.html">music21.features.jSymbolic</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFeaturesNative.html">music21.features.native</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassChecker.html">music21.figuredBass.checker</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassExamples.html">music21.figuredBass.examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassFbPitch.html">music21.figuredBass.fbPitch</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassNotation.html">music21.figuredBass.notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassPossibility.html">music21.figuredBass.possibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassRealizer.html">music21.figuredBass.realizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassRealizerScale.html">music21.figuredBass.realizerScale</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassResolution.html">music21.figuredBass.resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassRules.html">music21.figuredBass.rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleFiguredBassSegment.html">music21.figuredBass.segment</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleGraph.html">music21.graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleHarmony.html">music21.harmony</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleHumdrum.html">music21.humdrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleHumdrumSpineParser.html">music21.humdrum.spineParser</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleInstrument.html">music21.instrument</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleInterval.html">music21.interval</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleIntervalNetwork.html">music21.intervalNetwork</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleKey.html">music21.key</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleLayout.html">music21.layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleLilyLilyObjects.html">music21.lily.lilyObjects</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleLilyTranslate.html">music21.lily.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMedren.html">music21.medren</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMetadata.html">music21.metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMeter.html">music21.meter</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMidiBase.html">music21.midi.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMidiRealtime.html">music21.midi.realtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMidiTranslate.html">music21.midi.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMusedataBase.html">music21.musedata.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMusedataTranslate.html">music21.musedata.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMusedataBase40.html">music21.musedata.base40</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleMusicxmlTranslate.html">music21.musicxml.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleNote.html">music21.note</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleNoteworthyTranslate.html">music21.noteworthy.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="modulePitch.html">music21.pitch</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleRepeat.html">music21.repeat</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleRoman.html">music21.roman</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleRomanTextBase.html">music21.romanText.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleRomanTextTranslate.html">music21.romanText.translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleRomanTextClercqTemperley.html">music21.romanText.clercqTemperley</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleScalaBase.html">music21.scala.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleScale.html">music21.scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleSearch.html">music21.search</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleSerial.html">music21.serial</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleSieve.html">music21.sieve</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleSpanner.html">music21.spanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleStream.html">music21.stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTempo.html">music21.tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTestTest.html">music21.test.test</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTestMultiprocessTest.html">music21.test.multiprocessTest</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleText.html">music21.text</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTie.html">music21.tie</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTinyNotation.html">music21.tinyNotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTrecentoCadencebook.html">music21.trecento.cadencebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTrecentoPolyphonicSnippet.html">music21.trecento.polyphonicSnippet</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleTrecentoTonality.html">music21.trecento.tonality</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleVariant.html">music21.variant</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleVexflowBase.html">music21.vexflow.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleVoiceLeading.html">music21.voiceLeading</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleVolume.html">music21.volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleWebappsBase.html">music21.webapps.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduleXmlnode.html">music21.xmlnode</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documenting.html">Documenting music21</a></li>
<li class="toctree-l1"><a class="reference internal" href="buildingDocumentation.html">Building Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingEclipse.html">Using music21 with SVN for Eclipse</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="music21-audiosearch-base">
<span id="moduleaudiosearch-base"></span><h1>music21.audioSearch.base<a class="headerlink" href="#music21-audiosearch-base" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-music21.audioSearch.base"></span><dl class="function">
<dt id="music21.audioSearch.base.autocorrelationFunction">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">autocorrelationFunction</tt><big>(</big><em>recordedSignal</em>, <em>recordSampleRate</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.autocorrelationFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>It converts the temporal domain into a frequency domain. In order to do that, it
uses the autocorrelation function, which finds periodicities in the signal
in the temporal domain and, consequently, obtains the frequency in each instant
of time.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wave</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wv</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;test_audio.wav&quot;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">wv</span><span class="o">.</span><span class="n">readframes</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finalResult</span> <span class="o">=</span> <span class="n">autocorrelationFunction</span><span class="p">(</span><span class="n">samps</span><span class="p">,</span> <span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wv</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">finalResult</span>
<span class="go">143.6276...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.decisionProcess">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">decisionProcess</tt><big>(</big><em>list</em>, <em>notePrediction</em>, <em>beginningData</em>, <em>lastNotePosition</em>, <em>countdown</em>, <em>firstNotePage=None</em>, <em>lastNotePage=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.decisionProcess" title="Permalink to this definition">¶</a></dt>
<dd><p>It decides which of the given parts of the score has a better matching with
the recorded part of the song.
If there is not a part of the score with a high probability to be the correct part,
it starts a &#8220;countdown&#8221; in order stop the score following if the bad matching persists.
In this case, it does not match the recorded part of the song with any part of the score.</p>
<p>Inputs: List, contains all the possible parts of the score, sorted from the
higher probability to be the best matching at the beginning to the lowest probability.
notePrediction is the position of the score in which the next note should start.
beginningData is a list with all the beginnings of the used fragments of the score to find
the best matching.
lastNotePosition is the position of the score in which the last matched fragment of the
score finishes.
Countdown is a counter of consecutive errors in the matching process.</p>
<p>Outputs: It returns the beginning of the best matching fragment of
score and the countdown.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scNotes</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;luca/gloria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">notes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scoreStream</span> <span class="o">=</span> <span class="n">scNotes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqFromAQList</span> <span class="o">=</span> <span class="n">getFrequenciesFromAudioFile</span><span class="p">(</span><span class="n">waveFilename</span><span class="o">=</span><span class="s">&#39;test_audio.wav&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">detectPitchFrequencies</span><span class="p">(</span><span class="n">freqFromAQList</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">smoothFrequencies</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">detectedPitchObjects</span><span class="p">,</span> <span class="n">listplot</span><span class="p">)</span> <span class="o">=</span> <span class="n">pitchFrequenciesToObjects</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">notesList</span><span class="p">,</span> <span class="n">durationList</span><span class="p">)</span> <span class="o">=</span> <span class="n">joinConsecutiveIdenticalPitches</span><span class="p">(</span><span class="n">detectedPitchObjects</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transcribedScore</span><span class="p">,</span> <span class="n">qle</span> <span class="o">=</span> <span class="n">notesAndDurationsToStream</span><span class="p">(</span><span class="n">notesList</span><span class="p">,</span> <span class="n">durationList</span><span class="p">,</span> <span class="n">scNotes</span><span class="o">=</span><span class="n">scNotes</span><span class="p">,</span> <span class="n">qle</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hop</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_recording</span> <span class="o">=</span> <span class="mi">24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">totScores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beginningData</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lengthData</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">scNotes</span> <span class="o">=</span> <span class="n">scoreStream</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">hop</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span><span class="n">i</span> <span class="o">*</span> <span class="n">hop</span> <span class="o">+</span> <span class="n">tn_recording</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">]</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="n">beginningData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">hop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">lengthData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tn_recording</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">scNotes</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>    <span class="n">totScores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scNotes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">listOfParts</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">approximateNoteSearch</span><span class="p">(</span><span class="n">transcribedScore</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">notes</span><span class="p">,</span> <span class="n">totScores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notePrediction</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lastNotePosition</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">countdown</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positionInList</span><span class="p">,</span> <span class="n">countdown</span> <span class="o">=</span> <span class="n">decisionProcess</span><span class="p">(</span><span class="n">listOfParts</span><span class="p">,</span> <span class="n">notePrediction</span><span class="p">,</span> <span class="n">beginningData</span><span class="p">,</span> <span class="n">lastNotePosition</span><span class="p">,</span> <span class="n">countdown</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">positionInList</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">countdown</span> <span class="c"># the result is 1 because the song used is completely different from the score!!</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.detectPitchFrequencies">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">detectPitchFrequencies</tt><big>(</big><em>freqFromAQList</em>, <em>useScale=&lt;music21.scale.MajorScale C major&gt;</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.detectPitchFrequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>It detects the pitches of the notes from a list of frequencies, using thresholds which
depend on the used scale. The default value is the major scale C4.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqFromAQList</span><span class="o">=</span><span class="p">[</span><span class="mf">143.627689055</span><span class="p">,</span><span class="mf">99.0835452019</span><span class="p">,</span><span class="mf">211.004784689</span><span class="p">,</span><span class="mf">4700.31347962</span><span class="p">,</span><span class="mf">2197.9431119</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pitchesList</span> <span class="o">=</span> <span class="n">detectPitchFrequencies</span><span class="p">(</span><span class="n">freqFromAQList</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">music21</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">MajorScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">pitchesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">146.832383959</span>
<span class="go">97.9988589954</span>
<span class="go">220.0</span>
<span class="go">4698.63628668</span>
<span class="go">2093.0045224</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.getFrequenciesFromAudioFile">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">getFrequenciesFromAudioFile</tt><big>(</big><em>waveFilename='xmas.wav'</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.getFrequenciesFromAudioFile" title="Permalink to this definition">¶</a></dt>
<dd><p>gets a list of frequencies from a complete audio file.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">getFrequenciesFromAudioFile</span><span class="p">(</span><span class="n">waveFilename</span><span class="o">=</span><span class="s">&#39;test_audio.wav&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">freq</span>
<span class="go">[143.627689055..., 99.083545201..., 211.004784688..., 4700.313479623..., ...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.getFrequenciesFromMicrophone">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">getFrequenciesFromMicrophone</tt><big>(</big><em>length=10.0</em>, <em>storeWaveFilename=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.getFrequenciesFromMicrophone" title="Permalink to this definition">¶</a></dt>
<dd><p>records for length (=seconds) a set of frequencies from the microphone.</p>
<p>If storeWaveFilename is not None, then it will store the recording on disk
in a wave file.</p>
<p>Returns a list of frequencies detected.</p>
<p>TODO &#8211; find a way to test... or at least demo</p>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.getFrequenciesFromPartialAudioFile">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">getFrequenciesFromPartialAudioFile</tt><big>(</big><em>waveFilenameOrHandle='temp'</em>, <em>length=10.0</em>, <em>startSample=0</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.getFrequenciesFromPartialAudioFile" title="Permalink to this definition">¶</a></dt>
<dd><p>It calculates the fundamental frequency at every instant of time of an audio signal
extracted either from the microphone or from an already recorded song.
It uses a period of time defined by the variable &#8220;length&#8221; in seconds.</p>
<p>It returns a list with the frequencies, a variable with the file descriptor, and the end sample position.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">readFile</span> <span class="o">=</span> <span class="s">&#39;pachelbel.wav&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequencyList</span><span class="p">,</span> <span class="n">pachelbelFileHandle</span><span class="p">,</span> <span class="n">currentSample</span>  <span class="o">=</span> <span class="n">getFrequenciesFromPartialAudioFile</span><span class="p">(</span><span class="n">readFile</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">frequencyList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">143.627689055</span>
<span class="go">99.0835452019</span>
<span class="go">211.004784689</span>
<span class="go">4700.31347962</span>
<span class="go">767.827403482</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">currentSample</span>  <span class="c"># should be near 44100, but probably not exact</span>
<span class="go">44032</span>
</pre></div>
</div>
<p>Now read the next 1 second...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">frequencyList</span><span class="p">,</span> <span class="n">pachelbelFileHandle</span><span class="p">,</span> <span class="n">currentSample</span>  <span class="o">=</span> <span class="n">getFrequenciesFromPartialAudioFile</span><span class="p">(</span><span class="n">pachelbelFileHandle</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">startSample</span> <span class="o">=</span> <span class="n">currentSample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">frequencyList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">187.798213268</span>
<span class="go">238.263483185</span>
<span class="go">409.700397349</span>
<span class="go">149.958733396</span>
<span class="go">101.989786226</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">currentSample</span>  <span class="c"># should be exactly double the previous</span>
<span class="go">88064</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.histogram">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">histogram</tt><big>(</big><em>data</em>, <em>bins</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">audioSearch</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pdf</span>
<span class="go">[3, 0, 0, 1, 1, 1, 0, 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">bins</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.interpolation">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">interpolation</tt><big>(</big><em>correlation</em>, <em>peak</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation for estimating the true position of an
inter-sample maximum when nearby samples are known.</p>
<p>Correlation is a vector and peak is an index for that vector.</p>
<p>Returns the x coordinate of the vertex of that parabola.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">3.21428571...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.joinConsecutiveIdenticalPitches">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">joinConsecutiveIdenticalPitches</tt><big>(</big><em>detectedPitchObjects</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.joinConsecutiveIdenticalPitches" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a list of equally-spaced <a class="reference internal" href="modulePitch.html#music21.pitch.Pitch" title="music21.pitch.Pitch"><tt class="xref py py-class docutils literal"><span class="pre">Pitch</span></tt></a> objects
and returns a tuple of two lists, the first a list of
<a class="reference internal" href="moduleNote.html#music21.note.Note" title="music21.note.Note"><tt class="xref py py-class docutils literal"><span class="pre">Note</span></tt></a>
or <a class="reference internal" href="moduleNote.html#music21.note.Rest" title="music21.note.Rest"><tt class="xref py py-class docutils literal"><span class="pre">Rest</span></tt></a> objects (each of quarterLength 1.0)
and a list of how many were joined together to make that object.</p>
<p>N.B. the returned list is NOT a <a class="reference internal" href="moduleStream.html#music21.stream.Stream" title="music21.stream.Stream"><tt class="xref py py-class docutils literal"><span class="pre">Stream</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scNotes</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;luca/gloria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">notes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">detectPitchFrequencies</span><span class="p">(</span><span class="n">freqFromAQList</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">smoothFrequencies</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">detectedPitchObjects</span><span class="p">,</span> <span class="n">listplot</span><span class="p">)</span> <span class="o">=</span> <span class="n">pitchFrequenciesToObjects</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">notesList</span><span class="p">,</span> <span class="n">durationList</span><span class="p">)</span> <span class="o">=</span> <span class="n">joinConsecutiveIdenticalPitches</span><span class="p">(</span><span class="n">detectedPitchObjects</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">notesList</span>
<span class="go">[&lt;music21.note.Rest rest&gt;, &lt;music21.note.Note C&gt;, &lt;music21.note.Note C&gt;, &lt;music21.note.Note D&gt;, &lt;music21.note.Note E&gt;, &lt;music21.note.Note F&gt;, &lt;music21.note.Note G&gt;, &lt;music21.note.Note A&gt;, &lt;music21.note.Note B&gt;, &lt;music21.note.Note C&gt;, ...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">durationList</span>
<span class="go">[72, 6, 14, 23, 34, 40, 27, 36, 35, 15, 17, 15, 6, 33, 22, 13, 16, 39, 35, 38, 27, 27, 27, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.normalizeInputFrequency">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">normalizeInputFrequency</tt><big>(</big><em>inputPitchFrequency</em>, <em>thresholds=None</em>, <em>pitches=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.normalizeInputFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an inputFrequency, a set of threshold values, and a set of allowable pitches
(given by prepareThresholds) and returns a tuple of the normalized frequency and the
pitch detected (as a <a class="reference internal" href="modulePitch.html#music21.pitch.Pitch" title="music21.pitch.Pitch"><tt class="xref py py-class docutils literal"><span class="pre">Pitch</span></tt></a> object)</p>
<p>It will convert the frequency to be within the range of the default frequencies
(usually C4 to C5) but the pitch object will have the correct octave.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">normalizeInputFrequency</span><span class="p">(</span><span class="mf">441.72</span><span class="p">)</span>
<span class="go">(440.0, A4)</span>
</pre></div>
</div>
<p>If you will be doing this often, it&#8217;s best to cache your thresholds and
pitches by running <cite>prepareThresholds</cite> once first:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span><span class="p">,</span> <span class="n">pitches</span> <span class="o">=</span> <span class="n">audioSearch</span><span class="o">.</span><span class="n">prepareThresholds</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fq</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">450</span><span class="p">,</span> <span class="mi">510</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">600</span><span class="p">]:</span>
<span class="gp">... </span>     <span class="k">print</span> <span class="n">normalizeInputFrequency</span><span class="p">(</span><span class="n">fq</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">,</span> <span class="n">pitches</span><span class="p">)</span>
<span class="go">(440.0, A4)</span>
<span class="go">(523.25113..., C5)</span>
<span class="go">(277.18263..., C#5)</span>
<span class="go">(293.66476..., D5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.notesAndDurationsToStream">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">notesAndDurationsToStream</tt><big>(</big><em>notesList</em>, <em>durationList</em>, <em>scNotes=None</em>, <em>removeRestsAtBeginning=True</em>, <em>qle=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.notesAndDurationsToStream" title="Permalink to this definition">¶</a></dt>
<dd><p>take a list of <a class="reference internal" href="moduleNote.html#music21.note.Note" title="music21.note.Note"><tt class="xref py py-class docutils literal"><span class="pre">Note</span></tt></a> objects or rests
and an equally long list of how long
each ones lasts in terms of samples and returns a
Stream using the information from quarterLengthEstimation
and quantizeDurations.</p>
<p>returns a <a class="reference internal" href="moduleStream.html#music21.stream.Score" title="music21.stream.Score"><tt class="xref py py-class docutils literal"><span class="pre">Score</span></tt></a> object, containing
a metadata object and a single <a class="reference internal" href="moduleStream.html#music21.stream.Part" title="music21.stream.Part"><tt class="xref py py-class docutils literal"><span class="pre">Part</span></tt></a> object, which in turn
contains the notes, etc.  Does not run <a class="reference internal" href="moduleStream.html#music21.stream.Stream.makeNotation" title="music21.stream.Stream.makeNotation"><tt class="xref py py-meth docutils literal"><span class="pre">makeNotation()</span></tt></a>
on the Score.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">durationList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">Note</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noteList</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">(</span><span class="s">&#39;C#4&#39;</span><span class="p">),</span> <span class="n">n</span><span class="p">(</span><span class="s">&#39;D5&#39;</span><span class="p">),</span> <span class="n">n</span><span class="p">(</span><span class="s">&#39;B4&#39;</span><span class="p">),</span> <span class="n">n</span><span class="p">(</span><span class="s">&#39;F#5&#39;</span><span class="p">),</span> <span class="n">n</span><span class="p">(</span><span class="s">&#39;C5&#39;</span><span class="p">),</span> <span class="n">note</span><span class="o">.</span><span class="n">Rest</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span><span class="n">lengthPart</span> <span class="o">=</span> <span class="n">audioSearch</span><span class="o">.</span><span class="n">notesAndDurationsToStream</span><span class="p">(</span><span class="n">noteList</span><span class="p">,</span> <span class="n">durationList</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">)</span>
<span class="go">{0.0} &lt;music21.metadata.Metadata object at ...&gt;</span>
<span class="go">{0.0} &lt;music21.stream.Part ...&gt;</span>
<span class="go">    {0.0} &lt;music21.note.Note C#&gt;</span>
<span class="go">    {1.0} &lt;music21.note.Note D&gt;</span>
<span class="go">    {2.0} &lt;music21.note.Note B&gt;</span>
<span class="go">    {2.5} &lt;music21.note.Note F#&gt;</span>
<span class="go">    {4.0} &lt;music21.note.Note C&gt;</span>
<span class="go">    {4.25} &lt;music21.note.Rest rest&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.pitchFrequenciesToObjects">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">pitchFrequenciesToObjects</tt><big>(</big><em>detectedPitchesFreq</em>, <em>useScale=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.pitchFrequenciesToObjects" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a list of detected pitch frequencies and returns a tuple where the first element
is a list of :class:~`music21.pitch.Pitch` objects that best match these frequencies
and the second element is a list of the frequencies of those objects that can
be plotted for matplotlib</p>
<p>To-do: only return the former.  The latter can be generated in other ways.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scNotes</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;luca/gloria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">notes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqFromAQList</span> <span class="o">=</span> <span class="n">getFrequenciesFromAudioFile</span><span class="p">(</span><span class="n">waveFilename</span><span class="o">=</span><span class="s">&#39;test_audio.wav&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">detectPitchFrequencies</span><span class="p">(</span><span class="n">freqFromAQList</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detectedPitchesFreq</span> <span class="o">=</span> <span class="n">smoothFrequencies</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">detectedPitchObjects</span><span class="p">,</span> <span class="n">listplot</span><span class="p">)</span> <span class="o">=</span> <span class="n">pitchFrequenciesToObjects</span><span class="p">(</span><span class="n">detectedPitchesFreq</span><span class="p">,</span> <span class="n">useScale</span><span class="o">=</span><span class="n">scale</span><span class="o">.</span><span class="n">ChromaticScale</span><span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">detectedPitchObjects</span>
<span class="go">[A5, A5, A5, D5, D4, B4, A4, F4, E-4, C#3, B3, B3, B3, A3, G3, F3, F3, E3, F#3, F#3,...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.prepareThresholds">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">prepareThresholds</tt><big>(</big><em>useScale=None</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.prepareThresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>returns two elements.  The first is a list of threshold values
for one octave of a given scale, <cite>useScale</cite>,
(including the octave repetition) (Default is a ChromaticScale).
The second is the pitches of the scale.</p>
<p>A threshold value is the fractional part of the log-base-2 value of the
frequency.</p>
<p>For instance if A = 440 and B-flat = 460, then the threshold between
A and B-flat will be 450.  Notes below 450 should be considered As and those
above 450 should be considered B-flats.</p>
<p>Thus the list returned has one less element than the number of notes in the
scale + octave repetition.  If useScale is a ChromaticScale, <cite>prepareThresholds</cite>
will return a 12 element list.  If it&#8217;s a diatonic scale, it&#8217;ll have 7 elements.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">music21</span><span class="o">.</span><span class="n">audioSearch</span><span class="o">.</span><span class="n">prepareThresholds</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">MajorScale</span><span class="p">(</span><span class="s">&#39;A3&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> &lt; </span><span class="si">%.2f</span><span class="s"> &lt; </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="go">A3 &lt; 0.86 &lt; B3</span>
<span class="go">B3 &lt; 0.53 &lt; C#4</span>
<span class="go">C#4 &lt; 0.16 &lt; D4</span>
<span class="go">D4 &lt; 0.28 &lt; E4</span>
<span class="go">E4 &lt; 0.45 &lt; F#4</span>
<span class="go">F#4 &lt; 0.61 &lt; G#4</span>
<span class="go">G#4 &lt; 1.24 &lt; A4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.quantizeDuration">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">quantizeDuration</tt><big>(</big><em>length</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.quantizeDuration" title="Permalink to this definition">¶</a></dt>
<dd><p>round an approximately transcribed quarterLength to a better one in
music21.</p>
<p>Should be replaced by a full-featured routine in midi or stream.</p>
<p>See <a class="reference internal" href="moduleStream.html#music21.stream.Stream.quantize" title="music21.stream.Stream.quantize"><tt class="xref py py-meth docutils literal"><span class="pre">quantize()</span></tt></a> for more information
on the standard music21 methodology.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">quantizeDuration</span><span class="p">(</span><span class="mf">1.01</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">quantizeDuration</span><span class="p">(</span><span class="mf">1.70</span><span class="p">)</span>
<span class="go">1.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.quarterLengthEstimation">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">quarterLengthEstimation</tt><big>(</big><em>durationList</em>, <em>mostRepeatedQuarterLength=1.0</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.quarterLengthEstimation" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a list of lengths of notes (measured in
audio samples) and tries to estimate using
matplotlib.pyplot.hist what the length of a
quarter note should be in this list.</p>
<p>If mostRepeatedQuarterLength is another number, it still returns the
estimated length of a quarter note, but chooses it so that the most
common note in durationList will be the other note.  See example 2:
:</p>
<p>Returns a float &#8211; and not an int.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">durationList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">quarterLengthEstimation</span><span class="p">(</span><span class="n">durationList</span><span class="p">)</span>
<span class="go">20.625</span>
</pre></div>
</div>
<p>Example 2: suppose these are the inputted durations for a
score where most of the notes are half notes.  Show how long
a quarter note should be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">audioSearch</span><span class="o">.</span><span class="n">quarterLengthEstimation</span><span class="p">(</span><span class="n">durationList</span><span class="p">,</span> <span class="n">mostRepeatedQuarterLength</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="go">10.3125</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="music21.audioSearch.base.smoothFrequencies">
<tt class="descclassname">music21.audioSearch.base.</tt><tt class="descname">smoothFrequencies</tt><big>(</big><em>detectedPitchesFreq</em>, <em>smoothLevels=7</em>, <em>inPlace=True</em><big>)</big><a class="headerlink" href="#music21.audioSearch.base.smoothFrequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>It smooths the shape of the signal in order to avoid false detections in the fundamental
frequency.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputPitches</span><span class="o">=</span><span class="p">[</span><span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">470</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">440</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">=</span><span class="n">smoothFrequencies</span><span class="p">(</span><span class="n">inputPitches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">result</span>
<span class="go">[440, 440, 440, 440, 445, 445, 446, 446, 442, 442, 441, 441, 434, 433, 432, 430, 436, 437, 438, 439, 439, 439, 439, 439, 439, 440, 440, 440, 440, 440, 440, 440]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="moduleAudioSearchRecording.html" title="music21.audioSearch.recording"
             >next</a> |</li>
        <li class="right" >
          <a href="moduleArticulations.html" title="music21.articulations"
             >previous</a> |</li>
        <li><a href="contents.html">music21</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011 The music21 Project.
      Last updated on Jul 28, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>